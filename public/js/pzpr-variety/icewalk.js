/*! @license pzpr.js v (c) 2009-2024 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["icewalk","waterwalk","genderwalk"],{MouseEvent:{inputModes:{edit:["ice","number","clear","info-line"],play:["line","peke","info-line"]},mouseinput_auto:function(){var e;this.puzzle.playmode?"left"===this.btn?this.mousestart||this.mousemove?this.inputLine():this.mouseend&&this.notInputted()&&(this.prevPos.reset(),this.inputpeke()):"right"===this.btn&&(this.mousestart||this.mousemove)&&this.inputpeke():this.puzzle.editmode&&(e=this.getcell(),"right"!==this.btn||e.isNum()||!this.mousestart&&!this.mousemove?this.mouseend&&this.notInputted()&&this.inputqnum():this.inputIcebarn())}},"MouseEvent@waterwalk":{inputModes:{edit:["water","number","clear","info-line"],play:["line","peke","info-line"]},mouseinput_other:function(){"water"===this.inputMode&&this.inputIcebarn()}},"MouseEvent@genderwalk":{inputModes:{edit:["water","symbol","symbol-","clear","info-line"],play:["line","peke","info-line"]},mouseinput_other:function(){"water"===this.inputMode?this.inputIcebarn():"symbol"!==this.inputMode&&"symbol-"!==this.inputMode||this.inputqnum()}},KeyEvent:{enablemake:!0,keyinput:function(e){var t;"q"===e?((t=this.cursor.getc()).setQues(6!==t.ques?6:0),(this.prev=t).draw()):this.key_inputqnum(e)}},Border:{enableLineNG:!0,isLineNG:function(){return!this.inside},posthook:{line:function(){this.board.roommgr.isStale=!0}}},Cell:{posthook:{qnum:function(e){-1!==e&&6===this.ques?this.setQues(0):"genderwalk"===this.pid&&(this.board.roommgr.isStale=!0)},ques:function(e){this.board.roommgr.isStale=!0,6===e&&-1!==this.qnum&&this.setQnum(-1)}},maxnum:function(){return this.board.cols*this.board.rows},ice:function(){return this.isnull||6===this.ques}},"Cell@genderwalk":{maxnum:16,numberAsLetter:!0},Cross:{l2cnt:0},Board:{hasborder:2},Graphic:{irowake:!0,bgcellcolor_func:"icebarn",paint:function(){this.drawBGCells(),this.drawDashedGrid(!1),this.drawBorders(),this.drawLines(),this.drawPekes(),this.drawQuesNumbers(),this.drawTarget()},getBorderColor:function(e){var t=e.sidecell[0],e=e.sidecell[1];return t.ice()^e.ice()?this.quescolor:null}},"Graphic@waterwalk":{icecolor:"rgb(163, 216, 255)"},"Graphic@genderwalk":{icecolor:"rgb(255, 179, 255)",paint:function(){this.drawBGCells(),this.drawDashedGrid(!1),this.drawBorders(),this.drawQuesShapes(),this.drawHatenas(),this.drawLines(),this.drawPekes(),this.drawTarget()},drawQuesShapes:function(){for(var e=["M 0 -0.905 L 0.276 -0.285 L 0.951 -0.214 L 0.447 0.24 L 0.588 0.904 L 0 0.565 L -0.588 0.904 L -0.447 0.24 L -0.951 -0.214 L -0.276 -0.285 Z","M 0 -0.823 L -0.95 0.823 L 0.95 0.823 Z","M 0 -0.617 C 0.142 -1.092 0.95 -1.092 0.95 -0.475 C 0.95 0.048 0.19 0.427 0 0.902 C -0.19 0.427 -0.95 0.048 -0.95 -0.475 C -0.95 -1.092 -0.142 -1.092 0 -0.617 Z","M 0 -1 L -1 0 L 0 1 L 1 0 Z","M 0.033 0.943 A 0.4 0.4 0 1 0 -0.323 0.503 Q -0.335 0.622 -0.712 0.38 Q -0.445 0.892 0.033 0.943 Z M -0.876 -0.518 A 0.4 0.4 0 1 0 -0.317 -0.606 Q -0.414 -0.676 -0.017 -0.882 Q -0.593 -0.906 -0.876 -0.518 Z M 0.844 -0.575 A 0.4 0.4 0 1 0 0.64 -0.047 Q 0.75 -0.096 0.729 0.351 Q 1.038 -0.136 0.844 -0.575 Z","M -0.85 0.9 C -1.1 -0.5 0.5 -0.5 0.85 -0.9 C 1.1 0.5 -0.5 0.5 -0.85 0.9 Z","M 0.909 0.588 A 1 1 0 1 1 0.909 -0.588 A 0.7 0.7 0 1 0 0.909 0.588 Z","M -1 -0.25 A 1 0.3 0 0 0 -0.309 0.035 A 0.5 0.5 0 1 0 0.309 0.035 A 1 0.3 0 0 0 1 -0.25 L 1 -0.95 A 1 0.3 0 0 1 -1 -0.95 Z","M 0 -0.95 A 1 1 0 0 1 -0.9 -0.65 A 1.7 1.7 0 0 0 0 1 A 1.7 1.7 0 0 0 0.9 -0.65 A 1 1 0 0 1 0 -0.95 Z","M 0.488 -0.839 A 0.917 0.917 0 0 0 -0.439 -0.791 A 0.75 0.75 0 0 0 -0.763 -0.1 A 0.583 0.583 0 0 0 -0.394 0.375 A 0.417 0.417 0 0 0 0.036 0.275 A 0.25 0.25 0 0 0 0.066 -0.013 A 0.1 0.1 0 0 0 -0.1 -0.03 A 0.1 0.1 0 0 1 -0.266 -0.047 A 0.25 0.25 0 0 1 -0.236 -0.335 A 0.417 0.417 0 0 1 0.194 -0.435 A 0.583 0.583 0 0 1 0.563 0.04 A 0.75 0.75 0 0 1 0.239 0.731 A 0.917 0.917 0 0 1 -0.688 0.779 A 1 1 0 0 0 0.488 -0.839 Z","M 0.2 0.346 C 0.6 1.15 0.1 0.9 0 0.9 C -0.1 0.9 -0.6 1.15 -0.2 0.346 C -0.696 1.095 -0.729 0.537 -0.779 0.45 C -0.829 0.363 -1.296 0.055 -0.4 0 C -1.296 -0.055 -0.829 -0.363 -0.779 -0.45 C -0.729 -0.537 -0.696 -1.095 -0.2 -0.346 C -0.6 -1.15 -0.1 -0.9 -0 -0.9 C 0.1 -0.9 0.6 -1.15 0.2 -0.346 C 0.696 -1.095 0.729 -0.537 0.779 -0.45 C 0.829 -0.363 1.296 -0.055 0.4 -0 C 1.296 0.055 0.829 0.363 0.779 0.45 C 0.729 0.537 0.696 1.095 0.2 0.346 Z","M 0.14 -0.14 A 0.331 0.331 0 0 1 0.33 0.189 L 0.503 0.289 A 0.331 0.331 0 1 1 0.363 0.531 L 0.19 0.431 A 0.331 0.331 0 0 1 -0.19 0.431 L -0.363 0.531 A 0.331 0.331 0 1 1 -0.503 0.289 L -0.33 0.189 A 0.331 0.331 0 0 1 -0.14 -0.14 L -0.14 -0.34 A 0.331 0.331 0 1 1 0.14 -0.34 Z","M 0 1.05 L 0.735 0.42 L 0.21 -0.578 L 0.42 -0.788 L 0.315 -0.997 L -0.315 -0.997 L -0.42 -0.788 L -0.21 -0.578 L -0.735 0.42 Z","M 0.105 -0.42 C 0.315 -0.735 0.84 -0.945 0.945 -0.84 C 1.05 -0.735 0.945 0 0.63 0.105 C 1.155 0.63 0.525 1.155 0.105 0.63 A 0.15 0.7 0 0 1 -0.105 0.63 C -0.525 1.155 -1.155 0.63 -0.63 0.105 C -0.945 0 -1.05 -0.735 -0.945 -0.84 C -0.84 -0.945 -0.315 -0.735 -0.105 -0.42 A 0.15 0.7 0 0 1 0.105 -0.42 Z","M 0.9 -0.75 L 0.9 0.75 L 0.525 0.375 L 0.525 -0.375 Z M 0.75 0.9 L -0.75 0.9 L -0.375 0.525 L 0.375 0.525 Z M -0.9 0.75 L -0.9 -0.75 L -0.525 -0.375 L -0.525 0.375 Z M -0.75 -0.9 L 0.75 -0.9 L 0.375 -0.525 L -0.375 -0.525 Z M 0.3 -0.3 L 0.3 0.3 L -0.3 0.3 L -0.3 -0.3 Z","M -0.41 0.141 A 0.2 0.2 0 1 1 -0.41 -0.141 L -0.141 -0.41 A 0.58 0.58 0 1 0 -0.141 0.41 L 0.41 -0.141 A 0.2 0.2 0 1 1 0.41 0.141 L 0.141 0.41 A 0.58 0.58 0 1 0 0.141 -0.41 Z"],t=this.vinc("cell_shape","auto"),i=(t.lineWidth=Math.max(this.cw/25,1),.35*this.cw),n=this.range.cells,s=0;s<n.length;s++){var r=n[s],o=(t.vid="c_mk_"+r.id,t.strokeStyle=this.quescolor,r.bx*this.bw),a=r.by*this.bh;0<r.qnum&&r.qnum<=e.length?(t.beginPath(),this.drawPath(t,e[r.qnum-1],o,a,i),t.stroke()):t.vhide()}},drawPath:function(e,t,i,n,s){for(var r=e.context||e,o=0,a=0,p=0,f=0,c={A:{f:r.ellipse?function(e,t,i,n,s,r,o){function a(e,t){return e=Math.acos(e/Math.hypot(e,t)),t<0?-e:e}var c=Math.sin(i),h=Math.cos(i),l=.5*(p-r),u=.5*(f-o),d=h*l+c*u,u=h*u-c*l,l=e*u,k=t*d,m=Math.sqrt(Math.abs(e*e*t*t/(l*l+k*k)-1)),n=(m=!n==!s?-m:m)*l/t,l=-m*k/e,m=h*n-c*l+.5*(p+r),k=c*n+h*l+.5*(f+o),r=a((d-n)/e,(u-l)/t),c=a(-(d+n)/e,-(u+l)/t);this.ellipse(m,k,e,t,i,r,c,!s)}:null,args:["r","r","0","0","0","x","y"]},C:{f:r.bezierCurveTo,args:["x","y","x","y","x","y"]},L:{f:r.lineTo,args:["x","y"]},M:{f:r.moveTo,args:["x","y"]},Q:{f:r.quadraticCurveTo,args:["x","y","x","y"]},Z:{f:r.closePath,args:[]}},h=t.split(" "),l=0;l<h.length;l++){for(var u=h[l],d=c[u],k=[],m=0;m<d.args.length;m++){var L=+h[++l],g=d.args[m];"0"!==g&&(L*=s,"x"===g?L+=i:"y"===g&&(L+=n)),k.push(L)}d.f?d.f.apply(r,k):e.cpath&&(e.lastpath=u,e.cpath.push(u),e.cpath=e.cpath.concat(k)),2<=k.length?(p=k[k.length-2],f=k[k.length-1]):"Z"===u&&(p=o,f=a),"M"===u&&(o=p,a=f)}}},LineGraph:{enabled:!0},"LineGraph@icewalk":{isLineCross:!0},AreaRoomGraph:{countprop:"l2cnt",enabled:!0,relation:{"cell.ques":"node","border.line":"separator"},isedgevalidbylinkobj:function(e){return!!e.isLine()&&e.sidecell[0].ice()===e.sidecell[1].ice()}},"AreaRoomGraph@genderwalk":{setExtraData:function(e){this.common.setExtraData.call(this,e),e.determineMarkType()}},"GraphComponent@genderwalk":{determineMarkType:function(){this.markType=-1;for(var e=this.clist,t=0;t<e.length;t++){var i=e[t];-2===i.qnum&&-1===this.markType?this.markType=-2:0<=i.qnum&&(-2===this.markType||-1===this.markType?this.markType=i.qnum:i.qnum!==this.markType&&(this.markType=-3))}}},Encode:{decodePzpr:function(){this.decodeIce(),this.decodeNumber16()},encodePzpr:function(){this.encodeIce(),this.encodeNumber16()}},FileIO:{decodeData:function(){this.decodeCell(function(e,t){"#"===t?e.ques=6:"-"===t?e.qnum=-2:"."!==t&&(e.qnum=+t)}),this.decodeBorderLine()},encodeData:function(){this.encodeCell(function(e){return 6===e.ques?"# ":-2===e.qnum?"- ":0<=e.qnum?e.qnum+" ":". "}),this.encodeBorderLine()}},AnsCheck:{checklist:["checkBranchLine","checkCrossLine@waterwalk,genderwalk","checkCrossOutOfIce@icewalk","checkIceLines@icewalk","checkWaterWalk@waterwalk,genderwalk","checkLessWalk@icewalk,waterwalk","checkOverWalk@icewalk,waterwalk","checkPassesSingleMarks@genderwalk","checkPassesAnyMarks@genderwalk","checkConsecutiveMarks@genderwalk","checkOneLoop","checkNoLineOnNum","checkDeadendLine+"],checkLessWalk:function(){this.checkWalkLength(-1,"bkSizeLt")},checkOverWalk:function(){this.checkWalkLength(1,"bkSizeGt")},checkWaterWalk:function(){this.checkWalkLength(2,"bkSizeGt2")},checkWalkLength:function(e,t){this.board.roommgr.isStale&&(this.board.roommgr.isStale=!1,this.board.roommgr.rebuild());for(var i=0;i<this.board.cell.length;i++){var n=this.board.cell[i],s=n.qnum;if(2===e){if(!n.ice())continue;s=2}if(!(s<=0)&&n.room&&!(e<0&&n.room.clist.some(function(e){return 2!==e.lcnt}))){var r=n.room.clist.length;if(0<e?s<r:r<s){if(this.failcode.add(t),this.checkOnly)return;n.room.clist.seterr(1)}}}},checkPassesSingleMarks:function(){this.checkAllRoom(-3,function(e){return 0<=e.qnum&&0<e.lcnt},"bkDifferentMarksPassed")},checkPassesAnyMarks:function(){this.checkAllRoom(-1,function(e){return!0},"bkNoMarksPassed")},checkAllRoom:function(e,t,i){for(var n=this.board.roommgr.components,s=0;s<n.length;s++){var r=n[s],o=r.clist.some(function(e){return 2!==e.lcnt||e.ice()});if(!o&&r.markType===e){if(this.failcode.add(i),this.checkOnly)break;r.clist.filter(t).seterr(1)}}},checkConsecutiveMarks:function(){for(var e=[],t=this.board.border,i=0;i<t.length;i++){var n,s,r=t[i];0!==r.line&&((s=r.sidecell[0].ice())!==r.sidecell[1].ice()&&(n=r.sidecell[s?0:1].room,r=r.sidecell[s?1:0].room,void 0===e[s=n.clist[0].id]&&(e[s]=[]),e[s].push(r)))}for(i in e){var o=e[i],a=o[0].markType;if(2===o.length&&0<=a&&a===o[1].markType){if(this.failcode.add("bkSameMarksPassed"),this.checkOnly)break;for(var c=0;c<2;c++)o[c].clist.filter(function(e){return 0<=e.qnum}).seterr(1)}}},checkCrossOutOfIce:function(){this.checkAllCell(function(e){return 4===e.lcnt&&!e.ice()},"lnCrossExIce")},checkNoLineOnNum:function(){this.checkAllCell(function(e){return-1!==e.qnum&&0===e.lcnt},"lnIsolate")}}});
//# sourceMappingURL=icewalk.js.map