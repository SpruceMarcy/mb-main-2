/*! @license pzpr.js v (c) 2009-2024 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(){var e,t,i,n,s,o,r,a,h,l,c,u,d,b,m,p={version:""},f=("object"==typeof module&&module.exports?module.exports=p:this.pzpr=p,!function(){var L=this.document,e={exports:{}};!function(e,t){var l,c,u,d,b,o,n,s,m=void 0!==L?L:void 0,p=2*Math.PI,i=[],r=function(){for(var e=[],t=256;t<512;t++)e[t-256]=t.toString(16).substr(1);return e}(),f={version:"0.8.2",env:{node:"object"==typeof e&&"object"==typeof t&&"function"==typeof require,browser:"object"==typeof L&&"object"==typeof window&&"object"==typeof location},wrapper:{},addWrapper:function(e,t){function i(){this.initialize&&this.initialize.apply(this,arguments)}for(var n in this.wrapperbase)i.prototype[n]=this.wrapperbase[n];for(n in t)i.prototype[n]=t[n];this.wrapper[e]=i.prototype.constructor=i,this.addType(e)},_order:[],enable:{},addType:function(e){this._order.push(e),this.enable[e]=!0,this.current||(this.current=e)},TypeList:function(e){for(var t=0;t<f._order.length;t++)this[f._order[t]]=f._order[t]===e},current:"",select:function(e){return!!this.enable[e]&&(this.current=e,!0)},ME:null,initME:function(){var e=m.createElement("div");e.style.display="inline",e.style.position="absolute",e.style.top="0px",e.style.left="-9000px",e.innerHTML="",m.body.appendChild(e),void 0!==e.offsetHeight?this.ME=e:m.body.removeChild(e)},getoffsetHeight:function(e,t){var i,n;return t.match(/(.+\s)?([0-9]+)px (.+)$/)?i=+RegExp.$2:this.ME&&((n=this.ME).style.font=t,n.style.lineHeight="100%",n.innerHTML=e,i=n.offsetHeight),i},color:i,parse:function(e){var t;return i[e]||("rgb("===e.substr(0,4)?(t=e.match(/\d+/g),i[e]=["#",r[t[0]],r[t[1]],r[t[2]]].join("")):i[e]=e),i[e]},getRectSize:function(e){return{width:e.offsetWidth||e.clientWidth||0,height:e.offsetHeight||e.clientHeight||0}},_counter:-1,getcanvasid:function(){return this._counter++,"_candle_"+this._counter},start:function(e,t,i){var n;if(this.ME||"undefined"==typeof window||this.initME(),e.getContext)n=e.getContext("2d");else{if(!(t=this.enable[t]?t:this.current)||!this.enable[t])throw"No canvas environment is installed";n=new this.wrapper[t](e)}i&&i(n)}};function g(e){return m.createElementNS(c,e)}function a(){var e,t;if(this.parentNode)return 0<=(t=(e=this.parentNode._children).indexOf(this))?e[t+1]:null}function h(e){e.parentNode&&e.parentNode.removeChild(e),this._children.push(e),e.parentNode=this}function k(e){var t=this._children.indexOf(e);return 0<=t&&(this._children.splice(t,1),e.parentNode=null),e}function v(e,t){e.parentNode&&e.parentNode.removeChild(e);var i=-1;-1===(i=t?this._children.indexOf(t):i)?this.appendChild(e):this._children.splice(i,0,e)}function y(e,t){e=(e=(e=e.replace(/\*/g,"[^/]+")).replace(/([\w#]+|\*)/g,"[^/]*$1[^/]*")).replace(/\s+/g,"/([^/]+/)?"),e=new RegExp(e+"[^/]*$");for(var i=this.firstChild?[this.firstChild]:[],n=[];0<i.length;){var s=i.pop();if(function(e,t){for(var i="";e&&e!==t;){var n="";e.createElement||(n=e.tagName+(e._attr.id?"#"+e._attr.id:"")),i=n+(i?"/"+i:""),e=e.parentNode}return i}(s,this).match(e)&&(n.push(s),t))break;s.nextSibling&&i.push(s.nextSibling),0<s.childNodes.length&&i.push(s.firstChild)}return n}function w(e){return y.call(this,e,!1)}function x(e){return y.call(this,e,!0)[0]||null}function N(){return this._children.reduce(function(e,t,i,n){return e+t.outerHTML},"")}function C(e,t){for(;;){var i=t.match(/^\s*([\w\-\:]+)(\=)?(?:['"](.+?)['"]|([^\s]+))?\s*/);if(!i)break;var n=i[1],s=i[3]||i[4]||"";t=RegExp["$'"],n&&("="===i[2]?"style"!==n?e.setAttribute(n,s):e.style=function(e,t){for(;;){var i=t.match(/^\s*([^:]+?):([^;]+?);?/);if(!i)break;e.style[i[1]]=i[2],t=RegExp["$'"]}}(e,s):e.setAttribute(n,!0))}}function A(e){this.tagName=e,this._attr={},this.style={},this._children=[]}if("object"==typeof e&&"object"==typeof t?e.exports=f:this.Candle=f,A.prototype={tagName:"",style:null,_attr:null,_children:null,parentNode:null,nodeType:1,get nodeName(){return this.tagName},get firstChild(){return this._children[0]},get lastChild(){return this._children[this._children.length-1]},get childNodes(){return this._children},get nextSibling(){return a.call(this)},appendChild:h,removeChild:k,insertBefore:v,setAttribute:function(e,t){this._attr[e]=t},setAttributeNS:function(e,t,i){this._attr[t]=i},getAttribute:function(e){return e in this._attr?this._attr[e]:null},getAttributeNS:function(e,t){return t in this._attr?this._attr[t]:null},removeAttribute:function(e){delete this._attr[e]},get id(){return this._attr.id||""},get innerHTML(){return N.call(this)},get outerHTML(){return function(){var e,t,i=this.tagName,n="",s="";for(e in this._attr)n+=" "+e+'="'+this._attr[e]+'"';for(t in this.style)s+=t+":"+this.style[t]+";";return s&&(n+=' style="'+s+'"'),0===this._children.length?"<"+i+n+"/>":"<"+i+n+">"+this.innerHTML+"</"+i+">"}.call(this)},get textContent(){return this.innerHTML.replace(/<.+?>/g,"")},set textContent(e){this._children.forEach(function(e){this.removeChild(e)}.bind(this)),this.appendChild(new o(e))},querySelector:x,querySelectorAll:w},(o=function(e){this.data=e}).prototype={_attr:{},parentNode:null,nodeType:3,nodeName:"#text",data:"",firstChild:null,chilsNodes:[],get nextSibling(){return a.call(this)},get outerHTML(){return this.data}},(n=f.MockDocument=function(){this._children=[]}).prototype={_children:null,nodeType:9,nodeName:"#document",createElement:function(e){return new A(e)},createElementNS:function(e,t){return new A(t)},createTextNode:function(e){return new o(e)},get firstChild(){return this._children[0]},get lastChild(){return this._children[this._children.length-1]},get childNodes(){return this._children},appendChild:h,removeChild:k,insertBefore:v,get innerHTML(){return N.call(this)},get outerHTML(){return N.call(this)},querySelector:x,querySelectorAll:w,getElementById:function(e){return this.querySelector("#"+e)}},(t=f.MockXMLSerializer=function(){}).prototype.serializeToString=function(e){return e.outerHTML},(e=f.MockDOMParser=function(){}).prototype.parseFromString=function(e,t){return i=new n,s=[i],e.split(/(<.+?>)/g).forEach(function(e){var t,i,n=s[s.length-1];e.match(/^<\?xml/)||(e.match(/^<\w/)?(t=e.match(/<(\w+)\s*(.*)\/?>/),C(i=new A(t[1]),t[2]),n.appendChild(i),e.match(/\/>$/)||s.push(i)):e.match(/^<\//)?s.pop():e.match(/^[\s\t\r\n]*$/)||n.appendChild(new o(e)))}),i;var i,s},m=m||new n,f.document=m,f.XMLSerializer=t,f.DOMParser=e,f.wrapperbase={initialize:function(e){this.fillStyle="black",this.strokeStyle="black",this.lineWidth=1,this.font="14px system",this.textAlign="center",this.textBaseline="middle",this.canvas=e,this.canvasid=f.getcanvasid(),this.child=null,this.enableTextLengthWA=!1,this.initElement(),this.initFunction(),this.initLayer();var t=this;this.canvas.getContext=function(e){return t}},rectcenter:function(e,t,i,n){this.rect(e-i,t-n,2*i,2*n)},fillRectCenter:function(e,t,i,n){this.fillRect(e-i,t-n,2*i,2*n)},strokeRectCenter:function(e,t,i,n){this.strokeRect(e-i,t-n,2*i,2*n)},shapeRectCenter:function(e,t,i,n){this.shapeRect(e-i,t-n,2*i,2*n)},vhide:function(){}},void 0===m||!m.createElementNS||"object"==typeof window&&window.opera||(c=f.SVGNS="http://www.w3.org/2000/svg",u=f.XLINKNS="http://www.w3.org/1999/xlink",d=(t=f.env.browser&&navigator.userAgent||"").match(/Trident\//)||t.match(/Safari\//)&&t.match(/Edge\//),b={left:"start",center:"middle",right:"end"},f.addWrapper("svg",{initialize:function(e){var t;this.use=new f.TypeList("svg"),l||(t="undefined"!=typeof navigator&&navigator.userAgent||"",l=t.match(/Chrome/)?{"candle-top":-.72,top:-.95,hanging:-.72,middle:-.35,alphabetic:0,bottom:.25}:t.match(/AppleWebKit/)?{"candle-top":-.7,top:-.9,hanging:-.9,middle:-.35,alphabetic:0,bottom:.25}:t.match(/Trident/)?{"candle-top":-.74,top:-1.02,hanging:-1.02,middle:-.32,alphabetic:0,bottom:.45}:t.match(/Win/)?{"candle-top":-.7,top:-.85,hanging:-.85,middle:-.34,alphabetic:0,bottom:.15}:{"candle-top":-.76,top:-.9,hanging:-.9,middle:-.38,alphabetic:0,bottom:.08}),this.vid="",this.elements={},this._textcache={},this.target=null,this.layers={},this.cpath=[],this.lastpath="",this.freezepath=!1,f.wrapperbase.initialize.call(this,e),this.enableTextLengthWA=d},initElement:function(){f.env.browser&&(this.canvas.style.overflow="hidden");var e=f.getRectSize(this.canvas),t=this.child=m.createElementNS(c,"svg");t.setAttribute("xmlns",c),t.setAttribute("xmlns:xlink",u),t.setAttribute("font-size","10px"),t.setAttribute("font-family","sans-serif"),t.setAttribute("width",e.width),t.setAttribute("height",e.height),t.setAttribute("viewBox",[0,0,e.width,e.height].join(" ")),this.canvas.appendChild&&this.canvas.appendChild(t)},initFunction:function(){function n(e){return(e.outerHTML||(new f.XMLSerializer).serializeToString(e)).replace(/^<\?xml.+?\?>[\r\n]*/,"")}var s='<?xml version="1.0" encoding="UTF-8"?>\n',o=this.child;this.canvas.toDataURL=function(e,t){return"data:image/svg+xml;base64,"+(i=n(o),f.env.browser?window.btoa(i):(Buffer.isBuffer(i)?i:new Buffer(i.toString(),"binary")).toString("base64"));var i},this.canvas.toBlob=function(e,t,i){e(new Blob([s+n(o)],{type:"image/svg+xml"}))},this.canvas.toBuffer=function(e,t){return s+n(o)}},initLayer:function(){this.setLayer();var e=f.getRectSize(this.canvas);this.rect(0,0,e.width,e.height),this.addVectorElement(!1,!1)},clear:function(){for(var e=this.child,t=e.firstChild;t;)e.removeChild(t),t=e.firstChild;this.vid="",this.elements={},this.layers={},this.target=this.child,this.setLayer(),this._textcache={}},setLayer:function(e,t){var i;t=t||{},this.vid="",e?((i=this.layers[e])||(i=this.layers[e]=g("g"),this.child.appendChild(i)),this.target=i):this.target=this.child,t.rendering&&this.setRendering(t.rendering),this.freezepath=!!t&&t.freeze},setRendering:function(e){this.target.setAttribute("shape-rendering",e)},changeSize:function(e,t){f.env.browser&&(this.canvas.style.width=e+"px",this.canvas.style.height=t+"px");var i=this.child,n=(i.setAttribute("width",e),i.setAttribute("height",t),i.getAttribute("viewBox").split(/ /));i.setAttribute("viewBox",[n[0],n[1],e,t].join(" "))},translate:function(e,t){var i=this.child.getAttribute("viewBox").split(/ /);i[0]=-e,i[1]=-t,this.child.setAttribute("viewBox",i.join(" "))},beginPath:function(){this.cpath=[],this.lastpath=""},closePath:function(){this.cpath.push("z"),this.lastpath="z"},moveTo:function(e,t){this.cpath.push("M",e,t),this.lastpath="M"},lineTo:function(e,t){"L"!==this.lastpath&&this.cpath.push("L"),this.cpath.push(e,t),this.lastpath="L"},rect:function(e,t,i,n){this.cpath.push("M",e,t,"L",e+i,t,e+i,t+n,e,t+n,"z"),this.lastpath="z"},arc:function(e,t,i,n,s,o){var r,a,h,e=p<=s-n?(h=r=e+i,a=t):(r=e+i*Math.cos(n),a=t+i*Math.sin(n),h=e+i*Math.cos(s),t+i*Math.sin(s)),t=(p<=s-n&&(a+=.125),s<n!=Math.abs(s-n)>Math.PI),s=o^t?1:0;this.cpath.push("M",r,a,"A",i,i,0,s,0==s^t?1:0,h,e),this.lastpath="A"},fill:function(){this.addVectorElement(!0,!1)},stroke:function(){this.addVectorElement(!1,!0)},shape:function(){this.addVectorElement(!0,!0)},fillRect:function(e,t,i,n){var s=this.cpath;this.cpath=[],this.rect(e,t,i,n),this.addVectorElement(!0,!1),this.cpath=s},strokeRect:function(e,t,i,n){var s=this.cpath;this.cpath=[],this.rect(e,t,i,n),this.addVectorElement(!1,!0),this.cpath=s},shapeRect:function(e,t,i,n){var s=this.cpath;this.cpath=[],this.rect(e,t,i,n),this.addVectorElement(!0,!0),this.cpath=s},setLinePath:function(){for(var e=arguments,t=e.length,i=t-(1|t?1:2),n=[],s=0;s<i;s+=2)n[s>>1]=[e[s],e[s+1]];this.beginPath(),this.setLinePath_com.call(this,n),e[t-1]&&this.cpath.push("z")},setOffsetLinePath:function(){for(var e=arguments,t=e.length,i=t-(1|t?1:2),n=[],s=0;s<i-2;s+=2)n[s>>1]=[e[s+2]+e[0],e[s+3]+e[1]];this.beginPath(),this.setLinePath_com.call(this,n),e[t-1]&&this.cpath.push("z")},setLinePath_com:function(e){for(var t=0,i=e.length;t<i;t++)this.cpath.push(0===t?"M":"L"),this.cpath.push(e[t][0],e[t][1])},strokeLine:function(e,t,i,n){var s=this.cpath;this.cpath=["M",e,t,"L",i,n],this.addVectorElement(!1,!0),this.cpath=s},strokeDashedLine:function(e,t,i,n,s){var o=this.cpath;this.cpath=["M",e,t,"L",i,n],this.addVectorElement(!1,!0).setAttribute("stroke-dasharray",s.join(" ")),this.cpath=o},strokeCross:function(e,t,i){var n=this.cpath;this.cpath=["M",e-i,t-i,"L",e+i,t+i,"M",e-i,t+i,"L",e+i,t-i],this.addVectorElement(!1,!0),this.cpath=n},fillCircle:function(e,t,i){var n=this.cpath;this.cpath=[],this.arc(e,t,i,0,p,!1),this.cpath.push("z"),this.addVectorElement(!0,!1),this.cpath=n},strokeCircle:function(e,t,i){var n=this.cpath;this.cpath=[],this.arc(e,t,i,0,p,!1),this.cpath.push("z"),this.addVectorElement(!1,!0),this.cpath=n},shapeCircle:function(e,t,i){var n=this.cpath;this.cpath=[],this.arc(e,t,i,0,p,!1),this.cpath.push("z"),this.addVectorElement(!0,!0),this.cpath=n},getDefsElement:function(){var e=this.child.querySelector("defs");return e||(e=m.createElementNS(c,"defs"),this.child.insertBefore(e,this.child.firstChild||null)),e},getImageElement:function(e){for(var t=this.getDefsElement(),i=null,n=t.querySelectorAll("image"),s=0;s<n.length;s++)if(n[s].getAttributeNS(u,"href")===e.src){i=n[s];break}return i||((i=g("image")).setAttribute("id",(i.ownerDocument?this.canvasid+"_":"")+"img"+n.length),i.setAttribute("width",e.width),i.setAttribute("height",e.height),i.setAttributeNS(u,"xlink:href",e.src),t.appendChild(i)),i},getImageSymbol:function(e,t,i,n,s){for(var o=this.getDefsElement(),r=[t,i,n,s].join(" "),a=null,h=o.querySelectorAll("symbol"),l=0;l<h.length;l++)if(h[l].getAttribute("viewBox")===r){a=h[l];break}return a||((a=m.createElementNS(c,"symbol")).setAttribute("id",(a.ownerDocument?this.canvasid+"_":"")+"symimg"+h.length),a.setAttribute("viewBox",r),(t=m.createElementNS(c,"use")).setAttributeNS(u,"xlink:href","#"+this.getImageElement(e).getAttribute("id")),a.appendChild(t),o.appendChild(a)),a},fillText:function(e,t,i,n){var s=this.vid?this.elements[this.vid]:null;e&&this.fillStyle&&"none"!==this.fillStyle?(e=this.fillText_main(s,e,t,i,n||""),!s&&this.vid&&(this.elements[this.vid]=e)):s&&this.hide(s),this.vid=""},fillText_main:function(e,t,i,n,s){var o,r,a=!e,h=this.vid&&this._textcache[this.vid]||{};return a?e=g("text"):this.show(e),e.getAttribute("fill")!==this.fillStyle&&e.setAttribute("fill",this.fillStyle),h.x===i&&h.y===n&&h.ml===s&&h.ta===this.textAlign&&h.tb===this.textBaseline&&h.font===this.font||(o=n-f.getoffsetHeight(t,this.font)*l[this.textBaseline.toLowerCase()],r=b[this.textAlign.toLowerCase()],e.getAttribute("x")!==i&&e.setAttribute("x",i),e.getAttribute("y")!==o&&e.setAttribute("y",o),e.getAttribute("text-anchor")!==r&&e.setAttribute("text-anchor",r),(e.getAttribute("textLength")||"")!==s&&(s?(e.setAttribute("textLength",s),e.setAttribute("lengthAdjust","spacingAndGlyphs")):(e.removeAttribute("textLength"),e.removeAttribute("lengthAdjust"))),h.x=i,h.y=n,h.ml=s,h.ta=this.textAlign,h.tb=this.textBaseline),h.font!==this.font&&(this.font.match(/(.+\s)?([0-9]+)px (.+)$/)?(o=RegExp.$1,r=RegExp.$2,i=RegExp.$3,e.setAttribute("font-size",r),i.match(/^sans\-serif$/i)?e.removeAttribute("font-family"):e.setAttribute("font-family",i),o.match(/(italic|oblique)/)?e.setAttribute("font-style",RegExp.$1):e.removeAttribute("font-style"),o.match(/(bold|bolder|lighter|[1-9]00)/)?e.setAttribute("font-weight",RegExp.$1):e.removeAttribute("font-weight")):e.setAttribute("font",this.font),h.font=this.font),e.textContent!==t&&(e.textContent=t),this.vid&&(this._textcache[this.vid]=h),a&&this.target.appendChild(e),d&&this.enableTextLengthWA&&("center"===h.ta||"right"===h.ta)&&s&&(e.removeAttribute("textLength"),n=e.getBoundingClientRect(),e.setAttribute("x",h.x+(n.width-s)/("center"===h.ta?2:1)),e.setAttribute("textLength",s)),e},drawImage:function(e,t,i,n,s,o,r,a,h){var l=this.vid?this.elements[this.vid]:null;e?(void 0===n&&(n=e.width,s=e.height),void 0===o&&(o=t,r=i,i=t=0,a=n,h=s),e=this.drawImage_main(l,e,t,i,n,s,o,r,a,h),!l&&this.vid&&(this.elements[this.vid]=e)):l&&this.hide(l),this.vid=""},drawImage_main:function(e,t,i,n,s,o,r,a,h,l){var c=!e,t=(c?e=g("use"):this.show(e),this.getImageSymbol(t,i,n,s,o).getAttribute("id"));return e.getAttribute("x")!==r&&e.setAttribute("x",r),e.getAttribute("y")!==a&&e.setAttribute("y",a),e.getAttribute("width")!==h&&e.setAttribute("width",h),e.getAttribute("height")!==l&&e.setAttribute("height",l),e.getAttributeNS(u,"xlink:href")!=="#"+t&&e.setAttributeNS(u,"xlink:href","#"+t),c&&this.target.appendChild(e),e},addVectorElement:function(e,t){e=e&&!!this.fillStyle&&"none"!==this.fillStyle,t=t&&!!this.strokeStyle&&"none"!==this.strokeStyle;var i=this.vid?this.elements[this.vid]:null,n=null;return e||t?(n=this.addVectorElement_main(i,e,t),!i&&this.vid&&(this.elements[this.vid]=n)):i&&this.hide(i),this.vid="",n},addVectorElement_main:function(e,t,i){var n=!e,s=(n?((e=g("path")).setAttribute("fill","none"),e.setAttribute("stroke","none")):this.show(e),this.freezepath&&!n||(s=this.cpath.join(" "),o=i?this.lineWidth:null,e.getAttribute("d")!==s&&e.setAttribute("d",s),e.getAttribute("stroke-width")!==o&&e.setAttribute("stroke-width",o)),t?this.fillStyle:"none"),o=i?this.strokeStyle:"none";return e.getAttribute("fill")!==s&&e.setAttribute("fill",s),e.getAttribute("stroke")!==o&&e.setAttribute("stroke",o),n&&this.target.appendChild(e),e},vhide:function(e){var t=this.elements[this.vid];t&&this.hide(t)},show:function(e){e.removeAttribute("display")},hide:function(e){e.setAttribute("display","none")}})),f.env.browser){if(!(e=m.createElement("canvas")).getContext||e.probablySupportsContext&&!e.probablySupportsContext("2d"))return}else try{f.Canvas=require("canvas")}catch(e){return}f.addWrapper("canvas",{initialize:function(e){var t;this.context=null,this.use=new f.TypeList("canvas"),this.currentLayerId="_empty",this.isedgearray={_empty:!1},this.isedge=!1,s||(t="undefined"!=typeof navigator&&navigator.userAgent||"",s=0,s=t.match(/Chrome/)?-.72:t.match(/AppleWebKit/)?-.7:t.match(/Trident/)?-.74:t.match(/Win/)?-.7:-.76),this.x0=0,this.y0=0,f.wrapperbase.initialize.call(this,e)},setkey:function(e){return this},hidekey:function(e){return this},release:function(e){return this},initElement:function(){var e=this.child=f.env.browser?m.createElement("canvas"):new f.Canvas,t=(f.env.browser&&(this.canvas.style.overflow="hidden"),f.getRectSize(this.canvas));e.width=t.width,e.height=t.height,f.env.browser&&(e.style.width=t.width+"px",e.style.height=t.height+"px",this.canvas.appendChild(e)),this.context=e.getContext("2d")},initFunction:function(){function a(e){return f.env.browser?window.atob(e):new Buffer(RegExp.$2,"base64").toString("binary")}var h=this.child;this.canvas.toDataURL=function(e,t){return h.toDataURL(e||void 0,t)},this.canvas.toBlob=function(e,t,i){if("function"==typeof h.toBlob)h.toBlob(e,t,i);else{h.toDataURL(t||void 0,i).match(/data:(.*);base64,(.*)/);for(var n=a(RegExp.$2),s=n.length,o=new Uint8Array(s),r=0;r<s;r++)o[r]=n.charCodeAt(r);e(new Blob([o.buffer],{type:RegExp.$1}))}},this.canvas.toBuffer=function(e,t){e=h.toDataURL(e||void 0,t).replace(/^data:image\/\w+?;base64,/,"");if(f.env.node)return new Buffer(e,"base64");if("undefined"!=typeof Uint8Array)for(var i=a(e),n=new Uint8Array(i.length),s=0;s<i.length;s++)n[s]=i.charCodeAt(s);else n=a(e);return n}},initLayer:function(){this.setLayer()},clear:function(){var e;this.setProperties(!0,!0),this.context.setTransform(1,0,0,1,0,0),this.context.translate(this.x0,this.y0),f.env.browser&&(e=f.getRectSize(this.canvas),this.context.clearRect(0,0,e.width,e.height))},setLayer:function(e,t){e=this.currentLayerId=e||"_empty";this.isedge=this.isedgearray[void 0!==this.isedgearray[e]?e:"_empty"],this.setEdgeStyle(),(t=t||{}).rendering&&this.setRendering(t.rendering)},setEdgeStyle:function(){var e;f.env.browser&&"imageRendering"in(e=this.canvas.style)&&(e.imageRendering="",this.isedge&&(e.imageRendering="pixelated",e.imageRendering||(e.imageRendering="-webkit-optimize-contrast"),e.imageRendering||(e.imageRendering="-moz-crisp-edges"),e.imageRendering||(e.imageRendering="-o-crisp-edges")))},setRendering:function(e){this.isedge=this.isedgearray[this.currentLayerId]="crispEdges"===e,this.setEdgeStyle()},changeSize:function(e,t){f.env.browser&&((s=this.canvas).style.width=e+"px",s.style.height=t+"px");var i,n,s=this.child;f.env.browser&&(i=parseInt(s.style.left),t+=(n=parseInt(s.style.top))<0?-n:0,s.style.width=(e+=i<0?-i:0)+"px",s.style.height=t+"px"),s.width=e,s.height=t},translate:function(e,t){this.x0=e,this.y0=t,this.context.translate(e,t)},setProperties:function(e,t){e=e&&!!this.fillStyle&&"none"!==this.fillStyle,t=t&&!!this.strokeStyle&&"none"!==this.strokeStyle;var i=this.context;return e&&(i.fillStyle=this.fillStyle),t&&(i.strokeStyle=this.strokeStyle),i.lineWidth=this.lineWidth,i.font=this.font,i.textAlign=this.textAlign,i.textBaseline=this.textBaseline,e||t},beginPath:function(){this.context.beginPath()},closePath:function(){this.context.closePath()},moveTo:function(e,t){this.context.moveTo(e,t)},lineTo:function(e,t){this.context.lineTo(e,t)},rect:function(e,t,i,n){this.context.rect(e,t,i,n)},arc:function(e,t,i,n,s,o){this.context.arc(e,t,i,n,s,o)},fill:function(){this.setProperties(!0,!1)&&this.context.fill()},stroke:function(){this.setProperties(!1,!0)&&this.context.stroke()},shape:function(){var e;this.setProperties(!0,!0)&&(e=this.context,this.fillStyle&&"none"!==this.fillStyle&&e.fill(),this.strokeStyle&&"none"!==this.strokeStyle&&e.stroke())},fillRect:function(e,t,i,n){this.setProperties(!0,!1)&&this.context.fillRect(e,t,i,n)},strokeRect:function(e,t,i,n){this.setProperties(!1,!0)&&this.context.strokeRect(e,t,i,n)},shapeRect:function(e,t,i,n){var s;this.setProperties(!0,!0)&&(s=this.context,this.fillStyle&&"none"!==this.fillStyle&&s.fillRect(e,t,i,n),this.strokeStyle&&"none"!==this.strokeStyle&&s.strokeRect(e,t,i,n))},setLinePath:function(){for(var e=arguments,t=e.length,i=t-(1|t?1:2),n=[],s=0;s<i;s+=2)n[s>>1]=[e[s],e[s+1]];this.context.beginPath(),this.setLinePath_com.call(this,n),e[t-1]&&this.context.closePath()},setOffsetLinePath:function(){for(var e=arguments,t=e.length,i=t-(1|t?1:2)-2,n=[],s=0;s<i;s+=2)n[s>>1]=[e[s+2]+e[0],e[s+3]+e[1]];this.context.beginPath(),this.setLinePath_com.call(this,n),e[t-1]&&this.context.closePath()},setLinePath_com:function(e){for(var t=0,i=e.length;t<i;t++){var n=e[t];0===t?this.context.moveTo(n[0],n[1]):this.context.lineTo(n[0],n[1])}},strokeLine:function(e,t,i,n){var s;this.setProperties(!1,!0)&&((s=this.context).beginPath(),s.moveTo(e,t),s.lineTo(i,n),s.stroke())},strokeDashedLine:function(e,t,i,n,s){this.strokeDashedLine=this.context.setLineDash?function(e,t,i,n,s){var o=this.context;this.setProperties(!1,!0)&&(o.beginPath(),o.moveTo(e,t),o.lineTo(i,n),o.setLineDash(s),o.stroke(),o.setLineDash([]))}:function(e,t,i,n,s){s.length%2==1&&(s=s.concat(s));var o=Math.sqrt((i-e)*(i-e)+(n-t)*(n-t)),r=0,a=0,h=null,l=null;if(e!==i&&(l=(h=(n-t)/(i-e))*h+1),this.setProperties(!1,!0)){var c,u,d=this.context;for(d.beginPath(),d.moveTo(e,t);r<o;)u=null!==h?(c=e+(u=Math.sqrt(r*r/l)),t+h*u):(c=e,t+r),0==(1&a)?d.moveTo(c,u):d.lineTo(c,u),r+=s[a],++a>=s.length&&(a=0);d.stroke()}},this.strokeDashedLine(e,t,i,n,s)},strokeCross:function(e,t,i){var n;this.setProperties(!1,!0)&&((n=this.context).beginPath(),n.moveTo(e-i,t-i),n.lineTo(e+i,t+i),n.moveTo(e-i,t+i),n.lineTo(e+i,t-i),n.stroke())},fillCircle:function(e,t,i){var n;this.setProperties(!0,!1)&&((n=this.context).beginPath(),n.arc(e,t,i,0,p,!1),n.fill())},strokeCircle:function(e,t,i){var n;this.setProperties(!1,!0)&&((n=this.context).beginPath(),n.arc(e,t,i,0,p,!1),n.stroke())},shapeCircle:function(e,t,i){var n;this.setProperties(!0,!0)&&((n=this.context).beginPath(),n.arc(e,t,i,0,p,!1),this.fillStyle&&"none"!==this.fillStyle&&n.fill(),this.strokeStyle&&"none"!==this.strokeStyle&&n.stroke())},fillText:function(e,t,i,n){e&&this.setProperties(!0,!1)&&("candle-top"===this.textBaseline&&(i-=f.getoffsetHeight(e,this.font)*s,this.context.textBaseline="alphabetic"),n?this.context.fillText(e,t,i,n):this.context.fillText(e,t,i))},drawImage:function(){arguments[0]&&this.context.drawImage.apply(this.context,arguments)}})}(e,e.exports),p.Candle=e.exports}(),document=this.document||p.Candle.document,this.DOMParser||p.Candle.DOMParser),g=this.XMLSerializer||p.Candle.XMLSerializer;function k(e){if(navigator&&"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(e){e.forEach(function(e){e.unregister()}),0<e.length&&location&&setTimeout(function(){location.reload()},500)}),n){n=!1;for(var t=0;t<s.length;t++)s[t]();s=[]}}function v(e){o&&o.key&&o.key.e_keydown(e)}function y(e){o&&o.key&&o.key.e_keyup(e)}p.failcodes={en:{"akariDup.lightup":"Akari is shined from another Akari.","anHatenaNe.crossstitch":"There are no crossings in the given direction.","anLineGt.castle":"The number of line segments is not correct.","anLineLt.castle":"The number of line segments is not correct.","anLineLt.disloop":"There is no line segment in the cell adjacent to the arrow.","anNoAdjBd.yajitatami":"There is no border in front of the arrowed number.",anNoArrow:"A number has no arrow.",anNoShade:"The cell next to the arrow is not shaded.","anNumberNe.crossstitch":"The number of crossings is not correct.","anNumberNe.hebi":"A clue points at the wrong number.","anShadeNe.lixloop":"A clue does not indicate the type of cell that is most common.","anShadeNe.yajisoko":"The number of boxes is not correct.",anShadeNe:"The number of shaded cells is not correct.","anTatamiNe.yajitatami":"The number of tatamis are not correct.","anUnitNe.kuroclone":"The size of the pointed unit is not correct.","arAdjPair.toichika":"There are paired arrows in adjacent countries.","arAdjPair.toichika2":"There are paired numbers in adjacent countries.","arAgainstWind.nagare":"The direction of the arrow is against the wind.","arAlone.toichika":"There is no paired arrow in the direction of an arrow.","arAlone.toichika2":"A number can not see an identical number.","arBlkEdge.loute":"An arrow is not at the endpoint of an area.","arBlocked.toichika2":"Other numbers are between a pair of numbers.","arBlockLt2.evolmino":"The arrow passes through less than two blocks.","arDistance.toichika2":"A pair of numbers does not have the correct distance.","arDistanceGt.myopia":"There is a line closer to a clue in an unmarked direction.","arDistanceGt.pentopia":"There is a shaded cell closer to a clue in an unmarked direction.","arDistanceNe.myopia":"The lines pointed to by a clue are at different distances.","arDistanceNe.pentopia":"The shaded cells pointed to by a clue are at different distances.","arInvalid.evolmino":"The arrow is invalid.",arNoLine:"A line doesn't go through some arrows.",arNoLineSeen:"There is no line in the direction of an arrow.","arNoShade.pentopia":"There is no shaded cell in the direction of an arrow.","arNotMax.makaro":"An arrow doesn't point out biggest number.","arNotPtCnr.loute":"An arrow doesn't point at the corner of an area.","arNotRelative.news":"A letter doesn't indicate its position relative to the other letter in the area.","asLblockNe.triplace":"The number of straight areas below or to the right is not correct.","asShadeNe.tilepaint":"The number of shaded cells underward or rightward is not correct.","baDir.lollipops":"A stick has the wrong orientation.","bankGt.battleship":"A ship appears too many times on the board.",bankGt:"A piece appears too many times on the board.",bankInvalid:"The board contains an invalid piece.","bankInvalid.battleship":"The board contains an invalid ship.","bankLt.battleship":"Some ships are not used on the board.",bankLt:"Some pieces are not used on the board.","bankNe.tachibk":"The left and right grids contain different pieces.","baParaGe3.juosan":"There are at least three vertical or horizontal bars in parallel.","baPlNum.tateyoko":"A line passes more than one number.","bdBranch.kramma":"There is a branch line.","bdBranchExBP.bdblock":"Lines are branched out of the point.","bdCountLt3BP.bdblock":"A point has two or less lines.",bdCross:"There is a crossing border line.","bdCrossBP.kramma":"There is a crossing line on the point.","bdCrossExBP.bdblock":"Lines are crossed out of the point.","bdCurveExBP.kramma":"A line curves out of the points.",bdDeadEnd:"There is a dead-end line.","bdDoorsGt.oneroom":"Two rooms have more than one door between them.","bdEqual.antmill":"A square clue does not overlap two cells of the same color.","bdIgnoreBP.bdblock":"A point has no line.","bdIgnoreBP.kramma":"A point has no line.","bdNotChassis.shwolf":"A line doesn't connect to the chassis.","bdPassStar.nuriuzu":"A star overlaps a shaded cell.","bdPassStar.tentaisho":"A line goes over a star.","bdUnequal.antmill":"A cross clue does not overlap exactly 1 shaded cell.","bdUnused.fillomino":"A given border does not divide two regions.","bdUnused.kissing":"A bar is not adjacent to two different blocks.","bdUnused.lohkous":"There is an unused border.","bdUnused.mirrorbk":"A mirror does not divide two regions.","bdUnused.tren":"A border is not adjacent to a block.","bdUnusedCircle.wafusuma":"A circle does not divide two areas.",bdVoxasBlack:"Two areas separated by a black dot have the same size or the same orientation.",bdVoxasGray:"Two areas separated by a gray dot are identical, or have both a different size and different orientation.",bdVoxasWhite:"Two areas separated by a white dot are different.","bdwGroundFloor.bdwalk":"The line goes below the 1st floor.","bdwInvalidDown.bdwalk":"The line goes down at an upward elevator.","bdwInvalidUp.bdwalk":"The line goes up at a downward elevator.","bdwMismatch.bdwalk":"The line goes through different numbers without switching floors.","bdwSkipElevator.bdwalk":"The line doesn't change floors at an elevator.","bdwTopFloor.bdwalk":"The line goes above the top floor.","bkArafEqual.araf":"An area is equal to a number.","bkArafTooBig.araf":"An area is larger than both numbers.","bkArafTooSmall.araf":"An area is smaller than both numbers.","bkBothMarksPassed.moonsun":"A line passes both the marks of the moon and the sun.","bkCircleNe.familyphoto":"A number does not indicate the amount of circles in the area.","bkCircleNe.fracdiv":"A number does not indicate the ratio of circles and cells in the area.","bkClue.toichika2":"A number does not match the clue for the country.","bkDifferentLetters.nikoji":"Two areas with different letters have the same shape.","bkDifferentLines.pmemory":"Two regions of the same shape have different lines.","bkDifferentMarksPassed.genderwalk":"A visit to land passes different symbols.","bkDifferentOrientation.nikoji":"Two areas with equal letters have different orientation.","bkDifferentPosition.nikoji":"Two areas with equal letters have the letter in different positions.","bkDifferentShape.dbchoco":"The two shapes inside a block are different.","bkDifferentShape.kuroclone":"Two units in an area have different shapes.","bkDifferentShape.nikoji":"Two areas with equal letters have different shapes.",bkDivide:"The unused cells are divided.","bkDoubleBn.yosenabe":"There is two or more numbers in a crock.","bkDupNum.hakoiri":"A box has duplicate shapes.","bkDupNum.hebi":"A snake has duplicate numbers.","bkDupNum.makaro":"A room has two or more same numbers.","bkDupNum.renban":"A room has two or more equal numbers.","bkDupNum.ripple":"A room has two or more same numbers.","bkDupNum.roma":"An area has duplicate arrows.","bkDupNum.sukoro":"A room has two or more same numbers.","bkDupNum.sukororoom":"A room has two or more same numbers.","bkDupNum.view":"A room has two or more same numbers.",bkDupNum:"There are equal numbers in a block.","bkHingeGt.hinge":"A block goes through multiple borders.","bkHingeLt.hinge":"A block does not go through any borders.","bkHingeMirror.hinge":"A block is not symmetric along the region border.","bkHingeSplit.hinge":"The region border which separates a block is not continuous.","bkLadderNe.ladders":"A number does not indicate the amount of ladders overlapping the region.","bkLenGt4.fillmat":"The width of the tatami is more than one, or the length is more than four.","bkLessThan2Num.araf":"An area has less than two numbers.","bkLiarNe1.usoone":"The number of liars in a room is not one.","bkLineGt.nagenawa":"The number of the cells that is passed any line in the room and the number written in the room is different.","bkLineLt.nagenawa":"The number of the cells that is passed any line in the room and the number written in the room is different.","bkLineNe.country":"The number of the cells that is passed any line in the country and the number written in the country is different.","bkLineNe.nothing":"A country isn't fully visited.","bkMajorBarGt.juosan":"The number of majority of vertical or horizontal bars is greater than the number of the area.","bkMajorBarLt.juosan":"The number of majority of vertical or horizontal bars is less than the number of the area.","bkMirror.mirrorbk":"The two blocks divided by a mirror are not reflections of each other.",bkMissingNum:"A block doesn't contain every number.","bkMixed.sukoro":"A room includes both numbered and non-numbered cells.","bkMixed.sukororoom":"A room includes both numbered and non-numbered cells.","bkMixed.view":"A room includes both numbered and non-numbered cells.",bkMixed:"A tile includes both shaded and unshaded cells.","bkMixedNum.fillomino":"An area has two or more kinds of numbers.","bkMoreThan2Num.araf":"An area has more than two numbers.","bkMSGe2.nondango":"An area has two or more shaded circles.","bkMSPassedGt2.moonsun":"A line passes the marks of the moon for two rooms in a row.","bkMUPassedGt2.moonsun":"A line passes the marks of the sun for two rooms in a row.","bkNoChain.chainedb":"A block is not diagonally adjacent to another block.","bkNoChain.mrtile":"A block is not diagonally adjacent to another identical block.","bkNoColor.interbd":"A country has no color.","bkNoLevel.aquarium":"A region has different water surface levels.","bkNoLine.country":"A line doesn't pass a country.","bkNoLine.icebarn":"A icebarn is not gone through.","bkNoLine.moonsun":"A line doesn't pass a room.","bkNoLine.onsen":"A room remains blank.","bkNoLine.ovotovata":"A line doesn't pass a shaded country.","bkNoLineNe.mejilink":"The size of the tile is not equal to the total of length of lines that is remained dotted around the tile.","bkNoMarksPassed.genderwalk":"A visit to land passes no symbols.","bkNoMarksPassed.moonsun":"A line passes neither the marks of the moon nor the sun.","bkNoMatch.dotchi":"Circles in a region contain both curves and straight lines.","bkNoMS.nondango":"An area has no shaded circle.","bkNoNum.bonsan":"A room has no circle.","bkNoNum.fillmat":"A tatami has no numbers.","bkNoNum.hanare":"A room has no numbers.","bkNoNum.kaero":"An area has no letters.","bkNoNum.kramma":"An area has no marks.","bkNoNum.nanro":"There is an empty room.","bkNoNum.nawabari":"A room has no numbers.","bkNoNum.nikoji":"An area has no letter.","bkNoNum.nurikabe":"An area of unshaded cells has no numbers.","bkNoNum.putteria":"A room has no numbers.","bkNoNum.shikaku":"An area has no numbers.","bkNoNum.shwolf":"An area has neither sheeps nor wolves.","bkNoNum.tatamibari":"A tatami has no marks.","bkNoNum.toichika":"A country has no arrow.","bkNoNum.yosenabe":"A crock has no circle.",bkNoNum:"A block has no number.","bkNoObj.kinkonkan":"A room has no mirrors.","bkNoSC.dosufuwa":"An area has no iron ball.","bkNoShade.shimaguni":"A marine area has no shaded cells.",bkNoShade:"A room has no shaded cell.","bkNoStar.tentaisho":"An area has no stars.","bkNotAllMSPassed.moonsun":"A line doesn't pass all of the marks of the moon.","bkNotAllMUPassed.moonsun":"A line doesn't pass all of the marks of the sun.","bkNotHRect.tatamibari":"A tatami is not a horizontally long rectangle.","bkNotLshape.loute":"An area is not L-shaped or its width is not 1.","bkNotLshape3.shikaku":"An area whose size is a multiple of three is not L-shaped.","bkNotPassTwice.doubleback":"A room isn't passed exactly twice.","bkNotRect.scrin":"An area is not a rectangle.","bkNotRect.shikaku":"An area is not a rectangle.","bkNotRect.tatamibari":"A tatami is not rectangle.","bkNotRect.voxas":"An area is not a rectangle.",bkNotRect:"There is a room whose shape is not a rectangle.","bkNotRect3.shikaku":"An area whose size is not a multiple of three is not a rectangle.","bkNotSeqNum.renban":"The numbers in the room are not consecutive.",bkNotSquare:"An area is not a square.","bkNotSquare.tatamibari":"A tatami is not a square.","bkNotSymmRoom.fillomino":"An area is not point symmetric.","bkNotSymRoom.ayeheya":"The room is not point symmetric.","bkNotSymShade.ayeheya":"Position of shaded cells in the room is not point symmetric.","bkNotSymSt.tentaisho":"An area is not point symmetric about the star.","bkNotVRect.tatamibari":"A tatami is not a vertically long rectangle.","bkNoUC.dosufuwa":"An area has no balloon.","bkNumGe2.compass":"There is an area with more than one clue.","bkNumGe2.fillmat":"A tatami has more than one number.","bkNumGe2.hanare":"A room has more than one number.","bkNumGe2.lohkous":"There is an area with more than one clue.","bkNumGe2.nawabari":"A room has more than one number.","bkNumGe2.nikoji":"An area has multiple letters.","bkNumGe2.nurikabe":"An area of unshaded cells has more than one number.","bkNumGe2.putteria":"A room has more than one number.","bkNumGe2.scrin":"An area has multiple clues.","bkNumGe2.shikaku":"An area has more than one number.","bkNumGe2.tatamibari":"A tatami has multiple marks.","bkNumGe2.toichika":"A country has more than one arrow.",bkNumGe2:"A block has multiple numbers.","bkNumGe3.news":"An area has more than two letters.","bkNumGt2.magnets":"A room has more than two poles.","bkNumGt2.sashikazune":"A block has more than two numbers.","bkNumGt3.hakoiri":"A box has more than three shapes.","bkNumLt2.magnets":"A room has half a magnet.","bkNumLt2.news":"An area has less than two letters.","bkNumLt3.hakoiri":"A box has less than three shapes.","bkNumUnshade.scrin":"A clue is not inside a rectangle.","bkObjGe2.kinkonkan":"A room has more than one mirror.","bkObjNotSym.bonsan":"Position of circles in the room is not point symmetric.","bkOddSize.kazunori":"The size of the room is not even.","bkOverlap.subomino":"A block fits entirely in an adjacent block.",bkOverNum:"A block contains too many numbers.","bkPassTwice.country":"A line passes a country twice or more.","bkPassTwice.moonsun":"A line passes a room twice or more.","bkPinNe.heyapin":"A number does not indicate the amount of pins overlapping the region.","bkPlColor.interbd":"A country has more than one color.","bkPlNum.kaero":"An area has more than one kind of letter.","bkPlNum.kramma":"An area has both white and black circles.","bkPlNum.shwolf":"An area has both sheeps and wolves.",bkPlNum:"A block has two or more kinds of number.","bkPlStar.tentaisho":"A block has two or more stars.","bkPluralShade.parquet":"A region has multiple shaded tiles.","bkRect.cbblock":"A block is rectangle.","bkSameMarksPassed.genderwalk":"Consecutive visits to land pass identical symbols.","bkSameNumGt2.kazunori":"The room has three or more same numbers.","bkSameTouch.nawabari":"Two areas of the same shape and orientation are adjacent.","bkSCGe2.dosufuwa":"An area has two or more iron balls.","bkSepColor.interbd":"One kind of color is included in different countries.","bkSepNum.kaero":"Letters of one kind are placed in different areas.",bkSepNum:"One kind of number is included in different blocks.","bkShadeDistNe.mannequin":"The amount of empty cells between the two shaded cells is different from the number.","bkShadeDivide.invlitso":"Unshaded cells are divided in a room.","bkShadeDivide.shimaguni":"The shaded cells in a marine area are divided.",bkShadeDivide:"Shaded cells are divided in a room.",bkShadeGt2:"A room has three or more shaded cells.","bkShadeGt4.invlitso":"A room has three or less unshaded cells.","bkShadeGt4.lits":"A room has five or more shaded cells.",bkShadeLt2:"A room has only one shaded cell.","bkShadeLt4.invlitso":"A room has five or more unshaded cells.","bkShadeLt4.lits":"A room has three or less shaded cells.","bkShadeNe.chocona":"The number of shaded cells in the area and the number written in the area is different.","bkShadeNe.shimaguni":"The number of shaded cells is not equal to the number.",bkShadeNe:"The number of shaded cells in the room and the number written in the room is different.","bkSideNe.squarejam":"The side length of a room is not equal to a number inside of it.","bkSize1.rectslider":"There is an isolated shaded cell.","bkSize1.yajitatami":"The length of the tatami is one.","bkSizeEq.fillmat":"The number is equal to the size of the tatami.","bkSizeGt.aquapelago":"A group of shaded cells is larger than the number.","bkSizeGt.dbchoco":"A number is smaller than the size of the shape.","bkSizeGt.fillomino":"A number is smaller than the size of the area.","bkSizeGt.icewalk":"A section of unshaded cells is longer than the number.","bkSizeGt.lightshadow":"A number is smaller than the size of the area.","bkSizeGt.martini":"A number is smaller than the amount of circles in the area.","bkSizeGt2.lollipops":"Lollipops are adjacent.","bkSizeGt2.waterwalk":"A line goes through 3 or more water cells.","bkSizeGt2.genderwalk":"A line goes through 3 or more gender fluid cells.",bkSizeGt2:"The size of an area is larger than two.",bkSizeGt3:"The size of an area is larger than three.",bkSizeGt4:"The size of an area is larger than four.",bkSizeGt5:"The size of an area is larger than five.","bkSizeLt.aquapelago":"A group of shaded cells is smaller than the number.","bkSizeLt.dbchoco":"A number is bigger than the size of the shape.","bkSizeLt.fillomino":"A number is bigger than the size of the area.","bkSizeLt.icewalk":"A section of unshaded cells is shorter than the number.","bkSizeLt.lightshadow":"A number is bigger than the size of the area.","bkSizeLt.martini":"A number is bigger than the amount of circles in the area.","bkSizeLt2.lollipops":"There are incomplete lollipops.",bkSizeLt2:"The size of an area is smaller than two.",bkSizeLt3:"The size of an area is smaller than three.",bkSizeLt4:"The size of an area is smaller than four.",bkSizeLt5:"The size of an area is smaller than five.","bkSizeNe.cbanana":"The number is not equal to the size of the area.","bkSizeNe.fillmat":"The number is different from the size of the tatami.","bkSizeNe.hanare":"The size of the room is not equal to the number.","bkSizeNe.nurikabe":"The number is not equal to the size of the area.","bkSizeNe.putteria":"The size of the room is not equal to the number.","bkSizeNe.scrin":"The size of the area is not equal to the number.","bkSizeNe.shikaku":"The size of the area is not equal to the number.","bkSizeNe.tateyoko":"The number is different from the length of the line.","bkSizeNe.tontti":"The amount of empty cells is not equal to the number.","bkSizeNe.yajitatami":"The size of tatami and the number written in Tatami is different.",bkSizeNe:"The size of the block is not equal to the number.","bkSizeNe5.hebi":"The size of a snake is not five.","bkSmallOnBig.ripple":"There is a smaller number on top of a bigger number in a room.","bkStarGt.starbattle":"The number of stars in an area is too large.","bkStarLt.starbattle":"The number of stars in an area is too small.","bkSubdivided.oneroom":"A room is divided internally by shaded cells.","bkSubGt2.cbblock":"A block has three or more areas framed by dotted line.","bkSubGt2.dbchoco":"A block has three or more shapes.","bkSubLt2.cbblock":"A block has one area framed by dotted line.","bkSubLt2.dbchoco":"A block contains a single color.","bkSumNeBn.yosenabe":"Sum of filling is not equal to a crock.","bkUCGe2.dosufuwa":"An area has two or more balloons.","bkUnitNe2.kuroclone":"There is an area without exactly two units.","bkUnknown.lohkous":"A room has a segment of invalid length.","bkUnshade.lapaz":"A 1x1 region is unshaded.",bkUnshadeConsecGt3:"There is a line of consecutive unshaded cells that goes through 2 region borders.",bkWidthGt1:"The width of the tatami is not one.","bkWrongNum.armyants":"The numbers on the ant are wrong.","blLineDiff.onsen":"The length of the path in a room is different in some rooms.","blLineLong.maxi":"A line in a room is longer than the number.","blLineNe.onsen":"The length of the path in a room is different from the number of the loop.","blLineShort.maxi":"All lines in a room are shorter than the number.","blNoHatena.ovotovata":'Lines that exit a "?" region turn at different positions.',"blNoNumber.ovotovata":"A line that exits a numbered region turns at the wrong position.","blPassTwice.onsen":"A line passes a room more than once.","blPassTwice.rassi":"A room has more than one line.",blRemLength:"A number does not indicate the length of the visit in the next room.","blWrongTurns.detour":"A room has the wrong number of turns.","bnIllegalPos.yosenabe":"There is a number out of a crock.","brNoLine.kouchoku":"There is no segment.",brNoLine:"There is no line on the board.",brNoShade:"There are no shaded cells on the board.","brNoStone.goishi":"There are no goishis on the board.","brNoTriangle.shakashaka":"There are no triangles on the board.",brNoValidNum:"There are no numbers on the board.","brObjNotSym.bonsan":"Position of circles is not point symmetric.","bsAnt.armyants":"Two ants are adjacent.","bsArrowGt2.evolmino":"The block has more than one square that is placed on arrows.","bsEqShade.mannequin":"The distance between the two shaded cells is the same in adjacent rooms.","bsEqShade.shimaguni":"The sizes of countries that are in adjacent marine areas are the same.","bsNoArrow.evolmino":"The block isn't placed on an arrow.","bsNotEvol.evolmino":"The block doesn't have the same shape as the previous block with one additional square.","bsSameNum.fillomino":"Adjacent areas have the same number.","bsSameShape.chainedb":"A chain contains two identical blocks.","bsSameShape.lits":"Some tetrominoes that have the same shape are adjacent.",bsSameShape:"Two blocks that have the same shape are adjacent.","bsSizeEq.fillmat":"Tatamis of the same size are adjacent.","bsSnake.hebi":"Different snakes are adjacent.","cbDiffLenNe.renban":"The difference between two numbers is not equal to the length of the line between them.","cbNoLine.country":"Adjacent cells in different countries are both unused by the loop.","cbNoLine.nothing":"Two unvisited countries are adjacent.","cbSameNum.nanro":"Adjacent blocks have the same number.","cbShade.shimaguni":"Countries in different marine areas are adjacent.",cbShade:"Shaded cells are adjacent over a border.",cbUnshade:"Unshaded cells are adjacent over a border.",ceAddLine:"A cell with given lines has extra lines.","ceDark.lightup":"A cell is not shined.","ceDirection.compass":"The number of cells in the direction is wrong.","ceDirection.mukkonn":"A line that exits a cell turns at the wrong position.","ceDirection.guidearrow":"A cell does not follow the indicated direction towards the goal.","ceEmpty.kaidan":"There is an empty cell.","ceEmpty.lightshadow":"There is an undetermined cell.","ceEmpty.shugaku":"There is an empty cell.","ceEmpty.yajilin-regions":"There is an empty cell.","ceEmpty.yajilin":"There is an empty cell.","ceIntersect.nanameguri":"A line goes over a diagonal border.","ceInvalidLadder.ladders":"A ladder doesn't connect two separate regions.","ceNoBar.juosan":"There is an empty cell.","ceNoBar.tateyoko":"There is an empty cell.","ceNoEnd.kaidan":"A rectangle is not closed.","ceNoLine.arukone":"A crossing is left blank.",ceNoLine:"There is an empty cell.","ceNoNum.compass":"There is an area without a clue.","ceNoNum.kakuro":"There is an empty cell.","ceNoNum.lohkous":"There is an area without a clue.","ceNoNum.yinyang":"There is an empty cell.",ceNoNum:"There is an empty cell.","ceNoSlash.gokigen":"There is an empty cell.","ceNumGtSize.armyants":"A number is greater than the size of the ant.","ceOverlap.tachibk":"A block in the left grid overlaps an equally sized block in the right grid.","cePortalMiscount.portal":"There aren't exactly two portals with the same number.","ceSuspend.sukoro":"There is a cell that is not filled in number.","ceSuspend.sukororoom":"There is a cell that is not filled in number.","ceSuspend.view":"There is a cell that is not filled in number.","ceTapaNe.tapa":"The number is not equal to the length of surrounding shaded cells.","ceTooManyBlocks.doppelblock":"There are more than two blocks in a row or column.","ceUnused.kinkonkan":"A mirror is unused.","ciNotOnCnr.loute":"A circle is not at the corner of an area.","circleNotPromontory.kurodoko":"A circle is not a dead end.","circleShade.kissing":"A crossed cell is shaded.",circleShade:"A white circle is shaded.","circleUnshade.snake":"A circle is not shaded.",circleUnshade:"A black circle is not shaded.","circNoLine.balance":"A circle has no line.","clueUnused.railpool":"Some of the region's numbers don't match with any segment's length.",complete:"Complete!","crAdjacent.tajmahal":"A square does not touch the correct amount of other squares.","crConnSlNe.gokigen":"A number is not equal to count of lines that is connected to it.","crNoSegment.tajmahal":"A clue is not inside a square.","crShadeGt.creek":"The number of shaded cells around a number on crossing is big.","crShadeLt.creek":"The number of shaded cells around a number on crossing is small.","cs2x2.snake":"The snake loops back on itself.",cs2x2:"There is a 2x2 block of shaded cells.","cs3.aqre":"There are more than three shaded cells in a row.","csAdjacent.kaidan":"Some circles are adjacent.",csAdjacent:"Some shaded cells are adjacent.","csConnOut.kurodoko":"Some shaded cells are not connected to the outside.","csConsecGt3.tawa":"Three or more shaded cells continue horizontally.","csCornerSize.nuribou":"Masses of shaded cells with the same length share a corner.","csdDivide.scrin":"There is a rectangle that is not connected to the other rectangles.","csDistance.nothree":"Three consecutive cells in the same row have the same distance.","csDivide.shugaku":"The aisle is divided.",csDivide:"The shaded cells are divided.","csDivide8.mochikoro":"The unshaded cells are divided.","csGt1.nothree":"A dot overlaps more than one shaded cell.","csGt1.takoyaki":"A line has more than one circle in the middle.",csGt2:"The size of a mass of shaded cells is over two.",csGt4:"The size of a mass of shaded cells is over four.","csGtLimit.kissing":"Two blocks are adjacent in an invalid location.","csLoop.parquet":"There is a loop of shaded cells.","csLt1.nothree":"A dot doesn't overlap a shaded cell.","csLt1.takoyaki":"A line has no circle in the middle.",csLt2:"There is a single shaded cell.",csLt4:"The size of a mass of shaded cells is less than four.",csMismatch:"A given piece has missing cells.","csMismatch.retroships":"A shaded piece has missing cells.","csNoLevel.aquarium":"A body of water has different surface levels.","csNoSupport.aquarium":"A water cell is next to or above an empty cell.","csNotBottom.dosufuwa":"An iron ball is not on the bottom of the row or on another iron ball.","csNotOnShade.tawa":"There are no shaded cells under a shaded cell.",csNotRect:"A mass of shaded cells is not rectangle.",csNotSquare:"A group of shaded cells is not a square.",csOnArrow:"A cell with a clue is shaded.",csPieceExtra:"A given piece has incorrect cells around it.","csPieceExtra.retroships":"A shaded piece has incorrect cells around it.","csRect.mochikoro":"There is a block of shaded cells that is a rectangle.","csUpper.stostone":"Shaded cells remain in the upper half of the board after the blocks have fallen.","csWidthGt1.nuribou":"There is a mass of shaded cells whose width is more than one.",cu2x2:"There is a 2x2 block of unshaded cells.","cu3.aqre":"There are more than three unshaded cells in a row.",cuConnOut:"Some unshaded cells are not connected to the outside.","cuDivide.kaidan":"The rectangles are divided.","cuDivide.wittgen":"The cells not used by rectangles are divided.",cuDivide:"The unshaded cells are divided.",cuDivideRB:"The unshaded cells are divided.","cuEndpoint.takoyaki":"An endpoint does not have a circle.",cuLoop:"There is a loop of unshaded cells.","cuLower.stostone":"Unshaded cells exist in the lower half of the board after the blocks have fallen.","cuNoLine.icebarn":"The line doesn't pass all of the non-icy cell.","cuNoLine.nagenawa":"There is no line on the unshaded cell.","cuNotRect.mochikoro":"There is a block of unshaded cells that is not a rectangle.","cuNotRectx.shakashaka":"A white area is not rectangle.",cuNotSquare:"An unshaded area is not a square.","cuNotTop.dosufuwa":"A balloon is not on the top of the row or under another balloon.","cuOutside.castle":"An unshaded cell is outside of the loop.",cuRect:"A mass of unshaded cells is a rectangle.","cuRoomGt.akichi":"A cluster of unshaded cells is larger than the number.","cuRoomLt.akichi":"All clusters of unshaded cells are smaller than the number.","cxAdjacent.crossstitch":"Crossings are adjacent.","cxOverlap.heyapin":"A pin overlaps a single region.","exMinusNe.magnets":"The number of Minus signs in the row or column is not correct.","exNoMatch.nonogram":"The shaded cells don't match the clues in the row or column.","exPlusNe.magnets":"The number of Plus signs in the row or column is not correct.","exShadeNe.aquarium":"The number of shaded cells in the row or column is not correct.","exShadeNe.battleship":"The number of shaded cells in the row or column is not correct.","exShadeNe.snake":"The number of shaded cells in the row or column is not correct.","exTentNe.tents":"The number of tents in the row or column is not correct.","futonHalf.shugaku":"There is a half-size futon.","futonMidPos.shugaku":"There is a futon that is not connected to the aisle.","gateRedup.slalom":"A line goes through a gate twice or more.","gateUnpass.slalom":"A gate is not passed by the loop.","goishiRemains.goishi":"There is remaining Goishi.","haisuError.haisu":"A number is not passed on the right visit.","haisuError.kaisu":"A region visit contains an incorrect amount of circles.","haisuSG.haisu":"The line goes through S/G.",invalid:"Invalid Error","kitamakura.shugaku":"There is a futon that faces down.","laCurve.herugolf":"A ball curves halfway.","laCurve.kaidan":"Two rectangles overlap.",laCurve:"A line has curve.","laIsolate.bonsan":"A line doesn't connect any circle.","laIsolate.herugolf":"A line doesn't connect any ball.","laIsolate.oyakodori":"A line doesn't connect to any bird.","laIsolate.rectslider":"A line doesn't connect any shaded cell.","laIsolate.yosenabe":"A line doesn't connect any filling.",laIsolate:"A line doesn't connect to any letter.","laLenNe.herugolf":"A ball stops halfway.",laLenNe:"The length of a line is wrong.",laLoop:"A line forms a loop.","laMoveOver.herugolf":"You make a bogey or more.",laOnBorder:"There is a line across a border.","laOnHole.herugolf":"A line goes through a hole.","laOnIce.oyakodori":"A line goes through a nest cell.","laOnNum.armyants":"There is a line across a number.","laOnNum.bonsan":"A line goes through a circle.","laOnNum.herugolf":"A line goes through a ball.","laOnNum.oyakodori":"A line goes through a bird.","laOnNum.rectslider":"A line goes through a shaded cell.","laOnNum.yajisoko":"A line goes through a box.","laOnNum.yosenabe":"A line goes through a filling.",laOnNum:"A line goes through a letter.","laShadeOnBorder.oyakodori":"A black bird goes over a border.","laUnshadeNoBorder.oyakodori":"A white bird does not go over a border.","laWaterHazard.herugolf":"A ball lands into the water.","lbDivide.amibo":"The bars are not connected.","lbIsolate.walllogic":"A line doesn't connect to any number.","lbLenGt.amibo":"The length of the bar is too long.","lbLenLt.amibo":"The length of the bar is too short.","lbLoop.amibo":"There is a loop of bars.","lbNotCrossEq.amibo":"A bar doesn't cross a bar whose length is the same.","lcBalance.coffeemilk":"A group doesn't have an equal number of white and black circles.","lcCurveGt1.ichimaga":"The number of curves is twice or more.","lcCurveGt2.kusabi":"A line turns more than twice.","lcCurveLt2.kusabi":"A line turns less than twice.","lcCurveNe.firefly":"The number of curves is different from a firefly's number.",lcDeadEnd:"There is a dead-end line.",lcDivided:"All lines and numbers are not connected to each other.","lcGrayGt.coffeemilk":"A group has more than one gray circle.","lcInvalid.coffeemilk":"A white and black circle are connected directly.","lcInvalid.kusabi":"The types of connected circles don't match.","lcInvBlack.wblink":"Two black circles are connected.","lcInvDirB.firefly":"Points are connected each other.","lcInvDirW.firefly":"Fireflies are connected without a line starting from point.","lcInvWhite.wblink":"Two white circles are connected.","lcIsolate.arukone":"A line doesn't connect any alphabet.","lcIsolate.kusabi":"A line isn't connected to any circle.",lcIsolate:"A line doesn't connect to any number.","lcLenInvDiff.kusabi":"The relative lengths of the legs of a U don't match the clues.","lcLenInvNe.kusabi":"The legs of a U have different lengths.","lcNotKusabi.kusabi":"A line is not U-shaped.","lcOnNum.anglers":"A line goes through a symbol.","lcOnNum.arukone":"A line goes through an alphabet.","lcOnNum.kusabi":"A line goes through a circle.",lcOnNum:"A line goes through a number.","lcSameNum.ichimaga":"Same numbers are connected each other.","lcTripleNum.arukone":"Three or more alphabets are connected.","lcTripleNum.kusabi":"Three or more objects are connected.","lcTripleNum.wblink":"Three or more objects are connected.",lcTripleNum:"Three or more numbers are connected.","lnAdjacent.ladders":"Two ladders touch.","lnAdjacent.pmemory":"The path loops back on itself.","lnAdjacent.tontti":"Identical line shapes are connected.",lnBranch:"There is a branch line.","lnConsecutive.kaidan":"Two adjacent rectangles don't have a size difference of 1.","lnCross.crossstitch":"A loop crosses itself.",lnCross:"There is a crossing line.","lnCrossExCir.pipelink":"There is a crossing line out of circles.",lnCrossExIce:"A line is crossed outside of ice.",lnCrossExMk:"There is a crossing outside given crosses.","lnCrossOnNum.pipelink":"Lines are crossed on a number.","lnCrossPencil.pencils":"A line crosses a pencil.","lnCurveOnCir.pipelink":"A line turns on a circle.","lnCurveOnCir.portal":"A line turns on an unmarked portal.",lnCurveOnIce:"A line turns on ice.",lnCurveOnNum:"A line turns on a station.",lnDeadEnd:"There is a dead-end line.","lnDeadEndAround.rassi":"Two line ends are adjacent.","lnDivide.familyphoto":"A line divides two circles.","lnEnds.kaidan":"The short ends of two rectangles are adjacent.","lnExTri.reflect":"A line doesn't goes through a triangle.","lnHasLoop.lither":"A tree includes a loop.","lnIsolate.anglers":"A symbol has no line.","lnIsolate.bdwalk":"A symbol has no line.","lnIsolate.dotchi":"A circle doesn't have a line.","lnIsolate.genderwalk":"A symbol has no line.","lnIsolate.icewalk":"A number has no line.","lnIsolate.kouchoku":"A segment starts outside a clue.","lnIsolate.nanameguri":"A cell with a diagonal border has no line.","lnIsolate.onsen":"A circle doesn't have a line.","lnIsolate.tajmahal":"A square does not have a clue at the center.","lnLenGt.anglers":"A line is longer than the number.","lnLenGt.reflect":"The lines passing a triangle are too long.","lnLengthGt.pencils":"A line is longer than the connected pencil.","lnLengthLt.pencils":"A line is shorter than the connected pencil.","lnLengthNe3.wittgen":"A block does not cover exactly 3 cells.","lnLenLt.anglers":"A line is shorter than the number.","lnLenLt.reflect":"The lines passing a triangle are too short.","lnMultipleTips.pencils":"A line connects to more than one pencil tip.","lnNoBorder.ladders":"A ladder doesn't touch two region borders.","lnNoBranchOrTerm.lither":"A line does not branch or terminate at a grid vertex.","lnNoFish.anglers":"A line has no fish.","lnNoNum.anglers":"A line has no number.",lnNotCrossMk:"A cross-joint cell doesn't have four-way lines.","lnNoTip.pencils":"A line is not connected to a pencil tip.","lnNotRect.nagenawa":"There is a non-rectangle loop.","lnNotSq.tajmahal":"A segment doesn't form a square.","lnOnCenter.midloop":"A circle is not the center point of a line.","lnOnClue.tajmahal":"A corner is on top of a clue.","lnOnCorner.tajmahal":"A segment overlaps a corner.","lnOnDot.midloop":"A line doesn't go over a circle.","lnOnShade.dotchi":"A line goes over a shaded circle.","lnOnShade.kaidan":"A rectangle overlaps an obstacle.","lnOnShade.yajisoko":"A line goes over a shaded cell.",lnOnShade:"There is a line on a shaded cell.","lnOverlap.kouchoku":"Some segments overlap.","lnOverlap.tontti":"A line overlaps a number.","lnPassOver.kouchoku":"A segment passes over a clue.",lnPlLine:"There are multiple lines.","lnPlLoop.crossstitch":"There aren't exactly two loops.","lnPlLoop.ladders":"Not all regions are connected.","lnPlLoop.tajmahal":"There is a square that is not connected to the other squares.",lnPlLoop:"There are multiple loops.","lnPortalCross.portal":"A line passes over a portal.","lnPortalCurve.portal":"The line exits a portal in the wrong direction.","lnRightAngle.kouchoku":"Segments don't intersect at a right angle.","lnSnLine.lither":"There is only one tree.","lnStarNe.starbattle":"The number of stars in a line is wrong.","lnWrongAngle.kouchoku":"Some segments meet at the wrong angle.","lookairBC.lookair":"Two squares of the same size can see each other.","lpNoNum.onsen":"A loop has no numbers.","lpNoNum.pipelink":"A loop has no numbers.","lpNumGt2.onsen":"A loop has more than one number.","lpPlNum.pipelink":"A loop has multiple kinds of number.","lpSepNum.pipelink":"A kind of number is in different loops.","lrAcrossArrow.nagare":"The line passes across an arrow.","lrAcrossWind.nagare":"The line passes across the wind.","lrAgainstArrow.nagare":"The line passes against an arrow.","lrAgainstWind.nagare":"The line passes against the wind.","lrDeadEnd.icebarn":"There is a dead-end line.","lrOffField.icebarn":"A line is not reached out the 'OUT' arrow.","lrOrder.icebarn":"A line goes through an arrow reverse.","lrOrder.slalom":"A gate is passed in the wrong order.","lrReverse.icebarn":"A line goes through an arrow reverse.","mashuBCvNbr.mashu":"Lines turn next to a black pearl.","mashuBStrig.mashu":"Lines go straight through a black pearl.","mashuOnLine.mashu":"Lines don't pass some pearls.","mashuWCurve.mashu":"Lines turn on a white pearl.","mashuWStNbr.mashu":"Lines go straight next to a white pearl on both sides.","ms2x2.yinyang":"There is a 2x2 block of shaded circles.","msConsecGt3.nondango":"There are three or more shaded circles in a row.","msDivide.yinyang":"Shaded circles are divided.","mu2x2.yinyang":"There is a 2x2 block of unshaded circles.","muConsecGt3.nondango":"There are three or more unshaded circles in a row.","muDivide.yinyang":"Unshaded circles are divided.","nm2x2.nanro":"There is a 2x2 block of numbers.","nmAdjacent.hanare":"Some numbers are adjacent.","nmAdjacent.magnets":"Equal poles are adjacent.",nmAdjacent:"Equal numbers are adjacent.","nmAdjacentGt2.tontonbeya":"A cluster of symbols is adjacent to 2 or more clusters with the same symbol.","nmAdjacentLt2.tontonbeya":"A cluster of symbols is not adjacent to another cluster with the same symbol.","nmAdjDiff.magnets":"Adjacent poles of different magnets are not equal.","nmAkariNe.lightup":"The number is not equal to the number of Akari around it.","nmAround.hakoiri":"Equal shapes touch.","nmAround.kakuru":"Same numbers are adjacent.","nmAround.ripple":"Equal numbers touch.","nmBorderNe.nawabari":"The number is not equal to the number of border lines around it.","nmBranch.snakepit":"A snake branches off.","nmCircleNe.brownies":"A number is not equal to the amount of circles in the surrounding cells.","nmCircleNe.crossstitch":"A circled number is not equal to the amount of corners used by a loop.","nmConnBarWrong.tateyoko":"The number of lines connected to a shaded cell is wrong.","nmConnDiff.arukone":"Different alphabets are connected.","nmConnDiff.kouchoku":"Different letters are connected directly.","nmConnDiff.numlin":"Different numbers are connected.","nmConnected.bonsan":"There are connected circles.","nmConnected.herugolf":"There are connected balls.","nmConnected.oyakodori":"There are connected birds.","nmConnected.rectslider":"There are connected shaded cells.","nmConnected.yajisoko":"There are connected boxes.","nmConnected.yosenabe":"There are connected fillings.",nmConnected:"There are connected letters.","nmConnNoWall.walllogic":"The number isn't connected by any lines.","nmConnWallGt.walllogic":"The lines connected to a number is long.","nmConnWallLt.walllogic":"The lines connected to a number is short.","nmCountGt.nanro":"A number is smaller than the count.","nmCountGt.simplegako":"The number of the identical numbers in the same row or column is bigger than the number in the cell.","nmCountLt.nanro":"A number is bigger than the count.","nmCountLt.simplegako":"The number of the identical numbers in the same row or column is smaller than the number in the cell.","nmDiag.snakepit":"A snake touches itself diagonally.","nmDiffDistNe.hanare":"The distance of the paired numbers is not equal to their difference.","nmDiffDistNe.putteria":"The distance of the paired numbers is not equal to their difference.","nmDistNe.sashikazune":"A number is not equal to the distance to the region's corner.","nmDivEq2.kropki":"The number is double the other between two adjacent cells without shaded circle.","nmDivide.hakoiri":"The shapes are divided.","nmDivide.tontonbeya":"Identical symbols are divided in a room.",nmDivide:"Numbers are divided.","nmDivNe2.kropki":"The number is not double the other between two adjacent cells with shaded circle.","nmDupRow.alter":"A row or column does not have alternating symbols.","nmDupRow.easyasabc":"There are equal letters in a row or column.","nmDupRow.lollipops":"Two identical symbols can see each other.","nmDupRow.takoyaki":"Two circles in the same row or column belong to the same line.",nmDupRow:"There are equal numbers in a row or column.","nmDupRowCol.toichika2":"A number has an identical number in both the same row and column.","nmEndpoint.snakepit":"A circle is not on an endpoint.","nmEqOne.snakepit":"There is a snake of length 1.","nmGt2.oyakodori":"There are more than two birds in the same nest.","nmHatenaNe.crossstitch":"A circled question mark does not have any corners used by a loop.","nmIgnored.herugolf":"There is a Hole without a ball.","nmIneqNe.minarism":"A inequality sign is not correct.","nmLineGt.hashikake":"The number of connecting bridges to a number is not correct.","nmLineGt.wittgen":"The number of blocks adjacent to a number is not correct.","nmLineGt1.amibo":"Multiple lines connect to a white circle.","nmLineLt.hashikake":"The number of connecting bridges to a number is not correct.","nmLineLt.wittgen":"The number of blocks adjacent to a number is not correct.","nmLineLt2.kouchoku":"A clue doesn't have two segments.","nmLineNe.ichimaga":"The number is not equal to the number of lines out of the circle.","nmLineNe.lither":"The number is not equal to the number of lines around it.","nmLineNe.slither":"The number is not equal to the number of lines around it.","nmLoop.snakepit":"A snake has no head or tail.","nmLt1.lapaz":"A number is not contained in a 1x2 region.","nmLt2.oyakodori":"There is a lonely bird.","nmMidpoint.snakepit":"A grey cell is not a middle part of a snake.","nmMinesNe.mines":"The number of mines in the surrounding cells is not equal to the number.","nmMissing.lohkous":"There is no segment of the given length in the room.","nmMissRow.alter":"A row or column has less than two symbols.","nmMissRow.easyasabc":"There are missing letters in a row or column.","nmMixed.aquapelago":"A group contains different numbers.","nmMoveNe.tren":"A block cannot move in the correct number of spaces.","nmNoLine.amibo":"No bar connects to a white circle.","nmNoLine.coffeemilk":"A white or black circle doesn't have a line.","nmNoLine.firefly":"There is a lonely firefly.","nmNoLine.ichimaga":"A circle doesn't start any line.","nmNoLine.kusabi":"A circle is not connected to another object.","nmNoLine.wblink":"A circle doesn't start any line.",nmNoLine:"A number is not connected to another number.","nmNoMove.bonsan":"A circle doesn't start any line.","nmNoMove.rectslider":"A shaded cell doesn't start any line.","nmNoSideShade.tasquare":"No shaded cells are adjacent to square marks.","nmNotConsecNeighbors.ripple":"A number is not the neighbor of its consecutive numbers.","nmNotConseq.kouchoku":"Equal letters are not connected directly.","nmNotConseq.trainstations":"A number doesn't connect to the next consecutive number.","nmNotConseqFull.trainstations":"A number doesn't connect to the next consecutive number.","nmNotLink.kazunori":"A number doesn't link to other cells in the room.","nmNotSeq.numrope":"The numbers on a line are not consecutive.","nmNumberEq.oyakodori":"Two identical birds are in the same nest.","nmNumberNe.sukoro":"The number of numbers placed in four adjacent cells is not equal to the number.","nmNumberNe.sukororoom":"The number of numbers placed in four adjacent cells is not equal to the number.","nmNumberNe.view":"The number of numbers placed in four adjacent cells is not equal to the number.","nmOutOfBk.oyakodori":"A bird is outside a nest.","nmOutOfBk.yosenabe":"A filling isn't in a crock.","nmOutOfHole.herugolf":"A ball doesn't cup in.","nmOutsidePencil.pencils":"A number is not inside a pencil.","nmOutsideTren.tren":"A number is not contained inside a 1x2 or 1x3 block.","nmPillowGt.shugaku":"The number of pillows around the number is wrong.","nmPillowLt.shugaku":"The number of pillows around the number is wrong.","nmProduct.factors":"A number of room is not equal to the product of these numbers.","nmRange.kakuru":"A number is larger than 9.","nmRange.trainstations":"A number is out of range.","nmSame2x2.kazunori":"There is a 2x2 block of the same number.","nmSame2x2.snakepit":"A snake loops back on itself.","nmShade5Ne.lookair":"The number is not equal to the number of shaded cells in the cell and the four adjacent cells.","nmShadeDiagNe.context":"The number of shaded cells diagonally adjacent to a shaded number is not correct.","nmShadeGt.interbd":"The number of shaded cells around a number is not correct.","nmShadeGt.kaidan":"The number of circles around a number is not correct.","nmShadeLt.interbd":"The number of shaded cells around a number is not correct.","nmShadeLt.kaidan":"The number of circles around a number is not correct.","nmShadeNe.lapaz":"The number of shaded cells in the row or column is not correct.","nmShadeNe.paintarea":"The number is not equal to the number of shaded cells in the four adjacent cells.","nmShadeNe.tawa":"The number of shaded cells around a number is not correct.","nmShadeViewNe.canal":"A cell containing a clue number sees a different number of shaded cells in the four orthogonal directions.",nmShapeNe:"A shape does not match the given letter.","nmShootShadeNe1.kurochute":"There is not exactly one shaded cell at the given distance from the number.","nmSightNe.easyasabc":"The letter is not the closest.","nmSightNe.roundtrip":"The length of the closest line segment is wrong.","nmSightNe.skyscrapers":"The number of visible buildings is wrong.","nmSizeGt.pencils":"A number is larger than the length of the pencil.","nmSizeLt.pencils":"A number is smaller than the length of the pencil.","nmSizeNe.tontonbeya":"The clusters inside a room are of different sizes.","nmSmallGap.ripple":"The distance between two equal numbers is smaller than the number.","nmSubEq1.kropki":"The difference is one between two adjacent cells without white circle.","nmSubNe.minarism":"The difference between two adjacent cells is not equal to the number on circle.","nmSubNe1.kropki":"The difference is not one between two adjacent cells with white circle.","nmSubNe1.numrope":"The difference between two connected numbers is not one.","nmSum.doppelblock":"The sum of the numbers between the two blocks is wrong.","nmSumNe.kazunori":"The sum between two adjacent cells is not equal to the number on circle.","nmSumNe.wafusuma":"The sum of the size of the two adjacent areas is not equal to the number on the circle.","nmSumOfDiff.bosanowa":"Sum of the differences between the number and adjacent numbers is not equal to the number.","nmSumRowNe.kakuro":"The sum of the cells is not correct.","nmSumRowShadeNe.box":"A number is not equal to the sum of the number of shaded cells.","nmSumSizeNe.kurotto":"The number is not equal to sum of adjacent masses of shaded cells.","nmSumSizeNe.tasquare":"Sum of the adjacent masses of shaded cells is not equal to the number.","nmSumViewNe.teri":"The size of the largest possible rectangle is not equal to the number.","nmSumViewNe.view":"Sum of four-way gaps to another number is not equal to the number.",nmSumViewNe:"A cell containing a clue number sees a different number of cells in the four orthogonal directions.","nmTentGt.tents":"There are too many tents around a tree.","nmTentLt.tents":"There aren't enough tents around a tree.","nmTentNone.tents":"A tree has no tent.","nmTouchNe.tslither":"The number is not equal to the number of separate visits to the cell's edges/vertices.","nmTreeNone.tents":"A tent is not next to a tree.","nmTriangleGt.shakashaka":"There are too many triangles adjacent to a number.","nmTriangleLt.shakashaka":"There are not enough triangles adjacent to a number.","nmTripRow.alter":"A row or column has three different symbols.","nmTripRow.toichika2":"A number appears more than twice in the same row or column.","nmUnpass.icebarn":"The line doesn't pass all of the number.","nmUnshadeAdjNe.context":"The number of shaded cells orthogonally adjacent to an unshaded number is not correct.","nmVertexNe.vslither":"The number is not equal to the number of visited vertices around it.","nonCirclePromontory.kurodoko":"A dead end has no circle.","nqAroundDup.kakuru":"There are same numbers around the pre-numbered cell.","nqAroundSumNe.kakuru":"A sum of numbers around the pre-numbered cell is incorrect.","numNoLine.geradeweg":"A number has no line.","objShaded.nurimaze":"An object is shaded.","pairedLetterNe.kinkonkan":"Beam from a light doesn't reach its pair.","pairedNumberNe.kinkonkan":"The number of reflections is wrong.","pcMultipleTips.pencils":"A pencil has more than one tip.","ptInPencil.pencils":"A tip is inside a pencil.","ptNoLine.pencils":"A pencil tip is not connected to a line.","ptNoPencil.pencils":"A tip is not at the short end of a 1xN rectangle.","rmBranch.scrin":"There is a branch of rectangles.","rmDeadend.scrin":"There is a dead-end rectangle.","rmIsolated.scrin":"There is an isolated rectangle.","rmRectUnshade.scrin":"A rectangle is not part of the solution.","routeIgnoreCP.nurimaze":"There is a circle out of the shortest route from S to G.","routePassDeadEnd.nurimaze":"There is a triangle on the shortest route from S to G.","segBlackEq.balance":"Segments through a black circle are equal.","segDiff.geradeweg":"Segments have different length.","segLong.balance":"A segment is too long.","segLong.geradeweg":"A segment is longer than a number.","segShort.balance":"A segment is too short.","segShort.geradeweg":"A segment is shorter than a number.","segUnclued.railpool":"The segment's length isn't in the region's set of numbers.","segWhiteUneq.balance":"Segments through a white circle are different.","shBranch.snake":"The snake branches off.","shDiag.battleship":"Two ships are diagonally adjacent.","shDiag.pentatouch":"A place where two pieces touch isn't marked with a point.","shDiag.pentopia":"Two pieces are diagonally adjacent.","shDiag.snake":"The snake touches itself diagonally.","shEndpoint.snake":"A black circle is not on an endpoint.","shIncorrect.curvedata":"A shape does not match the clue.","shInside.castle":"A shaded cell is inside of the loop.","shLoop.snake":"The snake has no head or tail.","shMidpoint.snake":"A white circle is not a middle.","shMultiple.curvedata":"A shape is connected to multiple clues.","shNoDiag.pentatouch":"A point is not adjacent to two different pieces.","shNoDivide.interbd":"A shaded cell does not divide two or more countries.","shNone.curvedata":"A shape is not connected to a clue.","shSurrounded.interbd":"A shaded cell cannot divide two or more countries.","slLoop.gokigen":"There is a loop consisted in some slashes.","slLoopGiri.gokigen":"There is a loop that consists '切'.","slNotLoopWa.gokigen":"There is not a loop that consists '輪'.","snakeAttack.hebi":"A snake can see another snake.","starAround.starbattle":"Some stars touch.","stInvalid.icebarn":"System can't detect start position.","stLineNe2.slalom":"Start/goal circle doesn't have two lines.","stNoLine.icebarn":"The line doesn't go through the 'IN' arrow.","stopHalfway.roma":"A cell cannot reach a goal.","tapaloopError.disloop":"Following the loop from the arrow does not lead to segments of the correct length.","tapaloopError.tapaloop":"The segments around a clue are not the same length as the numbers.","tentAround.tents":"Some tents touch.","tooFewUnspecified.railpool":"The region contains fewer unspecified segment lengths than question marks.","tooManyUnspecified.railpool":"The region contains more unspecified segment lengths than question marks.","unusedCell.pencils":"A cell is unused."},ja:{"akariDup.lightup":"照明に別の照明の光が当たっています。","anHatenaNe.crossstitch":"矢印の先に、ループが交わっているマスがありません。","anLineGt.castle":"矢印の方向にあるループの長さが数字よりも長いです。","anLineLt.castle":"矢印の方向にあるループの長さが数字よりも短いです。","anNoAdjBd.yajitatami":"矢印の方向に境界線がありません。",anNoArrow:"矢印がない数字のマスがあります。",anNoShade:"矢印の１マス先に黒マスがありません。","anNumberNe.crossstitch":"ループが交わっているマスの数が正しくありません。","anNumberNe.hebi":"矢印の先にある数字が正しくありません。",anShadeNe:"矢印の方向にある黒マスの数が正しくありません。","anTatamiNe.yajitatami":"矢印の方向にあるタタミの数が正しくありません。","anUnitNe.kuroclone":"矢印の先にあるユニットの大きさが正しくありません。","arAdjPair.toichika":"辺を共有する国にペアとなる矢印が入っています。","arAdjPair.toichika2":"ペアとなる数字の入っている領域が隣り合っています。","arAgainstWind.nagare":"矢印の向きが風の指示と合っていません。","arAlone.toichika":"矢印の先にペアとなる矢印がいません。","arAlone.toichika2":"ペアとなる数字がありません。","arBlkEdge.loute":"矢印がブロックの端にありません。","arBlocked.toichika2":"ペアとなる数字どうしの間に別の数字があります。","arBlockLt2.evolmino":"矢印が２つ以上のブロックを通っていません。","arDistance.toichika2":"数字の間のマス数が正しくありません。","arInvalid.evolmino":"矢印の形が不正です。",arNoLine:"線が通っていない矢印があります。","arNotMax.makaro":"矢印の先が最も大きい数字でありません。","arNotPtCnr.loute":"矢印の先にブロックの角がありません。","asLblockNe.triplace":"数字の下か右にあるまっすぐのブロックの数が間違っています。","asShadeNe.tilepaint":"数字の下か右にある黒マスの数が間違っています。",bankGt:"ブロックが現れる回数が異なります。",bankInvalid:"形の異なるブロックが入っています。",bankLt:"入っていないブロックがあります。","baParaGe3.juosan":"縦棒か横棒が3マス以上並んでいます。","baPlNum.tateyoko":"1つの棒に2つ以上の数字が入っています。","bdBranch.kramma":"線が分岐しています。","bdBranchExBP.bdblock":"黒点以外のところで線が分岐しています。","bdCountLt3BP.bdblock":"黒点から線が３本以上出ていません。",bdCross:"十字の交差点があります。","bdCrossBP.kramma":"黒点上で線が交差しています。","bdCrossExBP.bdblock":"黒点以外のところで線が交差しています。","bdCurveExBP.kramma":"黒点以外のところで線が曲がっています。",bdDeadEnd:"線が途切れています。","bdDoorsGt.oneroom":"２部屋の間にドアが２つ以上あります。","bdIgnoreBP.bdblock":"黒点上を線が通過していません。","bdIgnoreBP.kramma":"黒点上を線が通過していません。","bdNotChassis.shwolf":"外枠につながっていない線があります。","bdPassStar.tentaisho":"星を線が通過しています。","bdUnused.lohkous":"使われていない線があります。","bdUnused.tren":"余分な線があります。",bdVoxasBlack:"黒丸をはさんだ長方形の大きさまたは向きが同じです。",bdVoxasGray:"灰色の丸をはさんだ長方形が、大きさも向きも全く同じ、または全く違います。",bdVoxasWhite:"白丸をはさんだ長方形の大きさまたは向きが違います。","bdwGroundFloor.bdwalk":"線が1階よりも下を通っています。","bdwInvalidDown.bdwalk":"▲のエレベーターで降りています。","bdwInvalidUp.bdwalk":"▼のエレベーターで昇っています。","bdwMismatch.bdwalk":"エレベーターのマスを通らずに階を移動しています。","bdwSkipElevator.bdwalk":"エレベーターで階を移動していません。","bdwTopFloor.bdwalk":"線が最上階よりも上を通っています。","bkArafEqual.araf":"面積が数字と一致しています。","bkArafTooBig.araf":"面積が大きすぎるブロックがあります。","bkArafTooSmall.araf":"面積が小さすぎるブロックがあります。","bkBothMarksPassed.moonsun":"線が月と太陽を両方通っています。","bkClue.toichika2":"ヒントと異なる数字が入っています。","bkDifferentLetters.nikoji":"異なる文字のブロックが同じ形になっています。","bkDifferentOrientation.nikoji":"ブロックの向きが異なります。","bkDifferentPosition.nikoji":"文字の位置が異なります。","bkDifferentShape.dbchoco":"ブロック内で、白マスと灰色マスのカタマリの形が異なっています。","bkDifferentShape.kuroclone":"部屋内でユニットの形が異なっています。","bkDifferentShape.nikoji":"同じ文字のブロックの形が異なります。",bkDivide:"クルマのないマスが分断されています。","bkDoubleBn.yosenabe":"鍋に数字が２つ以上書いてあります。","bkDupNum.hakoiri":"1つのハコに同じ記号が複数入っています。","bkDupNum.hebi":"同じ数字が入っています。","bkDupNum.makaro":"1つの部屋に同じ数字が複数入っています。","bkDupNum.renban":"1つの部屋に同じ数字が複数入っています。","bkDupNum.ripple":"1つの部屋に同じ数字が複数入っています。","bkDupNum.roma":"1つの領域に2つ以上の同じ矢印が入っています。","bkDupNum.sukoro":"1つの部屋に同じ数字が複数入っています。","bkDupNum.sukororoom":"1つの部屋に同じ数字が複数入っています。","bkDupNum.view":"1つの部屋に同じ数字が複数入っています。",bkDupNum:"同じブロックに同じ数字が入っています。","bkHingeGt.hinge":"黒マスのカタマリが複数の太線をまたいでいます。","bkHingeLt.hinge":"黒マスのカタマリが太線をまたいでいません。","bkHingeMirror.hinge":"太線を軸とした線対称の図形になっていません。","bkHingeSplit.hinge":"黒マスのカタマリが太線を複数回またいでいます。","bkLenGt4.fillmat":"「幅１マス、長さ１～４マス」ではないタタミがあります。","bkLessThan2Num.araf":"1つしか数字を含まないブロックがあります。","bkLiarNe1.usoone":"部屋に含まれる嘘つきの数字が1つでありません。","bkLineGt.nagenawa":"数字のある部屋と線が通過するマスの数が違います。","bkLineLt.nagenawa":"数字のある部屋と線が通過するマスの数が違います。","bkLineNe.country":"数字のある国と線が通過するマスの数が違います。","bkMajorBarGt.juosan":"縦棒か横棒の多い方の数が部屋の数字より多いです。","bkMajorBarLt.juosan":"縦棒か横棒の多い方の数が部屋の数字より少ないです。","bkMixed.sukoro":"数字のあるなしが混在した部屋があります。","bkMixed.sukororoom":"数字のあるなしが混在した部屋があります。","bkMixed.view":"数字のあるなしが混在した部屋があります。",bkMixed:"白マスと黒マスの混在したタイルがあります。","bkMixedNum.fillomino":"1つのブロックに2種類以上の数字が入っています。","bkMoreThan2Num.araf":"3つ以上の数字を含むブロックがあります。","bkMSGe2.nondango":"1つの領域に複数のくろまるがあります。","bkMSPassedGt2.moonsun":"月を通った部屋が連続しています。","bkMUPassedGt2.moonsun":"太陽を通った部屋が連続しています。","bkNoChain.chainedb":"ブロックが他のブロックと斜めに繋がっていません。","bkNoColor.interbd":"どの色も含まれていない国があります。","bkNoLevel.aquarium":"同じブロック内で、水のマスの水位が等しくないブロックがあります。","bkNoLine.country":"線の通っていない国があります。","bkNoLine.icebarn":"すべてのアイスバーンを通っていません。","bkNoLine.moonsun":"線の通っていない部屋があります。","bkNoLine.onsen":"線の通っていない部屋があります。","bkNoLine.ovotovata":"線が灰色マスを通っていません。","bkNoLineNe.mejilink":"タイルと周囲の線が引かれない点線の長さが異なります。","bkNoMarksPassed.moonsun":"線が月も太陽も通っていません。","bkNoMatch.dotchi":"直進する◯と曲がる◯が同じ領域にあります。","bkNoMS.nondango":"くろまるのない領域があります。","bkNoNum.bonsan":"○のない部屋があります。","bkNoNum.fillmat":"数字の入っていないタタミがあります。","bkNoNum.hanare":"数字の入っていない部屋があります。","bkNoNum.kaero":"アルファベットのないブロックがあります。","bkNoNum.kramma":"白丸も黒丸も含まれない領域があります。","bkNoNum.nanro":"数字が含まれていないブロックがあります。","bkNoNum.nawabari":"数字の入っていない部屋があります。","bkNoNum.nikoji":"領域内に文字がありません。","bkNoNum.nurikabe":"数字の入っていないシマがあります。","bkNoNum.putteria":"数字の入っていない部屋があります。","bkNoNum.shikaku":"数字の入っていない領域があります。","bkNoNum.shwolf":"ヤギもオオカミもいない領域があります。","bkNoNum.tatamibari":"記号の入っていないタタミがあります。","bkNoNum.toichika":"国に矢印が入っていません。","bkNoNum.yosenabe":"具材のない鍋があります。",bkNoNum:"数字のないブロックがあります。","bkNoObj.kinkonkan":"斜線の引かれていない部屋があります。","bkNoSC.dosufuwa":"鉄球が入っていない領域があります。","bkNoShade.shimaguni":"黒マスのカタマリがない海域があります。",bkNoShade:"黒マスがない部屋があります。","bkNoStar.tentaisho":"星が含まれていない領域があります。","bkNotAllMSPassed.moonsun":"線が全ての月を通っていません。","bkNotAllMUPassed.moonsun":"線が全ての太陽を通っていません。","bkNotHRect.tatamibari":"横長ではないタタミがあります。","bkNotLshape.loute":"ブロックが幅1のL字型になっていません。","bkNotLshape3.shikaku":"大きさが3の倍数である領域がL字型になっていません。","bkNotPassTwice.doubleback":"線がちょうど２回通過していない部屋があります。","bkNotRect.scrin":"四角形ではない領域があります。","bkNotRect.shikaku":"四角形ではない領域があります。","bkNotRect.tatamibari":"タタミの形が長方形ではありません。","bkNotRect.voxas":"四角形ではない領域があります。",bkNotRect:"四角形ではない部屋があります。","bkNotRect3.shikaku":"大きさが3の倍数ではないのに四角形ではない領域があります。","bkNotSeqNum.renban":"数字が連番になっていない部屋があります。","bkNotSquare.tatamibari":"正方形でないタタミがあります。","bkNotSymmRoom.fillomino":"部屋の形が点対称ではありません。","bkNotSymRoom.ayeheya":"部屋の形が点対称ではありません。","bkNotSymShade.ayeheya":"部屋の中の黒マスが点対称に配置されていません。","bkNotSymSt.tentaisho":"領域が星を中心に点対称になっていません。","bkNotVRect.tatamibari":"縦長ではないタタミがあります。","bkNoUC.dosufuwa":"風船が入っていない領域があります。","bkNumGe2.compass":"２つ以上の記号マスを含むブロックがあります。","bkNumGe2.fillmat":"1つのタタミに2つ以上の数字が入っています。","bkNumGe2.hanare":"1つの部屋に2つ以上の数字が入っています。","bkNumGe2.lohkous":"２つ以上の記号マスを含むブロックがあります。","bkNumGe2.nawabari":"1つの部屋に2つ以上の数字が入っています。","bkNumGe2.nikoji":"領域内に複数の文字があります。","bkNumGe2.nurikabe":"1つのシマに2つ以上の数字が入っています。","bkNumGe2.putteria":"1つの部屋に2つ以上の数字が入っています。","bkNumGe2.scrin":"1つの領域に2つ以上の数字が入っています。","bkNumGe2.shikaku":"1つの領域に2つ以上の数字が入っています。","bkNumGe2.tatamibari":"1つのタタミに2つ以上の記号が入っています。","bkNumGe2.toichika":"1つの国に2つ以上の矢印が入っています。",bkNumGe2:"1つのブロックに2つ以上の数字が入っています。","bkNumGt3.hakoiri":"1つのハコに4つ以上の記号が入っています。","bkNumLt3.hakoiri":"1つのハコに2つ以下の記号しか入っていません。","bkNumUnshade.scrin":"長方形の中に含まれていない丸があります。","bkObjGe2.kinkonkan":"斜線が複数引かれた部屋があります。","bkObjNotSym.bonsan":"部屋の中の○が点対称に配置されていません。","bkOddSize.kazunori":"部屋のサイズが奇数になっています。","bkPassTwice.country":"線が１つの国を２回以上通っています。","bkPassTwice.moonsun":"線が１つの部屋を２回以上通っています。","bkPlColor.interbd":"色が複数含まれる領域があります。","bkPlNum.kaero":"１つのブロックに異なるアルファベットが入っています。","bkPlNum.kramma":"白丸と黒丸が両方含まれる領域があります。","bkPlNum.shwolf":"ヤギとオオカミが両方いる領域があります。",bkPlNum:"複数種類の数字が入っているブロックがあります。","bkPlStar.tentaisho":"星が複数含まれる領域があります。","bkPluralShade.parquet":"複数のタイルが黒く塗られている領域があります。","bkRect.cbblock":"ブロックが四角形になっています。","bkSameNumGt2.kazunori":"部屋に同じ数字が3つ以上入っています。","bkSameTouch.nawabari":"向きも形も同じブロックが接しています。","bkSCGe2.dosufuwa":"1つの領域に鉄球が複数入っています。","bkSepColor.interbd":"同じ色のマスが異なる領域にあります。","bkSepNum.kaero":"同じアルファベットが異なるブロックに入っています。",bkSepNum:"同じ数字が異なるブロックに入っています。","bkShadeDivide.shimaguni":"1つの海域に入る国が2つ以上に分裂しています。",bkShadeDivide:"1つの部屋に入る黒マスが2つ以上に分裂しています。",bkShadeGt2:"２マス以上の黒マスがある部屋が存在します。","bkShadeGt4.lits":"５マス以上の黒マスがある部屋が存在します。",bkShadeLt2:"１マスしか黒マスがない部屋があります。","bkShadeLt4.lits":"黒マスのカタマリが４マス未満の部屋があります。","bkShadeNe.chocona":"数字のある領域と、領域の中にある黒マスの数が違います。","bkShadeNe.shimaguni":"海域内の数字と国のマス数が一致していません。",bkShadeNe:"部屋の数字と黒マスの数が一致していません。","bkSize1.rectslider":"黒マスが一つで孤立しています。","bkSize1.yajitatami":"長さが１マスのタタミがあります。","bkSizeEq.fillmat":"数字とタタミの大きさが同じです。","bkSizeGt.dbchoco":"同じ色のマスのカタマリの大きさより数字が小さいです。","bkSizeGt.fillomino":"ブロックの大きさよりも数字が小さいです。",bkSizeGt2:"サイズが2マスより大きいブロックがあります。",bkSizeGt3:"サイズが3マスより大きいブロックがあります。",bkSizeGt4:"サイズが4マスより大きいブロックがあります。",bkSizeGt5:"サイズが5マスより大きいブロックがあります。","bkSizeLt.dbchoco":"同じ色のマスのカタマリの大きさより数字が大きいです。","bkSizeLt.fillomino":"ブロックの大きさより数字のほうが大きいです。",bkSizeLt2:"サイズが2マスより小さいブロックがあります。",bkSizeLt3:"サイズが3マスより小さいブロックがあります。",bkSizeLt4:"サイズが4マスより小さいブロックがあります。",bkSizeLt5:"サイズが5マスより小さいブロックがあります。","bkSizeNe.cbanana":"数字とシマの面積が違います。","bkSizeNe.fillmat":"数字とタタミの大きさが違います。","bkSizeNe.hanare":"数字と部屋の大きさが違います。","bkSizeNe.nurikabe":"数字とシマの面積が違います。","bkSizeNe.putteria":"数字と部屋の大きさが違います。","bkSizeNe.scrin":"数字と領域の大きさが違います。","bkSizeNe.shikaku":"数字と領域の大きさが違います。","bkSizeNe.tateyoko":"数字と棒の長さが違います。","bkSizeNe.tontti":"線が通らないマスの数がヒントと異なります。","bkSizeNe.yajitatami":"数字とタタミの大きさが違います。",bkSizeNe:"数字とブロックの大きさが違います。","bkSizeNe5.hebi":"大きさが５ではない蛇がいます。","bkSmallOnBig.ripple":"同じ部屋で上に小さい数字が乗っています。","bkStarGt.starbattle":"ブロックに入る星の数が多すぎます。","bkStarLt.starbattle":"ブロックに入る星の数が少ないです。","bkSubdivided.oneroom":"部屋が黒マスで分断されています。","bkSubGt2.cbblock":"ブロックが3つ以上の点線からなる領域で構成されています。","bkSubGt2.dbchoco":"同じ色のマスのカタマリが3個以上入っているブロックがあります。","bkSubLt2.cbblock":"ブロックが1つの点線からなる領域で構成されています。","bkSubLt2.dbchoco":"1色のマスしか入っていないブロックがあります。","bkSumNeBn.yosenabe":"具材の合計値が正しくありません。","bkUCGe2.dosufuwa":"1つの領域に風船が複数入っています。","bkUnitNe2.kuroclone":"ユニットの数が２つでない部屋があります。","bkUnknown.lohkous":"領域内に数字と異なる長さのセグメントがあります。","bkUnshade.lapaz":"1x1の領域が黒く塗られていません。",bkUnshadeConsecGt3:"白マスが２つ以上の太線を連続してまたいでいます。",bkWidthGt1:"幅が１マスではないタタミがあります。","bkWrongNum.armyants":"アリの数字がおかしいです。","blLineDiff.onsen":"各部屋で線が通過するマスの数が違います。","blLineLong.maxi":"枠内を連続して通るマス数が、数字よりも大きい線があります。","blLineNe.onsen":"線が通過するマスの数が数字と違います。","blLineShort.maxi":"枠内のどの線も、連続して通るマス数が数字よりも小さいです。","blNoHatena.ovotovata":"？の領域を出た線が異なる場所で曲がっています。","blNoNumber.ovotovata":"線が領域から出てから、正しいマス数だけ直進していません。","blPassTwice.onsen":"ある線が１つの部屋を２回以上通っています。","blPassTwice.rassi":"部屋の中に線が複数あります。","blWrongTurns.detour":"線の曲がった回数が数字と違っています。","bnIllegalPos.yosenabe":"鍋の外に数字が書いてあります。","brNoLine.kouchoku":"線が存在していません。",brNoLine:"線が引かれていません。",brNoShade:"盤面に黒マスがありません。","brNoStone.goishi":"盤面に碁石がありません。","brNoTriangle.shakashaka":"盤面に三角形がありません。",brNoValidNum:"盤面に数字がありません。","brObjNotSym.bonsan":"○が点対称に配置されていません。","bsAnt.armyants":"別々のアリが接しています。","bsArrowGt2.evolmino":"ブロックが２マス以上矢印に乗っています。","bsEqShade.shimaguni":"隣り合う海域にある国の大きさが同じです。","bsNoArrow.evolmino":"ブロックに矢印が通っていません。","bsNotEvol.evolmino":"１つ前のブロックに四角を１つ付け足してできる形になっていません。","bsSameNum.fillomino":"同じ数字のブロックが辺を共有しています。","bsSameShape.chainedb":"チェーンの中に、大きさも形も同じブロックが入っています。","bsSameShape.lits":"同じ形のテトロミノが接しています。",bsSameShape:"同じ形のブロックが接しています。","bsSizeEq.fillmat":"隣り合うタタミの大きさが同じです。","bsSnake.hebi":"別々の蛇が接しています。","cbDiffLenNe.renban":"数字の差がその間にある線の長さと等しくありません。","cbNoLine.country":"線が通らないマスが、太線をはさんでタテヨコにとなりあっています。","cbSameNum.nanro":"同じ数字が境界線を挟んで隣り合っています。","cbShade.shimaguni":"異なる海域にある国どうしが辺を共有しています。",cbShade:"異なる部屋にある黒マスどうしが辺を共有しています。",ceAddLine:"最初から引かれている線があるマスに線が足されています。","ceDark.lightup":"照明に照らされていないセルがあります。","ceDirection.compass":"数字の方向にあるブロック内のマス数が、数字と一致していないブロックがあります。","ceEmpty.shugaku":"布団でも黒マスでもないマスがあります。","ceEmpty.yajilin-regions":"黒マスも線も引かれていないマスがあります。","ceEmpty.yajilin":"黒マスも線も引かれていないマスがあります。","ceNoBar.juosan":"何も入っていないマスがあります。","ceNoBar.tateyoko":"何も入っていないマスがあります。","ceNoLine.arukone":"線が引かれていない交差点があります。",ceNoLine:"線が引かれていないマスがあります。","ceNoNum.compass":"記号マスを１つも含まないブロックがあります。","ceNoNum.kakuro":"すべてのマスに数字が入っていません。","ceNoNum.lohkous":"記号マスを１つも含まないブロックがあります。","ceNoNum.yinyang":"まるの入っていないマスがあります。",ceNoNum:"数字の入っていないマスがあります。","ceNoSlash.gokigen":"斜線がないマスがあります。","ceNumGtSize.armyants":"数字がアリの大きさよりも大きいです。","ceSuspend.sukoro":"数字の入っていないマスがあります。","ceSuspend.sukororoom":"数字の入っていないマスがあります。","ceSuspend.view":"数字の入っていないマスがあります。","ceTapaNe.tapa":"数字と周囲の黒マスの長さが異なっています。","ceTooManyBlocks.doppelblock":"3つ以上の黒マスがある行または列があります。","ciNotOnCnr.loute":"白丸がブロックの角にありません。","circleNotPromontory.kurodoko":"丸のマスが岬になっていません。",circleShade:"白丸が黒マスになっています。","circleUnshade.snake":"塗られていない丸があります。",circleUnshade:"黒丸が黒マスになっていません。","circNoLine.balance":"線が通っていない丸があります。","clueUnused.railpool":"数字が表す長さの線分がありません。",complete:"正解です！","crAdjacent.tajmahal":"数字が接している正方形の数と一致しません。","crConnSlNe.gokigen":"数字に繋がる線の数が間違っています。","crNoSegment.tajmahal":"正方形が配置されていません。","crShadeGt.creek":"数字のまわりにある黒マスの数が間違っています。","crShadeLt.creek":"数字のまわりにある黒マスの数が間違っています。","cs2x2.snake":"スネークが自分自身とタテヨコナナメに接しています。",cs2x2:"2x2の黒マスのカタマリがあります。","cs3.aqre":"黒マスが4マス連続しています。",csAdjacent:"黒マスがタテヨコに連続しています。","csConnOut.kurodoko":"盤面の外につながっていない黒マスがあります。","csConsecGt3.tawa":"黒マスが横に3マス以上続いています。","csCornerSize.nuribou":"同じ面積の黒マスのカタマリが、角を共有しています。","csdDivide.scrin":"長方形で出来た輪っかに含まれていない長方形があります。","csDivide.shugaku":"通路が分断されています。",csDivide:"黒マスが分断されています。","csDivide8.mochikoro":"孤立した白マスのブロックがあります。",csGt2:"２マスより大きい黒マスのカタマリがあります。","csLoop.parquet":"黒マスがループになっています。",csLt2:"１マスだけの黒マスのカタマリがあります。","csNoLevel.aquarium":"ひとつながりの水のマスの水位が等しくなっていません。","csNoSupport.aquarium":"水の入っているマスの隣や下のマスが空白になっています。","csNotBottom.dosufuwa":"鉄球の下の鉄球や黒マスがありません。","csNotOnShade.tawa":"黒マスの下に黒マスがありません。",csNotRect:"黒マスのカタマリが正方形か長方形ではありません。",csNotSquare:"正方形でない黒マスのカタマリがあります。","csRect.mochikoro":"四角形になっている黒マスのブロックがあります。","csUpper.stostone":"ブロックを落とした後に黒マスが盤面の上半分に残っています。","csWidthGt1.nuribou":"「幅１マス、長さ１マス以上」ではない黒マスのカタマリがあります。",cu2x2:"2x2の白マスのカタマリがあります。","cu3.aqre":"白マスが4マス連続しています。",cuConnOut:"盤面の辺に到達できない白マスがあります。",cuDivide:"白マスが分断されています。",cuDivideRB:"白マスが分断されています。",cuLoop:"白マスで輪っかができています。","cuLower.stostone":"ブロックを落とした後の空間が盤面の下半分にあります。","cuNoLine.icebarn":"通過していない白マスがあります。","cuNoLine.nagenawa":"白マスの上に線が引かれていません。","cuNotRect.mochikoro":"四角形でない白マスのブロックがあります。","cuNotRectx.shakashaka":"白マスが長方形(正方形)ではありません。",cuNotSquare:"白マスが正方形ではありません。","cuNotTop.dosufuwa":"風船の上に風船や黒マスがありません。","cuOutside.castle":"白マスがループの外にあります。",cuRect:"白マスのカタマリが正方形または長方形になっています。","cxAdjacent.crossstitch":"線が交差するマスが隣り合っています。","exNoMatch.nonogram":"黒マスの数が正しくありません。","exShadeNe.aquarium":"行または列内にある水のマスの数と外の数字が異なります。","exShadeNe.snake":"行または列内にあるスネークのマスの数と外の数字が異なります。","exTentNe.tents":"行または列にあるテントの数が正しくありません。","futonHalf.shugaku":"布団が2マスになっていません。","futonMidPos.shugaku":"通路に接していない布団があります。","gateRedup.slalom":"線が２回以上通過している旗門があります。","gateUnpass.slalom":"線が通過していない旗門があります。","goishiRemains.goishi":"拾われていない碁石があります。","haisuError.haisu":"線が領域に入った回数と数字が異なります。","haisuSG.haisu":"線がSまたはGを通りすぎています。",invalid:"不明なエラーです","kitamakura.shugaku":"北枕になっている布団があります。","laCurve.herugolf":"ボールが移動途中に曲がっています。",laCurve:"曲がっている線があります。","laIsolate.bonsan":"○につながっていない線があります。","laIsolate.herugolf":"ボールにつながっていない線があります。","laIsolate.rectslider":"黒マスにつながっていない線があります。","laIsolate.yosenabe":"具材につながっていない線があります。",laIsolate:"アルファベットにつながっていない線があります。","laLenNe.herugolf":"ボールが移動途中に止まっています。",laLenNe:"数字と線の長さが違います。",laLoop:"線がループになっています。","laMoveOver.herugolf":"ボールが指示された打数を超えて動いています。",laOnBorder:"線が境界線をまたいでいます。","laOnHole.herugolf":"ホールの上を線が通過しています。","laOnNum.armyants":"数字の上を線が通過しています。","laOnNum.bonsan":"○の上を線が通過しています。","laOnNum.herugolf":"ボールの上を線が通過しています。","laOnNum.rectslider":"黒マスの上を線が通過しています。","laOnNum.yosenabe":"具材の上を線が通過しています。",laOnNum:"アルファベットの上を線が通過しています。","laWaterHazard.herugolf":"ウォーターハザードになっています。","lbDivide.amibo":"棒が１つに繋がっていません。","lbIsolate.walllogic":"数字につながっていない線があります。","lbLenGt.amibo":"白丸から出る棒の長さが長いです。","lbLenLt.amibo":"白丸から出る棒の長さが短いです。","lbLoop.amibo":"棒で輪っかができています。","lbNotCrossEq.amibo":"同じ長さの棒と交差していません。","lcCurveGt1.ichimaga":"線が2回以上曲がっています。","lcCurveGt2.kusabi":"線が2回以上曲がっています。","lcCurveLt2.kusabi":"線が2回曲がっていません。","lcCurveNe.firefly":"線の曲がった回数が数字と違っています。",lcDeadEnd:"線が途中で途切れています。",lcDivided:"線が全体でひとつながりになっていません。","lcInvalid.kusabi":"繋がる丸が正しくありません。","lcInvBlack.wblink":"黒丸同士が繋がっています。","lcInvDirB.firefly":"黒点同士が線で繋がっています。","lcInvDirW.firefly":"白丸の、黒点でない部分どうしがくっついています。","lcInvWhite.wblink":"白丸同士が繋がっています。","lcIsolate.arukone":"アルファベットにつながっていない線があります。","lcIsolate.kusabi":"○につながっていない線があります。",lcIsolate:"数字につながっていない線があります。","lcLenInvDiff.kusabi":"線の長短の指示に反してます。","lcLenInvNe.kusabi":"線の長さが同じではありません。","lcNotKusabi.kusabi":"丸がコの字型に繋がっていません。","lcOnNum.arukone":"アルファベットの上を線が通過しています。","lcOnNum.kusabi":"○の上を線が通過しています。",lcOnNum:"数字の上を線が通過しています。","lcSameNum.ichimaga":"同じ数字同士が線で繋がっています。","lcTripleNum.arukone":"3つ以上のアルファベットがつながっています。","lcTripleNum.kusabi":"3つ以上の○が繋がっています。","lcTripleNum.wblink":"3つ以上の○が繋がっています。",lcTripleNum:"3つ以上の数字がつながっています。","lnAdjacent.tontti":"繋がっている線の形が同じです。",lnBranch:"分岐している線があります。","lnCross.crossstitch":"線が自己交差しています。",lnCross:"線が交差しています。","lnCrossExCir.pipelink":"○の部分以外で線が交差しています。",lnCrossExIce:"氷の部分以外で線が交差しています。",lnCrossExMk:"十字以外の場所で線が交差しています。","lnCrossOnNum.pipelink":"○の部分で線が交差しています。","lnCrossPencil.pencils":"線が鉛筆の軸と交差しています。","lnCurveOnCir.pipelink":"○の部分で線が曲がっています。",lnCurveOnIce:"氷の部分で線が曲がっています。",lnDeadEnd:"途中で途切れている線があります。","lnDeadEndAround.rassi":"線の端がたてよこななめに隣り合っています。","lnExTri.reflect":"線が三角形を通過していません。","lnIsolate.bdwalk":"線がすべての数字とエレベーターを通っていません。","lnIsolate.dotchi":"線の通っていない○があります。","lnIsolate.kouchoku":"線がマークのないところから出ています。","lnIsolate.onsen":"線の通っていない○があります。","lnIsolate.tajmahal":"正方形の中心に黒丸がありません。","lnLenGt.reflect":"三角形の数字とそこから延びる線の長さが一致していません。","lnLengthGt.pencils":"鉛筆から引かれた線が軸よりも長くなっているところがあります。","lnLengthLt.pencils":"鉛筆から引かれた線が軸よりも短くなっているところがあります。","lnLenLt.reflect":"三角形の数字とそこから延びる線の長さが一致していません。","lnMultipleTips.pencils":"2つ以上の芯に繋がっている線があります。",lnNotCrossMk:"十字の場所で線が交差していません。","lnNoTip.pencils":"芯に繋がっていない線があります。","lnNotRect.nagenawa":"長方形か正方形でない輪っかがあります。","lnNotSq.tajmahal":"線が正方形になっていません。","lnOnCenter.midloop":"線分の中点になっていない黒丸があります。","lnOnClue.tajmahal":"正方形の頂点が他の黒丸に接しています。","lnOnCorner.tajmahal":"頂点が線の途中で接しています。","lnOnDot.midloop":"ループが通過していない黒丸があります。","lnOnShade.dotchi":"線が●のマスを通っています。",lnOnShade:"黒マスの上に線が引かれています。","lnOverlap.kouchoku":"線が同一直線上で重なっています。","lnOverlap.tontti":"線がヒントマスを通っています。","lnPassOver.kouchoku":"線がマークを通過しています。",lnPlLine:"線がひとつながりではありません。","lnPlLoop.crossstitch":"ループが2つではありません。","lnPlLoop.tajmahal":"正方形がひとつながりになっていません。",lnPlLoop:"輪っかが一つではありません。","lnRightAngle.kouchoku":"線が直角に交差していません。","lnStarNe.starbattle":"1つの行に入る星の数が間違っています。","lnWrongAngle.kouchoku":"直線のなす角度がマークと違います。","lookairBC.lookair":"同じ大きさの黒マスのカタマリの間に他の黒マスのカタマリがありません。","lpNoNum.onsen":"○を含んでいないループがあります。","lpNoNum.pipelink":"○を含んでいないループがあります。","lpNumGt2.onsen":"数字が2つ以上含まれたループがあります。","lpPlNum.pipelink":"異なる数字を含んだループがあります。","lpSepNum.pipelink":"同じ数字が異なるループに含まれています。","lrAcrossArrow.nagare":"線が矢印を横切っています。","lrAcrossWind.nagare":"線が風で流されずに横切っています。","lrAgainstArrow.nagare":"線が矢印に反して進んでいます。","lrAgainstWind.nagare":"線が風上に向かって進んでいます。","lrDeadEnd.icebarn":"途中で途切れている線があります。","lrOffField.icebarn":"盤面の外に出てしまった線があります。","lrOrder.icebarn":"数字の通過順が間違っています。","lrOrder.slalom":"旗門を通過する順番が間違っています。","lrReverse.icebarn":"矢印を逆に通っています。","mashuBCvNbr.mashu":"黒丸の隣で線が曲がっています。","mashuBStrig.mashu":"黒丸の上で線が直進しています。","mashuOnLine.mashu":"線が上を通っていない丸があります。","mashuWCurve.mashu":"白丸の上で線が曲がっています。","mashuWStNbr.mashu":"白丸の隣で線が曲がっていません。","ms2x2.yinyang":"2x2のくろまるのカタマリがあります。","msConsecGt3.nondango":"くろまるが3つ以上連続しています。","msDivide.yinyang":"タテヨコにつながっていないくろまるがあります。","mu2x2.yinyang":"2x2のしろまるのカタマリがあります。","muConsecGt3.nondango":"しろまるが3つ以上連続しています。","muDivide.yinyang":"タテヨコにつながっていないしろまるがあります。","nm2x2.nanro":"数字が2x2のカタマリになっています。","nmAdjacent.hanare":"数字がタテヨコに連続しています。",nmAdjacent:"同じ数字がタテヨコに連続しています。","nmAkariNe.lightup":"数字のまわりにある照明の数が間違っています。","nmAround.hakoiri":"同じ記号がタテヨコナナメに隣接しています。","nmAround.kakuru":"同じ数字がタテヨコナナメに隣接しています。","nmAround.ripple":"同じ数字がタテヨコナナメに隣接しています。","nmBorderNe.nawabari":"数字の周りにある境界線の本数が違います。","nmCircleNe.crossstitch":"丸囲みの数字と、線が通る格子点の数が異なります。","nmConnBarWrong.tateyoko":"黒マスに繋がる線の数が正しくありません。","nmConnDiff.arukone":"異なるアルファベットがつながっています。","nmConnDiff.kouchoku":"異なる文字が直接繋がっています。","nmConnDiff.numlin":"異なる数字がつながっています。","nmConnected.bonsan":"○が繋がっています。","nmConnected.herugolf":"ボールが繋がっています。","nmConnected.rectslider":"黒マスが繋がっています。","nmConnected.yosenabe":"具材が繋がっています。",nmConnected:"アルファベットが繋がっています。","nmConnNoWall.walllogic":"数字に線が繋がっていません。","nmConnWallGt.walllogic":"数字に繋がる線が長いです。","nmConnWallLt.walllogic":"数字に繋がる線が短いです。","nmCountGt.nanro":"入っている数字の数が数字より多いです。","nmCountGt.simplegako":"同じ行と列にある同じ数字の個数がそのマスの数字より大きいです。","nmCountLt.nanro":"入っている数字の数が数字より少ないです。","nmCountLt.simplegako":"同じ行と列にある同じ数字の個数がそのマスの数字より小さいです。","nmDiffDistNe.hanare":"２つの数字の差とその間隔が正しくありません。","nmDiffDistNe.putteria":"２つの数字の差とその間隔が正しくありません。","nmDivEq2.kropki":"黒まるのない両側の数字が2倍になっています。","nmDivide.hakoiri":"タテヨコにつながっていない記号があります。",nmDivide:"タテヨコにつながっていない数字があります。","nmDivNe2.kropki":"黒まるの両側の数字が2倍ではありません。","nmDupRow.easyasabc":"同じ列に同じアルファベットが入っています。",nmDupRow:"同じ列に同じ数字が入っています。","nmDupRowCol.toichika2":"同じ数字が、同じ行にも同じ列にもあります。","nmHatenaNe.crossstitch":"丸囲みの？の周囲に、線が通っていません。","nmIgnored.herugolf":"ボールの入っていないホールがあります。","nmIneqNe.minarism":"不等号と数字が矛盾しています。","nmLineGt.hashikake":"数字につながる橋の数が違います。","nmLineGt1.amibo":"白丸に線が2本以上つながっています。","nmLineLt.hashikake":"数字につながる橋の数が違います。","nmLineLt2.kouchoku":"線が2本出ていない丸があります。","nmLineNe.ichimaga":"○から出る線の本数が正しくありません。","nmLineNe.slither":"数字の周りにある線の本数が違います。","nmLt1.lapaz":"数字が1x2のブロックに含まれていません。","nmMinesNe.mines":"タテヨコナナメに接する爆弾の数が数字と異なります。","nmMissing.lohkous":"領域内に数字と同じ長さのセグメントがありません。","nmMissRow.easyasabc":"列に入っていないアルファベットがあります。","nmMoveNe.tren":"数字がクルマの動けるマス数と異なります。","nmNoLine.amibo":"白丸に線がつながっていません。","nmNoLine.firefly":"ホタルから線が出ていません。","nmNoLine.ichimaga":"○から線が出ていません。","nmNoLine.kusabi":"どこにもつながっていない○があります。","nmNoLine.wblink":"○から線が出ていません。",nmNoLine:"どこにもつながっていない数字があります。","nmNoMove.bonsan":"○から線が出ていません。","nmNoMove.rectslider":"黒マスから線が出ていません。","nmNoSideShade.tasquare":"□に黒マスが接していません。","nmNotConsecNeighbors.ripple":"連続する数字がタテヨコに隣り合っていません。","nmNotConseq.kouchoku":"同じ文字がひとつながりになっていません。","nmNotLink.kazunori":"同じ数字が部屋の中でつながっていません。","nmNumberNe.sukoro":"数字と、その数字の上下左右に入る数字の数が一致していません。","nmNumberNe.sukororoom":"数字と、その数字の上下左右に入る数字の数が一致していません。","nmNumberNe.view":"数字と、その数字の上下左右に入る数字の数が一致していません。","nmOutOfBk.yosenabe":"鍋に入っていない具材があります。","nmOutOfHole.herugolf":"ホールに入っていないボールがあります。","nmOutsidePencil.pencils":"軸の中に入っていない数字があります。","nmOutsideTren.tren":"クルマに含まれていない数字があります。","nmPillowGt.shugaku":"柱のまわりにある枕の数が間違っています。","nmPillowLt.shugaku":"柱のまわりにある枕の数が間違っています。","nmProduct.factors":"ブロックの数字と数字の積が同じではありません。","nmSame2x2.kazunori":"同じ数字が2x2のカタマリになっています。","nmShade5Ne.lookair":"数字およびその上下左右にある黒マスの数が間違っています。","nmShadeGt.interbd":"タテヨコに接する黒マスの数が正しくありません。","nmShadeLt.interbd":"タテヨコに接する黒マスの数が正しくありません。","nmShadeNe.lapaz":"同じ行または同じ列にある黒マスの数が正しくありません。","nmShadeNe.paintarea":"数字の上下左右にある黒マスの数が間違っています。","nmShadeNe.tawa":"数字の周りに入っている黒マスの数が違います。","nmShadeViewNe.canal":"タテヨコに接する黒マスの個数の和が数字と異なります。",nmShapeNe:"ブロックの形と文字が一致しません。","nmShootShadeNe1.kurochute":"数字の数だけ離れたマスのうち、1マスだけ黒マスになっていません。","nmSightNe.easyasabc":"アルファベットが最も手前にありません。","nmSightNe.skyscrapers":"見えるビルの数が正しくありません。","nmSizeGt.pencils":"中の数字よりも短い軸があります。","nmSizeLt.pencils":"中の数字よりも長い軸があります。","nmSmallGap.ripple":"数字よりもその間隔が短いところがあります。","nmSubEq1.kropki":"白まるのない両側の数字の差が1になっています。","nmSubNe.minarism":"丸付き数字とその両側の数字の差が一致していません。","nmSubNe1.kropki":"白まるの両側の数字の差が1ではありません。","nmSum.doppelblock":"黒マスに挟まれた数字の和と、枠外の数字が一致していません。","nmSumNe.kazunori":"丸付き数字とその両側の数字の和が一致していません。","nmSumOfDiff.bosanowa":"数字とその隣の数字の差の合計が合っていません。","nmSumRowNe.kakuro":"数字の下か右にある数字の合計が間違っています。","nmSumRowShadeNe.box":"数字と黒マスになった数字の合計が正しくありません。","nmSumSizeNe.kurotto":"隣り合う黒マスの個数の合計が数字と違います。","nmSumSizeNe.tasquare":"数字とそれに接する黒マスの大きさの合計が一致しません。","nmSumViewNe.view":"数字と、他のマスにたどり着くまでのマスの数の合計が一致していません。",nmSumViewNe:"数字と黒マスにぶつかるまでの4方向のマスの合計が違います。","nmTentGt.tents":"木の数よりもテントの数が多い部分があります。","nmTentLt.tents":"木の数よりもテントの数が少ない部分があります。","nmTentNone.tents":"テントが隣り合っていない木があります。","nmTreeNone.tents":"木に接していないテントがあります。","nmTriangleGt.shakashaka":"数字のまわりにある黒い三角形の数が間違っています。","nmTriangleLt.shakashaka":"数字のまわりにある黒い三角形の数が間違っています。","nmTripRow.toichika2":"同じ行または同じ列に、同じ数字が３つ以上あります。","nmUnpass.icebarn":"通過していない数字があります。","nonCirclePromontory.kurodoko":"丸のないマスが岬になっています。","nqAroundDup.kakuru":"初めから出ている数字の周りに同じ数字が入っています。","nqAroundSumNe.kakuru":"初めから出ている数字の周りに入る数の合計が正しくありません。","numNoLine.geradeweg":"線の通っていない数字があります。","objShaded.nurimaze":"オブジェクトが黒マスになっています。","pairedLetterNe.kinkonkan":"光が同じ文字の場所へ到達しません。","pairedNumberNe.kinkonkan":"光の反射回数が正しくありません。","pcMultipleTips.pencils":"2つ以上の芯を持つ鉛筆があります。","ptInPencil.pencils":"芯が他の鉛筆の軸に入り込んでいます。","ptNoLine.pencils":"線が繋がっていない芯があります。","ptNoPencil.pencils":"幅が1の長方形の軸の先端に位置していない芯があります。","rmBranch.scrin":"３つ以上の頂点を共有している長方形があります。","rmDeadend.scrin":"頂点を１つしか共有していない長方形があります。","rmIsolated.scrin":"頂点を全く共有していない長方形があります。","rmRectUnshade.scrin":"輪の中に長方形が出来ています。","routeIgnoreCP.nurimaze":"○がSからGへの経路上にありません。","routePassDeadEnd.nurimaze":"△がSからGへの経路上にあります。","segBlackEq.balance":"黒丸から線の端までの長さが同じになっています。","segDiff.geradeweg":"？に当てはまる数字がありません。","segLong.balance":"線の長さの和が数字より大きいです。","segLong.geradeweg":"線の長さが数字より長いです。","segShort.balance":"線の長さの和が数字より小さいです。","segShort.geradeweg":"線の長さが数字より短いです。","segUnclued.railpool":"線分の長さが数字に一致しません。","segWhiteUneq.balance":"白丸から線の端までの長さが異なっています。","shBranch.snake":"スネークが分岐しています。","shDiag.snake":"スネークが自分自身とタテヨコナナメに接しています。","shEndpoint.snake":"頭または尾になっていない黒丸があります。","shIncorrect.curvedata":"記号の形に合っていない線があります。","shInside.castle":"黒マスがループの中にあります。","shLoop.snake":"頭または尾がありません。","shMidpoint.snake":"胴体になっていない白丸があります。","shMultiple.curvedata":"2つ以上の記号マスを通る線があります。","shNoDivide.interbd":"黒マスが2つ以上の国と接していません。","shNone.curvedata":"記号マスを通っていない線があります。","shSurrounded.interbd":"黒マスが2つ以上の国と接していません。","slLoop.gokigen":"斜線で輪っかができています。","slLoopGiri.gokigen":"'切'が含まれた線が輪っかになっています。","slNotLoopWa.gokigen":"'輪'が含まれた線が輪っかになっていません。","snakeAttack.hebi":"蛇の視線の先に別の蛇がいます。","starAround.starbattle":"星がタテヨコナナメに隣接しています。","stInvalid.icebarn":"スタート位置を特定できませんでした。","stLineNe2.slalom":"○から線が２本出ていません。","stNoLine.icebarn":"INに線が通っていません。","stopHalfway.roma":"ゴールにたどり着かないセルがあります。","tapaloopError.tapaloop":"線の長さと数字が一致していません。","tentAround.tents":"テント同士が接しています。","tooManyUnspecified.railpool":"線分の長さの種類が多すぎます。","tooFewUnspecified.railpool":"線分の長さの種類が少なすぎます。","unusedCell.pencils":"何も書かれていないマスがあります。","lcBalance.coffeemilk":"グループに含まれる白マルと黒マルの数が異なります。","lcInvalid.coffeemilk":"白マルと黒マルが直接線で結ばれています。","lcGrayGt.coffeemilk":"グループに2つ以上の灰マルがあります。","lnHasLoop.lither":"ループになっている部分があります。","lnNoBranchOrTerm.lither":"点が枝分かれする節点にも葉にもなっていません。","lnSnLine.lither":"木が１つしかありません。","nmLineNe.lither":"数字の周りにある線の本数が違います。","tapaloopError.disloop":"矢印の指すマスから先の線の長さが正しくありません。","csDistance.nothree":"連続した黒マスが等間隔に3つ以上並んでいます。","csGt1.nothree":"小さな丸が2マス以上の黒マスと接しています。","csLt1.nothree":"小さな丸が黒マスと接していません。","anLineLt.disloop":"矢印が指すマスから線が伸びていません。","bdPassStar.nuriuzu":"星と黒マスが重なっています。","nmBranch.snakepit":"スネークが枝分かれしています。","nmDiag.snakepit":"スネークが自分自身とナナメに接触しています。","nmEndpoint.snakepit":"丸のマスがスネークの頭か尾になっていません。","nmEqOne.snakepit":"1マスの領域があります。","nmLoop.snakepit":"スネークに端がありません。","nmMidpoint.snakepit":"灰色のマスがスネークの端になっています。","nmSame2x2.snakepit":"スネークが自分自身とタテヨコに接しています。",bkNotSquare:"領域が正方形ではありません。","anShadeNe.yajisoko":"箱の数が正しくありません。","bkSideNe.squarejam":"数字と領域の大きさが異なります。","laOnNum.yajisoko":"線が箱を通り過ぎています。","nmConnected.yajisoko":"箱どうしが線でつながっています。","nmNotSeq.numrope":"線上の数字が連続していません。","nmRange.kakuru":"数字が9より大きいです。","nmSubNe1.numrope":"隣り合う数字の差が1ではありません。","nmUnshadeAdjNe.context":"タテヨコに隣り合う黒マスの数が数字と異なります。","arDistanceGt.pentopia":"矢印のない方向に、近すぎる黒マスがあります。","arDistanceNe.pentopia":"矢印の指す方向の黒マスまでの距離が異なります。","arNoShade.pentopia":"矢印の指す方向に黒マスがありません。",csOnArrow:"矢印のあるマスが黒マスになっています。","nmShadeDiagNe.context":"ナナメに隣り合う黒マスの数が数字と異なります。","shDiag.pentopia":"黒マスのカタマリがナナメに接しています。","nmSightNe.roundtrip":"最も近い線の長さが正しくありません。","bdUnequal.antmill":"バツ印に隣接するマスのうち１つだけが黒マスになるようにします。","bdEqual.antmill":"正方形に隣接するマスが同色になっていません。","lnOnShade.yajisoko":"線が黒マスの上を通っています。","lnNoFish.anglers":"魚のいない線があります。","ceEmpty.kaidan":"空白のマスがあります。","lnNoNum.anglers":"数字のない線があります。","bkCircleNe.familyphoto":"数字と人数が一致していません。","bkMirror.mirrorbk":"鏡を軸に、ブロックが線対称になっていません。","csAdjacent.kaidan":"「〇」がタテヨコに連続しています。","csGt1.takoyaki":"両端を除く線上に丸が2つ以上あります。","cuEndpoint.takoyaki":"線の両端に丸がありません。","bkLadderNe.ladders":"数字とはしごの数が一致していません。","ceInvalidLadder.ladders":"異なる領域をつないでいないはしごがあります。","ceEmpty.lightshadow":"黒マスでも白マスでもないマスがあります。","ceNoEnd.kaidan":"長方形が完成していません。","cuDivide.kaidan":"長方形が辺を通してひとつながりになっていません。","bkSizeGt.icewalk":"数字が通っている白色のマスの数よりも少なくなっています。","bkSizeGt.lightshadow":"数字がブロックに含まれるマスの数よりも少なくなっています。","bkSizeGt2.lollipops":"キャンディどうしが隣り合っています。","bkSizeLt.icewalk":"数字が通っている白色のマスの数よりも多くなっています。","bkSizeLt.lightshadow":"数字がブロックに含まれるマスの数よりも多くなっています。","bkSizeLt2.lollipops":"キャンディが完成していません。","csLt1.takoyaki":"両端を除く線上に丸がありません。","baDir.lollipops":"｜か―の向きが違います。","lcOnNum.anglers":"線が魚を通り過ぎています。","nmShadeLt.kaidan":"数字のまわりにある丸の数が間違っています。","lnNoBorder.ladders":"はしごの両端が太線になっていません。","nmShadeGt.kaidan":"数字のまわりにある丸の数が間違っています。","lnAdjacent.ladders":"はしごどうしがつながっています。","lnConsecutive.kaidan":"隣り合う長方形の長さの差が1になっていません。","lnDivide.familyphoto":"隣り合った人が異なる写真に写っています。","lnLenGt.anglers":"線が長すぎます。","lnPlLoop.ladders":"すべての部屋がはしごでつながっていません。","nmDupRow.takoyaki":"同じ線に属する丸どうしが同じ列や行にあります。","nmDupRow.lollipops":"同じ記号のあいだに別の記号がありません。","cuRoomLt.akichi":"数字と等しいサイズの白マスのかたまりがありません。","cuRoomGt.akichi":"白マスのかたまりの面積が数字よりも大きくなっています。","lnEnds.kaidan":"幅1マスの辺どうしが隣り合っています。","laCurve.kaidan":"長方形どうしが重なっています。","lnOnShade.kaidan":"長方形と「〇」が重なっています。","lnLenLt.anglers":"線が短すぎます。","bdUnused.mirrorbk":"鏡に接する2マスが同じブロックに含まれています。","bkSizeGt.martini":"数字が白丸の個数より小さいです。","bkSizeLt.martini":"数字が白丸の個数より大きいです。","ceDirection.guidearrow":"矢印の方向に出発しても★にたどり着けません。","ceIntersect.nanameguri":"線がナナメの太線をまたいでいます。","lnIsolate.icewalk":"線が数字を通っていません。","bdUnusedCircle.wafusuma":"丸がある辺に線が引かれていません。","bkNumGe3.news":"領域内に文字が3つ以上あります。","bkNumLt2.news":"領域内に文字が1つしかありません。",bkOverNum:"領域に含まれる数字の数が多すぎます。","bdUnused.fillomino":"線が余分になっています。",lnCurveOnNum:"線が駅のマスで曲がっています。","lnIsolate.anglers":"線が魚のマスを通っていません。","lnIsolate.nanameguri":"線がナナメの太線があるマスを通っていません。","laIsolate.oyakodori":"余分な線があります。","laOnNum.oyakodori":"線が鳥を通り過ぎています。","laUnshadeNoBorder.oyakodori":"親鳥が仕切りをまたいでいません。","nmGt2.oyakodori":"巣に鳥が3匹以上います。","nmLt2.oyakodori":"巣に鳥が1匹しかいません。","nmNotConseqFull.trainstations":"数字から次の数字へと線が通っていません。","nmOutOfBk.oyakodori":"鳥が巣にいません。","nmNoLine.coffeemilk":"白マルまたは黒マルが、線で結ばれていません。","nmRange.trainstations":"数字が1から順になっていません。","nmSizeNe.tontonbeya":"部屋の中で、各記号の個数が同じではありません。","arNotRelative.news":"文字の位置関係が正しくありません。",blRemLength:"数字が、次の領域内を連続して通過するマス数と異なっています。","nmSumNe.wafusuma":"数字が、丸に接する2部屋のマス数の合計になっていません。","nmNotConseq.trainstations":"数字の順番通りに線が通っていません。","laOnIce.oyakodori":"線が巣を通り過ぎています。","laShadeOnBorder.oyakodori":"雛鳥が仕切りをまたいでいます。","nmAdjacentLt2.tontonbeya":"1つの部屋内にしかつながらないカタマリがあります。","nmConnected.oyakodori":"鳥どうしがつながっています。","nmAdjacentGt2.tontonbeya":"同じ記号のカタマリであって、2つ以上のカタマリとつながっているものがあります。","nmDivide.tontonbeya":"同じ記号が部屋の中でタテヨコにひとつながりになっていません。","nmNumberEq.oyakodori":"同じ種類の鳥が同じ巣に入っています。","bkShadeDivide.invlitso":"白マスが領域内でタテヨコに連なっていません。","bkShadeGt4.invlitso":"領域に白マスが４つ以下しかありません。","bkShadeLt4.invlitso":"領域に白マスが５つ以上あります。","nmVertexNe.vslither":"ループが通る頂点の数が正しくありません。",csLt4:"黒マスの数が４より少ないです。",csGt4:"黒マスの数が４より多いです。","exPlusNe.magnets":"列に入る「＋」の数が正しくありません。","exMinusNe.magnets":"列に入る「－」の数が正しくありません。","nmAdjacent.magnets":"同じ極が隣り合っています。","nmCircleNe.brownies":"数字が、タテヨコナナメに接する○の数と一致していません。","bankGt.battleship":"艦の数が多すぎます。","bankLt.battleship":"配置されていない艦があります。","bkCircleNe.fracdiv":"数字が、ブロック内の(黒丸の数)÷(マスの数)と一致していません。","bkNumLt2.magnets":"磁石が一方の極しかありません。","nmAdjDiff.magnets":"磁石が同じ極で隣り合っていません。","nmTouchNe.tslither":"マスの周りの頂点や辺にループが訪れる回数が正しくありません。","shDiag.battleship":"異なる艦がナナメに接しています。",bkMissingNum:"ブロックにすべての数字が入っていません。","bkNumGt2.sashikazune":"１つのブロックに数字が３個以上入っています。","exShadeNe.battleship":"列に入る艦の数が正しくありません。","bkPinNe.heyapin":"部屋にあるピンの数が正しくありません。","bkNumGt2.magnets":"領域の中に同じ極が2つ以上入っています。","nmDistNe.sashikazune":"数字が、角からのマス数と一致していません。","cxOverlap.heyapin":"ピンが複数の部屋にまたがっていません。","bkSizeGt2.waterwalk":"ループが水のマスを3マス以上連続して通過しています。","bkSizeGt.aquapelago":"数字とカタマリのマス数が異なります。","bkSizeLt.aquapelago":"数字とカタマリのマス数が異なります。","nmMixed.aquapelago":"カタマリが異なる数字を含んでいます。","ceUnused.kinkonkan":"光の当たらない鏡があります。","nmLineGt.wittgen":"長方形の置かれるマスの数が正しくありません。","cuDivide.wittgen":"机の置かれていないマスが分断されています。","cbNoLine.nothing":"全く線が通らないブロック同士が辺で接しています。","nmLineLt.wittgen":"長方形の置かれるマスの数が正しくありません。","ceOverlap.tachibk":"左右の盤面の同じ位置に当たるマスが、同じマス数のブロックになっています。","bkLineNe.nothing":"ブロックの一部のマスにしか線が通っていません。","lnLengthNe3.wittgen":"長方形が3マスではありません。","ceDirection.mukkonn":"線の長さが数字と異なっています。","bsEqShade.mannequin":"黒マスどうしの距離が隣り合う領域で一致しています。","bkShadeDistNe.mannequin":"黒マスどうしの距離が数字と異なります。",cbUnshade:"太線をまたいで黒マスが隣り合っています。"}},p.env=(e=p.Candle.env.browser,m=e?navigator.userAgent:"",i=-1<m.indexOf("like Mac OS X"),t=-1<m.indexOf("Android"),i={iOS:i,Android:t,mobile:i||t},t=m.match(/Firefox\/(\w+(\.\w+)?)/)?(t=RegExp.$1,m.match(/rv\:(\d+(\.\d+)?)/)&&RegExp.$1+0<=2.1?RegExp.$1+0:t):null,m=null===(l=m.match(/Safari\/([\w\.]+)/)&&m.match(/Chrome\/(\w+(\.\w+)?)/)?RegExp.$1:null)&&m.match(/Safari\/([\w\.]+)/)&&m.match(/Version\/(\w+(\.\w+)?)/)?RegExp.$1:null,{bz:{AndroidBrowser:i.Android&&m,Presto:"object"==typeof window&&!!window.opera},OS:i,API:{touchevent:e&&(!!window.ontouchstart||!!document.createTouch),pointerevent:e&&!!window.PointerEvent,mspointerevent:e&&!!window.MSPointerEvent,lowaccuracy:e&&window.matchMedia&&!!window.matchMedia("(pointer: coarse)").matches,maxWidth:e&&18<=(l||1e3)&&6<=(m||1e3),svgTextLength:!e||25<=(t||1e3),anchor_download:e&&void 0!==document.createElement("a").download},browser:e,node:p.Candle.env.node}),p.lang=(i=p.env.node?process.env.LANG:navigator.browserLanguage||navigator.language||navigator.userLanguage)&&"ja"!==i.substr(0,2)?"en":"ja",n=!0,s=[],p.on=function(e,t){"load"===e&&(n?s.push(t):t())},p.env.browser&&("complete"===document.readyState?setTimeout(k,10):(document.addEventListener("DOMContentLoaded",k,!1),window.addEventListener("load",k,!1))),o=null,p.on("load",function(){p.util.addEvent(document,"keydown",p,v),p.util.addEvent(document,"keyup",p,y)}),p.connectKeyEvents=function(e){o=e},p.common={},p.custom={"":{}},p.classmgr={makeCommon:function(e){this.createCommon(e)},createCommon:function(e){for(var t in e){var i=this.searchName(t),n=p.common[i.real];n||((n=this.createClass(p.common[i.base])).prototype.common=n.prototype,n.prototype.pid=""),this.extendPrototype(n.prototype,e[t]),p.common[i.real]=p.custom[""][i.real]=n}},makeCustom:function(e,t){for(var i=0;i<e.length;i++){var n=e[i];p.custom[n]=this.createCustom(n,t,e[0])}},getExtension:function(e,t){var i,n={};for(i in t){var s,o,r=t[i],a=i,h=!1;if((a=i.match("#")?i.substr(0,i.indexOf("#")):i).match("@")){s=a.substr(a.indexOf("@")+1).split(/,/),a=a.substr(0,a.indexOf("@"));for(var l=0;l<s.length;l++)if(s[l]===e){h=!0;break}if(!h)continue}for(o in n[a]||(n[a]={}),r)n[a][o]=r[o]}return n},createCustom:function(e,t,i){var n,s,o={},r=this.getExtension(e,t);for(n in r){var a=this.searchName(n),h=o[a.real];h||((h=this.createClass(o[a.base]||p.common[a.base])).prototype.pid=e,h.prototype.pidbase=i),this.extendPrototype(h.prototype,r[n]),o[a.real]=h}for(s in p.common)o[s]||(o[s]=this.createClass(p.common[s]),o[s].prototype.pid=e,o[s].prototype.pidbase=i);return o},searchName:function(e){var t=(e=e.replace(/\s+/g,"")).indexOf(":"),i="",n=e;return 0<=t&&(i=e.substr(t+1),n=e.substr(0,t)),{base:i||n,real:n}},createClass:function(e){function t(){}return e&&this.extendPrototype(t.prototype,e.prototype),t},extendPrototype:function(e,t){for(var i in t=t||{})null!==t[i]&&"object"==typeof t[i]&&t[i].constructor===Object?(e[i]||(e[i]={}),this.extendPrototype(e[i],t[i])):e[i]=t[i]},includeCustomFile:function(e){var t,e=p.variety(e).script;this.includedFile[e]||(this.includedFile[e]=!0,e=p.util.getpath()+"./pzpr-variety/"+e+".js",p.env.browser&&!p.env.node?((t=document.createElement("script")).type="text/javascript",t.src=e+"?"+p.version,document.getElementsByTagName("head")[0].appendChild(t)):(t=require(e),this.makeCustom(t[0],t[1])))},includedFile:{},setPuzzleClass:function(e,t,i){if(!p.variety(t).valid)throw e.emit("fail-open"),Error("Invalid Puzzle Variety Selected");if(e.pid!==t){if(!p.custom[t]&&(this.includeCustomFile(t),!p.custom[t]))return void setTimeout(function(){p.classmgr.setPuzzleClass(e,t,i)},10);this.setClasses(e,t)}i()},setClasses:function(e,t){e.klass={};var i,n=p.custom[t];for(i in n){var s,o=e.klass[i]=function(){var e=Array.prototype.slice.apply(arguments);this.initialize&&this.initialize.apply(this,e)},r=n[i].prototype;for(s in r)o.prototype[s]=r[s]}this.setPrototypeRef(e,"puzzle",e),this.setPrototypeRef(e,"klass",e.klass),e.pid=t,e.info=p.variety(t)},setPrototypeRef:function(e,t,i){for(var n in e.klass)e.klass[n].prototype[t]=i}};var w={},x=[];function N(e){if(w[e])return e;for(var t in w)if(w[t].alias)for(var i in w[t].alias)if(w[t].alias[i]===e)return t;return""}function C(e,t){this.valid=!0,this.pid=e,this.script=t[4]||e,this.ja=t[2],this.en=t[3],this.exists={pzprapp:!!t[0],kanpen:!!t[1],pencilbox:!!t[1]},this.exists.pencilbox=this.exists.pencilbox&&"nanro"!==e&&"ayeheya"!==e&&"kurochute"!==e,this.alias=t[5]||{},this.urlid=this.alias.pzprurl||e,this.kanpenid=t[1]?this.alias.kanpen||e:"",x.push(e)}var A,L=p.variety=p.genre=function(e){return w[N(e)]||{valid:!1}},S=(L.extend=function(e){for(var t in e)this[t]=e[t]},L.extend({info:w,toPID:N,exists:function(e){return L(e).valid},each:function(e){for(var t in w)e(t)},getList:function(){return x.slice()}}),delete L.extend,{aho:[0,0,"アホになり切れ","Aho-ni-Narikire","shikaku"],akichi:[0,0,"Akichiwake","Akichiwake","heyawake"],alter:[0,0,"オルタネーション","Alternation","hakoiri"],amibo:[0,0,"あみぼー","Amibo","amibo"],angleloop:[0,0,"鋭直鈍ループ","Angle Loop","kouchoku"],anglers:[0,0,"フィッシング","Anglers"],antmill:[0,0,"Ant Mill","Ant Mill","scrin"],aqre:[0,0,"Aqre","Aqre","aqre"],aquapelago:[0,0,"Aquapelago","Aquapelago"],aquarium:[0,0,"アクアプレース","Aquarium","aquarium"],araf:[0,0,"相ダ部屋","Araf","araf"],armyants:[0,0,"ぐんたいあり","Army Ants","kaero"],arukone:[0,0,"アルコネ","Arukone","numlin"],ayeheya:[0,1,"∀人∃ＨＥＹＡ","Ayeheya","heyawake"],balance:[0,0,"Balance Loop","Balance Loop"],cave:[1,0,"バッグ","Cave","kurodoko",{alias:"bag"}],cbanana:[0,0,"チョコバナナ","Choco Banana"],circlesquare:[0,0,"Circles and Squares","Circles and Squares"],context:[0,0,"Context","Context"],crossstitch:[0,0,"Crossstitch","Crossstitch"],cts:[0,0,"Cross the Streams","Cross the Streams","nonogram"],barns:[1,0,"バーンズ","Barns"],battleship:[0,0,"Battleship","Battleship","statuepark"],bdblock:[1,0,"ボーダーブロック","Border Block"],bdwalk:[0,0,"ビルウォーク","Building Walk","haisu"],bonsan:[1,0,"ぼんさん","Bonsan","bonsan"],bosanowa:[1,0,"ボサノワ","Bosanowa","",{alias:"bossanova"}],box:[0,0,"ボックス","Box"],brownies:[0,0,"ブラウニー","Brownies","yosenabe"],skyscrapers:[0,0,"ビルディングパズル","Skyscrapers","",{alias:"building",alias2:"skyscraper"}],canal:[0,0,"Canal View","Canal View","nurikabe"],castle:[0,0,"Castle Wall","Castle Wall"],cbblock:[0,0,"コンビブロック","Combi Block"],chainedb:[0,0,"チェンブロ","Chained Block"],chocona:[0,0,"チョコナ","Chocona","shimaguni"],cocktail:[0,0,"カクテルランプ","Cocktail Lamp","shimaguni"],coffeemilk:[0,0,"コーヒー牛乳","Coffee Milk","wblink"],cojun:[0,0,"コージュン","Cojun","ripple"],compass:[0,0,"Compass","Compass","compass"],coral:[0,0,"Coral","Coral","nonogram"],country:[1,0,"カントリーロード","Country Road"],creek:[1,0,"クリーク","Creek"],curvedata:[0,0,"カーブデータ","Curve Data"],"curvedata-aux":[0,0,"図形の編集","Edit shape"],dbchoco:[0,0,"ダブルチョコ","Double Choco","cbblock"],detour:[0,0,"Detour","Detour","country"],disloop:[0,0,"Disorderly Loop","Disorderly Loop","tapaloop"],dominion:[0,0,"ドミニオン","Dominion"],doppelblock:[0,0,"Doppelblock","Doppelblock","doppelblock"],dosufuwa:[0,0,"ドッスンフワリ","Dosun-Fuwari"],dotchi:[0,0,"ドッチループ","Dotchi-Loop","country"],doubleback:[0,0,"Double Back","Double Back","country"],easyasabc:[0,0,"ABCプレース","Easy as ABC"],evolmino:[0,0,"シンカミノ","Evolmino"],factors:[0,0,"因子の部屋","Rooms of Factors"],familyphoto:[0,0,"家族写真","Family Photo"],fillmat:[1,0,"フィルマット","Fillmat","fillmat"],fillomino:[0,1,"フィルオミノ","Fillomino","",{kanpen2:"fillomino01"}],firefly:[1,0,"ホタルビーム","Hotaru Beam"],fivecells:[0,0,"ファイブセルズ","FiveCells","nawabari"],fourcells:[0,0,"フォーセルズ","FourCells","nawabari"],fracdiv:[0,0,"分数分割","Fractional Division"],genderwalk:[0,0,"ジェンダーウォーク","Gender Walk","icewalk"],geradeweg:[0,0,"グラーデヴェグ","Geradeweg"],goishi:[0,1,"碁石ひろい","Goishi"],gokigen:[1,0,"ごきげんななめ","Slant","gokigen"],guidearrow:[0,0,"ガイドアロー","Guide Arrow"],haisu:[0,0,"Haisu","Haisu"],hakoiri:[1,0,"はこいり○△□","Hakoiri-masashi"],hanare:[0,0,"はなれ組","Hanare-gumi","hanare"],hashikake:[0,1,"橋をかけろ","Hashiwokakero","",{pzprurl:"hashi",kanpen:"hashi",alias:"bridges"}],hebi:[1,0,"へびいちご","Hebi-Ichigo","",{old:"snakes"}],herugolf:[0,0,"ヘルゴルフ","Herugolf"],heteromino:[0,0,"ヘテロミノ","Heteromino","nawabari"],heyablock:[0,0,"へやブロ","Heyablock","shimaguni"],heyabon:[1,0,"へやぼん","Heya-Bon","bonsan"],heyapin:[0,0,"へやピン","Heyapin"],heyawake:[0,1,"へやわけ","Heyawake","heyawake",{alias:"heyawacky"}],hinge:[0,0,"ちょうつがい","Hinge","shimaguni"],hitori:[0,1,"ひとりにしてくれ","Hitori"],icebarn:[1,0,"アイスバーン","Icebarn","icebarn"],icelom:[0,0,"アイスローム","Icelom","icebarn"],icelom2:[0,0,"アイスローム２","Icelom 2","icebarn"],icewalk:[0,0,"アイスウォーク","Ice Walk"],ichimaga:[0,0,"イチマガ","Ichimaga","ichimaga"],ichimagam:[0,0,"磁石イチマガ","Magnetic Ichimaga","ichimaga"],ichimagax:[0,0,"一回曲がって交差もするの","Crossing Ichimaga","ichimaga"],interbd:[0,0,"International Borders","International Borders"],invlitso:[0,0,"Inverse LITSO","Inverse LITSO","lits"],juosan:[0,0,"縦横さん","Juosan"],kaero:[1,0,"お家に帰ろう","Return Home"],kaidan:[0,0,"かいだんしばり","Stairwell"],kaisu:[0,0,"Kaisu","Kaisu","haisu"],kakuro:[0,1,"カックロ","Kakuro"],kakuru:[0,0,"カックル","Kakuru"],kazunori:[0,0,"かずのりのへや","Kazunori Room"],kinkonkan:[1,0,"キンコンカン","Kin-Kon-Kan"],kissing:[0,0,"Kissing Polyominoes","Kissing Polyominoes","statuepark"],koburin:[0,0,"コブリン","Koburin","yajilin"],kouchoku:[0,0,"交差は直角に限る","Kouchoku"],kramma:[0,0,"快刀乱麻","KaitoRamma","kramma"],kramman:[0,0,"新・快刀乱麻","New KaitoRamma","kramma"],kropki:[0,0,"Kropki","Kropki","minarism"],kurochute:[0,1,"クロシュート","Kurochute"],kuroclone:[0,0,"クロクローン","Kuroclone"],kurodoko:[0,1,"黒どこ(黒マスはどこだ)","Kurodoko"],kurotto:[0,0,"クロット","Kurotto"],kusabi:[0,0,"クサビリンク","Kusabi"],ladders:[0,0,"はしごをかけろ","Ladders"],lapaz:[0,0,"La Paz","La Paz"],lightshadow:[0,0,"Light and Shadow","Light and Shadow"],lightup:[0,1,"美術館","Akari","",{pzprurl:"akari",kanpen:"bijutsukan"}],lineofsight:[0,0,"サイトライン","Line of Sight"],lither:[0,0,"Litherslink","Litherslink"],lits:[1,1,"ＬＩＴＳ","LITS","lits"],lixloop:[0,0,"LIX Loop","LIX Loop","yajilin"],lohkous:[0,0,"Lohkous","Lohkous"],lollipops:[0,0,"ペロペロキャンディ","Lollipops"],lookair:[0,0,"るっくえあ","Look-Air"],loopsp:[1,0,"環状線スペシャル","Loop Special","pipelink"],loute:[0,0,"エルート","L-route"],magnets:[0,0,"Magnets","Magnets"],makaro:[0,0,"マカロ","Makaro"],mannequin:[0,0,"マネキンゲート","Mannequin Gate"],martini:[0,0,"マティーニ","Martini","shimaguni"],mashu:[0,1,"ましゅ","Masyu","",{kanpen:"masyu",alias:"pearl"}],maxi:[0,0,"Maxi Loop","Maxi Loop","country"],meander:[0,0,"にょろにょろナンバー","Meandering Numbers","ripple"],mejilink:[0,0,"メジリンク","Mejilink"],minarism:[1,0,"マイナリズム","Minarism"],mines:[0,0,"マインスイーパ","Minesweeper","kurotto"],midloop:[0,0,"ミッドループ","Mid-loop"],mirrorbk:[0,0,"ミラーブロック","Mirror Block","cbblock"],mochikoro:[1,0,"モチコロ","Mochikoro","nurikabe"],mochinyoro:[1,0,"モチにょろ","Mochinyoro","nurikabe"],moonsun:[0,0,"月か太陽","Moon or Sun","country"],mrtile:[0,0,"ミラーリングタイル","Mirroring Tile","chainedb"],mukkonn:[0,0,"Mukkonn Enn","Mukkonn Enn","compass"],myopia:[0,0,"Myopia","Myopia"],nagare:[0,0,"流れるループ","Nagareru-Loop"],nagenawa:[0,0,"なげなわ","Nagenawa","nagenawa"],nanameguri:[0,0,"ななめぐり","Nanameguri"],nanro:[0,1,"ナンロー","Nanro"],nawabari:[1,0,"なわばり","Nawabari","nawabari"],news:[0,0,"NEWS","NEWS","toichika"],nikoji:[0,0,"NIKOJI","NIKOJI","cbblock"],nondango:[0,0,"ノンダンゴ","Nondango"],nonogram:[0,0,"ののぐらむ","Nonogram"],norinori:[0,1,"のりのり","Norinori","lits"],norinuri:[0,0,"海苔ぬり","Norinuri","nurikabe"],nothing:[0,0,"オールｏｒナッシング","All or Nothing","country"],nothree:[0,0,"ノースリー","No Three"],numlin:[0,1,"ナンバーリンク","Numberlink","",{kanpen:"numberlink"}],numrope:[0,0,"ナンバーロープ","Number Rope","kakuru"],nuribou:[1,0,"ぬりぼう","Nuribou","nurikabe"],nurikabe:[0,1,"ぬりかべ","Nurikabe","nurikabe"],nurimaze:[0,0,"ぬりめいず","Nuri-Maze","nurimaze"],nurimisaki:[0,0,"ぬりみさき","Nurimisaki","kurodoko"],nuriuzu:[0,0,"ぬりうず","Nuri-uzu","tentaisho"],ovotovata:[0,0,"Ovotovata","Ovotovata","country"],oneroom:[0,0,"ワンルームワンドア","One Room One Door","heyawake"],onsen:[0,0,"温泉めぐり","Onsen-meguri","country"],oyakodori:[0,0,"おやこどり","Oyakodori","kaero"],paintarea:[1,0,"ペイントエリア","Paintarea"],parquet:[0,0,"Parquet","Parquet"],patchwork:[0,0,"パッチワーク","Patchwork"],pencils:[0,0,"ペンシルズ","Pencils"],pentatouch:[0,0,"Penta Touch","Penta Touch","statuepark"],pentominous:[0,0,"Pentominous","Pentominous","fillomino"],pentopia:[0,0,"Pentopia","Pentopia","statuepark"],pipelink:[1,0,"パイプリンク","Pipelink","pipelink"],pipelinkr:[1,0,"帰ってきたパイプリンク","Pipelink Returns","pipelink"],pmemory:[0,0,"Persistence of Memory","Persistence of Memory"],portal:[0,0,"Portal Loop","Portal Loop"],putteria:[0,0,"プッテリア","Putteria","hanare"],ququ:[0,0,"区区","Ququ"],railpool:[0,0,"Rail Pool","Rail Pool"],rassi:[0,0,"Rassi Silai","Rassi Silai","country"],rectslider:[0,0,"四角スライダー","Rectangle-Slider","bonsan"],reflect:[1,0,"リフレクトリンク","Reflect Link"],remlen:[0,0,"Remembered Length","Remembered Length","country"],renban:[0,0,"連番窓口","Renban-Madoguchi"],retroships:[0,0,"Retrograde Battleships","Retrograde Battleships","statuepark"],ringring:[0,0,"リングリング","Ring-ring","nagenawa"],ripple:[0,1,"波及効果","Ripple Effect","ripple",{kanpen:"hakyukoka"}],roma:[0,0,"ろーま","Roma","",{alias:"rome"}],roundtrip:[0,0,"Round Trip","Round Trip"],sashigane:[0,0,"さしがね","Sashigane","loute"],sashikazune:[0,0,"さしカズね","Sashikazune","loute"],satogaeri:[0,1,"さとがえり","Satogaeri","bonsan",{alias:"sato",kanpen:"satogaeri"}],scrin:[0,0,"スクリン","Scrin"],shakashaka:[0,1,"シャカシャカ","Shakashaka"],shikaku:[0,1,"四角に切れ","Shikaku","shikaku"],shimaguni:[1,0,"島国","Islands","shimaguni"],shugaku:[1,0,"修学旅行の夜","School Trip"],shwolf:[0,0,"ヤギとオオカミ","Goats and Wolves","kramma"],simplegako:[0,0,"シンプルガコ","Simple Gako"],simpleloop:[0,0,"Simple Loop","Simple Loop","country"],slalom:[1,1,"スラローム","Slalom","",{alias:"suraromu"}],slashpack:[0,0,"Slash Pack","Slash Pack"],slither:[0,1,"スリザーリンク","Slitherlink","",{kanpen:"slitherlink"}],snake:[0,0,"Snake","Snake"],snakepit:[0,0,"Snake Pit","Snake Pit","fillomino"],starbattle:[0,0,"スターバトル","Star Battle"],squarejam:[0,0,"Square Jam","Square Jam"],statuepark:[0,0,"Statue Park","Statue Park"],"statuepark-aux":[0,0,"図形の編集","Edit shape"],stostone:[0,0,"ストストーン","Stostone","shimaguni"],subomino:[0,0,"Subomino","Subomino","nawabari"],sudoku:[0,1,"数独","Sudoku"],sukoro:[1,0,"数コロ","Sukoro","sukoro"],sukororoom:[0,0,"数コロ部屋","Sukoro-room","sukoro"],symmarea:[0,0,"シンメトリーエリア","Symmetry Area","fillomino"],tachibk:[0,0,"たちあわせブロック","Tachiawase Block"],tajmahal:[0,0,"タージ・マハル","Taj Mahal","kouchoku"],takoyaki:[0,0,"たこ焼き","Takoyaki","kaidan"],tapa:[0,0,"Tapa","Tapa"],tapaloop:[0,0,"Tapa-Like Loop","Tapa-Like Loop"],tasquare:[0,0,"たすくえあ","Tasquare"],tatamibari:[1,0,"タタミバリ","Tatamibari"],tateyoko:[1,0,"タテボーヨコボー","Tatebo-Yokobo"],tawa:[0,0,"たわむれんが","Tawamurenga"],tentaisho:[0,0,"天体ショー","Tentaisho"],tents:[0,0,"Tents","Tents","tents"],teri:[0,0,"テリトリー","Territory","kurodoko"],tetrochain:[0,0,"テトロチェーン","Tetrochain"],tetrominous:[0,0,"Tetrominous","Tetrominous","fillomino"],tilepaint:[1,0,"タイルペイント","Tilepaint"],toichika:[0,0,"遠い誓い","Toichika"],toichika2:[0,0,"遠い誓い２","Toichika 2","toichika"],tontonbeya:[0,0,"とんとんべや","Tontonbeya","hakoiri"],tontti:[0,0,"Tonttiraja","Tonttiraja"],trainstations:[0,0,"Train Stations","Train Stations"],tren:[0,0,"パーキング","Tren"],triplace:[0,0,"トリプレイス","Tri-place"],tslither:[0,0,"Touch Slitherlink","Touch Slitherlink","vslither"],usotatami:[0,0,"ウソタタミ","Uso-tatami","fillmat"],usoone:[0,0,"ウソワン","Uso-one"],view:[1,0,"ヴィウ","View","sukoro"],voxas:[0,0,"Voxas","Voxas"],vslither:[0,0,"Vertex Slitherlink","Vertex Slitherlink"],wafusuma:[0,0,"和フスマ","Wafusuma","fillomino"],wagiri:[0,0,"ごきげんななめ・輪切","Wagiri","gokigen"],walllogic:[0,0,"ウォールロジック","Wall Logic"],waterwalk:[0,0,"ウォーターウォーク","Water Walk","icewalk"],wblink:[0,0,"シロクロリンク","Shirokuro-link"],wittgen:[0,0,"Wittgenstein Briquet","Wittgenstein Briquet","kaidan"],yajikazu:[1,0,"やじさんかずさん","Yajisan-Kazusan"],yajilin:[0,1,"ヤジリン","Yajilin","",{pzprurl:"yajilin",kanpen:"yajilin",alias:"yajirin"}],"yajilin-regions":[0,0,"ヘヤジリン","Regional Yajilin","yajilin",{alias:"yajirin-regions"}],yajisoko:[0,0,"やじさん倉庫番","Yajisan-Sokoban","yosenabe"],yajitatami:[0,0,"ヤジタタミ","Yajitatami"],yinyang:[0,0,"しろまるくろまる","Yin-Yang"],yosenabe:[0,0,"よせなべ","Yosenabe"]});for(A in S){w[A]=new C(A,S[A]);try{Object.freeze(w[A]),Object.freeze(w[A].exists),Object.freeze(w[A].alias)}catch(e){}}function q(e){var t=e.klass;e.board=new t.Board,p.classmgr.setPrototypeRef(e,"board",e.board),e.checker=new t.AnsCheck,e.painter=new t.Graphic,e.cursor=new t.TargetCursor,e.mouse=new t.MouseEvent,e.key=new t.KeyEvent,e.opemgr=new t.OperationManager,e.faillist=new t.FailCode}function z(e){if(!p.Candle.enable[e])return null;var t=document.createElement("div");return p.Candle.start(t,e),t}function T(e){var i,t=e.painter,n=e.preInitCanvasInfo;function s(e,t){p.util.addEvent(i.canvas,e,i,t)}e.preInitCanvasInfo&&("viewer"!==e.instancetype?(i=e,s("mousedown",P),s("mousemove",_),s("mouseup",R),s("mousecancel",B),i.canvas.oncontextmenu=function(){return!1},i.canvas.style.touchAction="pinch-zoom",s("keydown",E),s("keyup",I),s("click",function(e){e.stopPropagation(),e.preventDefault()})):t.outputImage=!0,t.canvasWidth&&t.canvasHeight||(n.width&&n.height?t.resizeCanvas(n.width,n.height):n.cellsize&&t.resizeCanvasByCellSize(n.cellsize,!0)),delete e.preInitCanvasInfo),t.initCanvas()}function P(e){this.mouse&&this.mouse.e_mousedown(e)}function _(e){this.mouse&&this.mouse.e_mousemove(e)}function R(e){this.mouse&&this.mouse.e_mouseup(e)}function B(e){this.mouse&&this.mouse.e_mousecancel(e)}function E(e){this.key&&this.key.e_keydown(e)}function I(e){this.key&&this.key.e_keyup(e)}function j(e,t){var i=z(t.type),n=new e.klass.Graphic;return n.context=i.getContext("2d"),n.context.enableTextLengthWA=!1,n.outputImage=!0,"bgcolor"in t&&(n.bgcolor=t.bgcolor),"kramma"===e.pid&&(n.imgtile=e.painter.imgtile),"bank"in t&&(n.showBank=t.bank),n.resizeCanvasByCellSize(t.cellsize),n.unsuspend(),i}function O(){for(var e={},t=p.Candle.current,i=null,n=null,s=null,o=null,r=0;r<arguments.length;r++){var a=arguments[r];switch(typeof a){case"string":t=a;break;case"number":1.01<a?i=a:s=a;break;case"object":"cellsize"in a&&(i=a.cellsize),"bgcolor"in a&&(n=a.bgcolor),"bank"in a&&(o=a.bank)}}return e.type=(t||p.Candle.current).match(/svg/)?"svg":"canvas",e.mimetype="svg"!==e.type?"image/"+t:"image/svg+xml",null!=s&&(e.quality=s),null!==i&&(e.cellsize=i),null!==n&&(e.bgcolor=n),null!==o&&(e.bank=o),e}function D(){throw Error("no implementation")}(h=p.parser=function(e,t){return h.parse(e,t)}).extend=function(e){for(var t in e)this[t]=e[t]},h.extend({URL_AUTO:0,URL_PZPRV3:1,URL_PZPRAPP:2,URL_KANPEN:3,URL_KANPENP:4,URL_HEYAAPP:5,URL_PZPRFILE:6,FILE_AUTO:0,FILE_PZPR:1,FILE_PBOX:2,FILE_PBOX_XML:3,parse:function(e,t){return e instanceof r||e instanceof a?e:this.parseFile(e,t)||this.parseURL(e)},parseURL:function(e){return e instanceof r?e:(e=e.replace(/(\r|\n)/g,""),new r(e).parse())},parseFile:function(e,t){return e instanceof a?e:(e.match(/^\<\?xml/)||(e=e.replace(/[\t\r]*\n/g,"\n").replace(/\//g,"\n")),new a(e,t).parse())}}),delete h.extend,r=p.parser.URLData=function(e,t){this.url=e,void 0!==t&&(this.mode=t)},p.parser.URLData.prototype={pid:"",mode:"",type:0,url:"",qdata:"",pflag:null,variant:null,cols:0,rows:0,body:"",isurl:!0,isfile:!1,URL_AUTO:0,URL_PZPRV3:1,URL_PZPRAPP:2,URL_KANPEN:3,URL_KANPENP:4,URL_HEYAAPP:5,URL_PZPRFILE:6,parse:function(){return this.parseURLType(),this.parseURLData(),this.changeProperPid(),this},generate:function(){return this.outputURLType()+this.outputURLData()},parseURLType:function(){var e,t,i,n=this.url;delete this.url,n.match(/www\.kanpen\.net/)||n.match(/www\.geocities(\.co)?\.jp\/pencil_applet/)?(n.match(/([0-9a-z]+)\.html/),this.pid=RegExp.$1,0<=n.indexOf("?heyawake=")?(this.qdata=n.substr(n.indexOf("?heyawake=")+10),this.type=5):0<=n.indexOf("?pzpr=")?(this.qdata=n.substr(n.indexOf("?pzpr=")+6),this.type=4):(this.qdata=n.substr(n.indexOf("?problem=")+9),this.type=3)):n.match(/www\.geocities(\.co)?\.jp\/heyawake/)?(this.pid="heyawake",this.qdata=n.substr(n.indexOf("?problem=")+9),this.type=5):n.match(/indi\.s58\.xrea\.com\/(.+)\/(sa|sc)\//)?(this.pid=RegExp.$1,this.qdata=n.substr(n.indexOf("?")),this.type=2):(n.startsWith("v:/")&&(n=n.substring(3),this.variant=!0),i="",(i=-1<(e=n.indexOf("/",n.indexOf("?")))?n.substring(n.indexOf("?")+1,e):n.substr(n.indexOf("?")+1)).match(/^pzprv[0-9.]*$/)?(2<=(t=(n=decodeURIComponent(n)).split("/")).length&&(this.pid=t[1]),this.qdata=n,this.type=6):(-1<e&&(this.qdata=n.substr(e+1)),(t=i).match(/_edit$/)?this.mode="editor":t.match(/_play$/)&&(this.mode="player"),this.pid=t.replace(/(_edit|_play)$/,""),this.type=1)),this.pid=p.variety.toPID(this.pid)},outputURLType:function(){var e="",e=p.env.node?"http://pzv.jp/p.html":location.protocol+"//"+location.host+location.pathname;switch(this.type){case 1:e+="?%PID%/";break;case 3:e="http://www.kanpen.net/%KID%.html?problem=";break;case 4:e="http://www.kanpen.net/%KID%.html?pzpr=";break;case 5:e="http://www.geocities.co.jp/heyawake/?problem=";break;case 6:e+="?"}var t=this.pid,i="";switch(this.mode){case"player":t+="_play",i="type=player&";break;case"editor":t+="_edit",i="type=editor&"}return 6===this.type&&(e+=i),e.replace("%PID%",p.variety(t).urlid).replace("%KID%",p.variety(this.pid).kanpenid)},parseURLData:function(){if(6===this.type)return t=this.qdata.split("/"),this.cols=+t[2],this.rows=+t[3],this.body=this.qdata.replace(/\//g,"\n"),void delete this.qdata;var e,t=this.qdata.split("/"),i=0,n=0;delete this.qdata,3!==this.type&&5!==this.type&&(t[0]&&t[0].match(/^v:(.*)/)&&(this.variant=RegExp.$1,t.shift()),t[0]&&isNaN(t[0])?(this.pflag=t[0],t.shift()):this.pflag=""),3===this.type?"kakuro"===this.pid?(n=+t.shift()-1,i=+t.shift()-1):"sudoku"===this.pid?n=i=+t.shift():(n=+t.shift(),i=+t.shift()):n=5===this.type?(i=+(e=t.shift().split("x"))[0],+e[1]):(i=+t.shift()||NaN,+t.shift()||NaN),this.rows=n,this.cols=i,t[t.length-1]||t.pop(),this.body=t.join("/")},outputURLData:function(){var e=this,t=e.cols,i=e.rows,n=[],t=(3!==e.type&&5!==e.type&&(null!==e.variant&&n.push("v:"+e.variant),4!==e.type&&!e.pflag||n.push(e.pflag)),3===e.type?"kakuro"===e.pid?(n.push(i+1),n.push(t+1)):("sudoku"!==e.pid&&n.push(i),n.push(t)):5===e.type?n.push([t,i].join("x")):6!==e.type&&(n.push(t),n.push(i)),n.push(e.body),n.join("/"));return t.charAt(t.length-1).match(/[a-zA-Z0-9]/)||(t+="/"),t},changeProperPid:function(){if(this.body&&(1===this.type||2===this.type))switch(this.pid){case"ichimaga":0<=this.pflag.indexOf("m")?this.pid="ichimagam":0<=this.pflag.indexOf("x")?this.pid="ichimagax":this.pid="ichimaga";break;case"icelom":this.pflag.indexOf("a")<0&&(this.pid="icelom2");break;case"pipelink":this.body.match(/[0-9]/)&&(this.pid="pipelinkr");break;case"bonsan":var e,t;this.pflag.indexOf("c")<0&&(e=this.cols,t=this.rows,this.body.substr(0,(((e-1)*t+4)/5|0)+((e*(t-1)+4)/5|0)||0).match(/[^0]/)&&(this.pid="heyabon"));break;case"kramma":if(this.pflag.indexOf("c")<0)for(var i=(this.cols-1)*(this.rows-1),n=0,s=0;s<this.body.length;s++){var o=this.body.charAt(s);if(o.match(/\w/)){if((n+=parseInt(o,36))<i){this.pid="kramman";break}}else"."===o&&(n+=36);if(i<=n)break}}}},a=p.parser.FileData=function(e,t){this.pid=t||"",this.fstr=e,this.metadata=new p.MetaData},p.parser.FileData.prototype={pid:"",type:0,filever:0,fstr:"",qdata:"",cols:0,rows:0,body:"",history:"",metadata:null,xmldoc:null,isurl:!1,isfile:!0,FILE_AUTO:0,FILE_PZPR:1,FILE_PBOX:2,FILE_PBOX_XML:3,parse:function(){var e=this.parseFileType()&&this.parseFileData();return e&&this.changeProperPid(),e?this:null},generate:function(){return this.outputFileType()+this.outputFileData()},parseFileType:function(){var e=this.fstr.split("\n"),t=e.shift();return delete this.fstr,t.match(/^pzprv3/)?(this.type=1,t.match(/pzprv3\.(\d+)/)&&(this.filever=+RegExp.$1),this.pid=e.shift(),this.qdata=e.join("\n")):t.match(/^\<\?xml/)?(this.type=3,e.unshift(t),this.qdata=e.join("\n"),f?(this.body=(new f).parseFromString(this.qdata,"text/xml"),this.pid=this.body.querySelector("puzzle").getAttribute("type")):this.pid=""):t.match(/^\d+$/)?(this.type=2,e.unshift(t),this.qdata=e.join("\n")):this.pid="",this.pid=p.variety.toPID(this.pid),!!this.pid},outputFileType:function(){return 1===this.type?[0===this.filever?"pzprv3":"pzprv3."+this.filever,this.pid,""].join("\n"):(3===this.type&&this.body.querySelector("puzzle").setAttribute("type",p.variety(this.pid).kanpenid),"")},parseFileData:function(){var e=this.qdata.split("\n"),t=0,i=0;if(delete this.qdata,3===this.type?(i=+this.body.querySelector("size").getAttribute("row"),t=+this.body.querySelector("size").getAttribute("col"),"slither"!==this.pid&&"kakuro"!==this.pid||(i--,t--)):2===this.type&&"kakuro"===this.pid?(i=+e.shift()-1,t=+e.shift()-1):"sudoku"===this.pid?i=t=+e.shift():(i=+e.shift(),t=+e.shift()),i<=0||t<=0)return!1;if(this.rows=i,this.cols=t,1===this.type){for(var n=null,s="",o=[],r=!1,a=0;a<e.length&&!e[a].match(/^http\:\/\//);a++){if(e[a].match(/info:\{/)){n=a,r=!0;break}if(e[a].match(/history:\{|__HISTORY__/)){n=a;break}o.push(e[a])}if(this.body+=o.join("\n"),null!==n&&JSON)for(var h,l=0,a=n;a<e.length&&(s+=e[a],h=l,l=(l+=(e[a].match(/\{/g)||[]).length)-(e[a].match(/\}/g)||[]).length,!(0<h&&0===l));a++);JSON&&(r&&"info:"===s.substr(0,5)?(i=JSON.parse(s.substr(5)),this.metadata.update(i.metadata),this.history=i.history||""):"history:"===s.substr(0,8)&&(this.history=JSON.parse(s.substr(8))))}else 2===this.type?this.body=e.join("\n"):3===this.type&&this.body&&(t=this.body.querySelector("property"),(i=this.metadata).author=t.querySelector("author").getAttribute("value"),i.source=t.querySelector("source").getAttribute("value"),i.hard=t.querySelector("difficulty").getAttribute("value"),t=t.querySelector("comment"),i.comment=t?t.childNodes[0].data:"");return!0},outputFileData:function(){var e,t,i=this,n=i.cols,s=i.rows,o=[],r=3===this.type?this.body.querySelector("puzzle"):null;return 3===i.type?((e=r.querySelector("size"))&&r.removeChild(e),"slither"!==i.pid&&"kakuro"!==i.pid||(s++,n++),r.appendChild(this.createXMLNode("size",{row:s,col:n}))):2===i.type&&"kakuro"===i.pid?(o.push(s+1),o.push(n+1)):("sudoku"!==i.pid&&o.push(s),o.push(n)),3!==i.type&&o.push(i.body),1===i.type&&JSON?i.metadata.empty()?i.history&&o.push("history:"+JSON.stringify(i.history,null,1)):(e={metadata:i.metadata.getvaliddata()},i.history&&(e.history=i.history),o.push("info:"+JSON.stringify(e,null,1))):3===i.type&&((s=r.querySelector("property"))&&r.removeChild(s),s=this.createXMLNode("property"),n=i.metadata,s.appendChild(this.createXMLNode("author",{value:n.author})),s.appendChild(this.createXMLNode("source",{value:n.source})),s.appendChild(this.createXMLNode("difficulty",{value:n.hard})),n.comment&&((e=this.createXMLNode("comment")).appendChild(this.body.createTextNode(n.comment)),s.appendChild(e)),r.appendChild(s),r.appendChild(r.querySelector("board")),r.appendChild(r.querySelector("answer"))),3!==i.type?t=o.join("\n"):(t=(new g).serializeToString(this.body)).match(/^\<\?xml/)||(t='<?xml version="1.0" encoding="UTF-8"?>\n'+t),t},createXMLNode:function(e,t){var i=this.body.createElement(e);if(t)for(var n in t)i.setAttribute(n,t[n]);return i},changeProperPid:function(){if(1===this.type)switch(this.pid){case"ichimaga":var e=this.body.split("\n")[0];"mag"===e?this.pid="ichimagam":"cross"===e&&(this.pid="ichimagax");break;case"icelom":"skipwhite"===this.body.split("\n")[2]&&(this.pid="icelom2");break;case"pipelink":var t=this.body.split("\n"),i=1,n=this.rows;t.slice(i,i+n).join("").match(/o/)&&(this.pid="pipelinkr");break;case"bonsan":t=this.body.split("\n"),i=2*this.rows,n=2*this.rows-1;t.slice(i,i+n).join("").match(/1/)&&(this.pid="heyabon");break;case"kramma":t=this.body.split("\n"),i=this.rows,n=this.rows+1;t.slice(i,i+n).join("").match(/1/)&&(this.pid="kramman")}}},p.MetaData=function(){},p.MetaData.prototype={author:"",source:"",hard:"",comment:"",items:{author:"",source:"",hard:"",comment:""},update:function(e){if(e)for(var t in this.items)"string"==typeof e[t]&&(this[t]=e[t])},getvaliddata:function(){var e,t={};for(e in this.items)this[e]&&(t[e]=this[e]);return t},reset:function(){for(var e in this.items)this[e]=""},empty:function(){for(var e in this.items)if(this[e])return!1;return!0}},l=p.env.API,c=["mousedown"],u=["mousemove"],d=["mouseup"],b=[""],p.env.bz.AndroidBrowser&&(c=[""],u=[""],d=[""]),l.pointerevent?(c=["pointerdown"],u=["pointermove"],d=["pointerup"],b=["pointercancel"]):l.mspointerevent?(c=["MSPointerDown"],u=["MSPointerMove"],d=["MSPointerUp"],b=["MSPointerCancel"]):l.touchevent&&(c.push("touchstart"),u.push("touchmove"),d.push("touchend"),b.push("touchcancel")),p.util={getpath:function(){if(!p.env.browser)return require("path").dirname(__filename)+"/"+(__filename.match("pzpr.js")?"":"../");for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++){var i=e[t].src.match(/^(.*\/)pzpr\.js(?:\?.*)?$/);if(i)return i[1]+(i[1].match(/\/$/)?"":"/")}return""},currentTime:function(){return(new Date).getTime()},unselectable:function(e){return e.style.MozUserSelect="none",e.style.KhtmlUserSelect="none",e.style.webkitUserSelect="none",e.style.msUserSelect="none",e.style.userSelect="none",e.unselectable="on",this},addEvent:function(t,e,i,n,s){var o=[e];function r(e){n.call(i,e)}return"mousedown"===e?o=c:"mousemove"===e?o=u:"mouseup"===e?o=d:"mousecancel"===e&&(o=b),o.forEach(function(e){t.addEventListener(e,r,!!s)}),function(){o.forEach(function(e){t.removeEventListener(e,r,!!s)})}},getMouseButton:function(e){return void 0!==e.touches?1===e.touches.length?"left":"":e.pointerType&&"mouse"!==e.pointerType?e.isPrimary?"left":"":["left","middle","right"][void 0!==e.button?e.button:e.which-1]||""},getPagePos:function(e){return{px:this.pageX(e),py:this.pageY(e)}},pageX:function(e){if(void 0!==e.touches&&0<e.touches.length){var t=e.touches.length,i=0;if(0<t){for(var n=0;n<t;n++)i+=e.touches[n].pageX;return i/t}}return e.pageX||0},pageY:function(e){if(void 0!==e.touches&&0<e.touches.length){var t=e.touches.length,i=0;if(0<t){for(var n=0;n<t;n++)i+=e.touches[n].pageY;return i/t}}return e.pageY||0},getRect:function(e){if(!p.env.browser)return{top:0,bottom:0,left:0,right:0,height:0,width:0};var t,e=e.getBoundingClientRect(),i=(t=void 0!==window.scrollX?(s=window.scrollX,window.scrollY):(s=(t=document.documentElement).scrollLeft,t.scrollTop),e.left+s),n=e.top+t,s=e.right+s,e=e.bottom+t;return{top:n,bottom:e,left:i,right:s,height:e-n,width:s-i}},checkpid:function(e,t){var i=e.match(/!?[a-z0-9-]+/g),n=!0;if(i)for(var n=!1,s=0;s<i.length;s++)"!"!==i[s].charAt(0)?i[s]===t&&(n=!0):n=i[s].substr(1)!==t;return n},sameArray:function(e,t){if(e.length!==t.length)return!1;for(var i=0;i<t.length;i++)if(e[i]!==t[i])return!1;return!0}},p.Puzzle=function(e,t){this.pzpr=p,void 0!==t||e&&e.parentNode||(t=e,e=void 0),this.instancetype=(t=t||{}).type||"editor";var i={player:1,viewer:2}[this.instancetype||0]||0;this.playeronly=!!i,this.editmode=!this.playeronly,this.playmode=!this.editmode,this.resetTime(),this.preInitCanvasInfo={type:t.graphic||"",width:t.width||null,height:t.height||null,cellsize:t.cellsize||null},this.listeners={},this.metadata=new p.MetaData,this.config=new this.Config(this),void 0!==t.config&&this.config.setAll(t.config),void 0!==t.mode&&this.setMode(t.mode),void 0!==t.variant&&this.config.set("variant",!0),e&&this.setCanvas(e),p.classmgr.setClasses(this,""),q(this)},p.Puzzle.prototype={pid:null,info:{},klass:null,ready:!1,editmode:!1,playmode:!1,playeronly:!1,instancetype:"",starttime:0,canvas:null,subcanvas:null,listeners:null,config:null,metadata:null,MODE_EDITOR:1,MODE_PLAYER:3,open:function(e,t,i){var n=this,s=i,i=("string"==typeof t||s||(s=t,t=void 0),n.ready=!1,n.klass),o=i&&i.Board?i.Board:null,r=p.parser(e,t||n.pid);return p.classmgr.setPuzzleClass(n,r.pid,function(){o!==n.klass.Board?q(n):n.painter.suspendAll();try{n.metadata.reset(),r.isurl?(new n.klass.Encode).decodeURL(r):r.isfile&&(new n.klass.FileIO).filedecode(r),n.ready=!0,n.emit("ready"),n.emit("mode"),n.canvas&&T(n),n.resetTime(),s&&s(n)}catch(e){throw n.emit("fail-open"),e}}),this},on:function(e,t){this.addListener(e,t,!1)},once:function(e,t){this.addListener(e,t,!0)},addListener:function(e,t,i){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push({func:t,once:!!i})},emit:function(){var e=Array.prototype.slice.apply(arguments),t=e.shift(),i=this.listeners[t];if(i){e.unshift(this);for(var n=0;n<i.length;n++){var s=i[n];i[n].once&&(i.splice(n,1),n--),s.func.apply(this,e)}}},setCanvas:function(e,t){var i,n,s,o;e&&(i=p.util.getRect(e),(n=document.createElement("div")).style.width=i.width+"px",n.style.height=i.height+"px",e.appendChild(n),this.canvas=n,s=this,"canvas"===(o=t||this.preInitCanvasInfo.type)&&p.Candle.enable.canvas&&!CanvasRenderingContext2D.prototype.fillText&&(o="svg"),p.Candle.start(s.canvas,o,function(e){p.util.unselectable(e.canvas),e.child.style.pointerEvents="none",e.use.canvas&&!s.subcanvas&&(e=s.subcanvas=z("canvas"),document.body&&(e.id="_"+(new Date).getTime()+o,e.style.position="absolute",e.style.left="-10000px",e.style.top="0px",document.body.appendChild(e))),s.ready&&T(s)}))},setCanvasSize:function(e,t){this.preInitCanvasInfo?(this.preInitCanvasInfo.width=e,this.preInitCanvasInfo.height=t):this.painter.resizeCanvas(e,t)},setCanvasSizeByCellSize:function(e,t){this.preInitCanvasInfo?this.preInitCanvasInfo.cellsize=e*(t?1:this.painter.cellexpandratio):this.painter.resizeCanvasByCellSize(e,t)},redraw:function(e){e?this.painter.resizeCanvas():this.painter.paintAll()},irowake:function(){this.board.irowakeRemake(),(this.execConfig("irowake")||this.execConfig("irowakeblk"))&&this.redraw()},toDataURL:function(e,t,i){e=O(e,t,i),t=j(this,e),i=t.toDataURL(e.mimetype,e.quality);return t.parentNode&&t.parentNode.removeChild(t),i},toBlob:function(t,e,i,n){var e=O(e,i,n),s=j(this,e);s.toBlob(function(e){t(e),s.parentNode&&s.parentNode.removeChild(s)},e.mimetype,e.quality)},toBuffer:function(e,t,i){e=O(e,t,i),t=j(this,e),i=t.toBuffer(e.mimetype,e.quality);return t.parentNode&&t.parentNode.removeChild(t),i},getURL:function(e,t){return(new this.klass.Encode).encodeURL(e,t)},getFileData:function(e,t){return(new this.klass.FileIO).fileencode(e,t)},resetTime:function(){this.starttime=p.util.currentTime()},getTime:function(){return p.util.currentTime()-this.starttime},undo:function(){return this.opemgr.undo()},redo:function(){return this.opemgr.redo()},undoall:function(){for(;this.opemgr.undo(););},redoall:function(){for(;this.opemgr.redo(););},ismodified:function(){return this.opemgr.isModified()},saved:function(){return this.opemgr.resetModifiedState()},enterTrial:function(){this.opemgr.enterTrial()},acceptTrial:function(){this.opemgr.acceptTrial()},rejectTrial:function(){this.opemgr.rejectTrial(!0)},rejectCurrentTrial:function(){this.opemgr.rejectTrial(!1)},check:function(e){return e&&(this.key.keyreset(),this.mouse.mousereset()),this.checker.check(e)},ansclear:function(){this.board.ansclear(),this.board.rebuildInfo(),this.redraw()},subclear:function(){this.board.subclear(),this.redraw()},errclear:function(){var e=this.board.errclear();return e&&this.redraw(!0),e},clear:function(){this.playeronly?(this.ansclear(),this.opemgr.allerase()):(this.board.initBoardSize(),this.redraw())},setMode:function(e){this.playeronly||"string"==typeof e&&void 0===(e={edit:1,play:3}[e.substr(0,4)])||(this.editmode=e===this.MODE_EDITOR,this.playmode=!this.editmode,this.klass&&(this.cursor.adjust_modechange(),this.key.keyreset(),this.mouse.modechange(),this.board.errclear(),this.redraw()),this.emit("config","mode",e),this.emit("mode"))},getConfig:function(e){return this.config.get(e)},setConfig:function(e,t){return this.config.set(e,t)},resetConfig:function(e){return this.config.reset(e)},validConfig:function(e){return this.config.getexec(e)},execConfig:function(e){return this.config.get(e)&&this.config.getexec(e)},getCurrentConfig:function(){return this.config.getList()},saveConfig:function(){return this.config.getAll()},restoreConfig:function(e){this.config.setAll(e)}},(p.Puzzle.prototype.Config=function(e){this.puzzle=e,this.init()}).prototype={list:null,init:function(){this.list={};var e=p.env.API.lowaccuracy||p.env.API.touchevent;this.add("font",1,{option:[1,2]}),this.add("cursor",!0),this.add("trialmarker",!0),this.add("timer",!0),this.add("irowake",!1,{variety:!0}),this.add("irowakeblk",!1,{variety:!0}),this.add("dispmove",!0),this.add("disptype_yajilin",1,{option:[1,2]}),this.add("disptype_bosanowa",1,{option:[1,2,3]}),this.add("disptype_interbd",3,{option:[1,2,3]}),this.add("snakebd",!1),this.add("ensquare",!0),this.add("context_marks",!0),this.add("dispqnumbg",!1),this.add("undefcell",!0),this.add("mouseonly",!1),this.add("patchwork_leftaux",!0),this.add("squarecell",!0),this.add("use",e?2:1,{option:[1,2]}),this.add("use_tri",1,{option:[1,2,3]}),this.add("support_tri",!0),this.add("bgcolor",!1),this.add("singlenum",!e),this.add("singleregion",!0),this.add("enline",!0),this.add("lattice",!0),this.add("autocmp",!0,{variety:!0}),this.add("autoerr",!1,{variety:!0}),this.add("multierr",!1),this.add("forceallcell",!1),this.add("dontpassallcell",!1,{variant:!0,volatile:!0}),this.add("aquarium_regions",!1,{variant:!0,volatile:!0}),this.add("country_empty",!1,{variant:!0,volatile:!0}),this.add("voxas_tatami",!1,{variant:!0,volatile:!0}),this.add("tren_new",!1,{variant:!0,volatile:!0}),this.add("nuriuzu_connect",!1,{variant:!0,volatile:!0}),this.add("bdwalk_height",!1,{variant:!0,volatile:!0}),this.add("pentopia_transparent",!1,{variant:!0,volatile:!0}),this.add("koburin_minesweeper",!1,{variant:!0,volatile:!0}),this.add("akichi_maximum",!1,{variant:!0,volatile:!0}),this.add("magnets_anti",!1,{variant:!0,volatile:!0}),this.add("heyapin_overlap",!1,{variant:!0,volatile:!0}),this.add("variant",!1,{variant:!0,volatile:!0}),this.add("variantid","",{volatile:!0}),this.add("discolor",!1),this.add("uramashu",!1,{volatile:!0})},add:function(e,t,i){t={val:t,defval:t,volatile:!(!(i=i||{}).volatile&&!i.variant),extoption:i};i.option&&(t.option=i.option),i.variety&&(t.variety={}),i.variant&&(t.variant=!0),this.list[e]=t},getCurrentName:function(e){switch(e){case"color_qanscolor":e="color_shadecolor";break;case"autocmp_area":case"autocmp_border":this.getexec("autocmp")&&(e="autocmp")}return e},getNormalizedName:function(e){var t={name:e};return e.match(/\@/)&&(e=e.split(/\@/),t.name=e[0],(e=p.variety.toPID(e[1]))&&(t.pid=e)),t.name=this.getCurrentName(t.name),t},get:function(e){var e=this.getNormalizedName(e),t=e.name,t=this.list[t];if(!t)return null;if(t.variety){e=(void 0!==e.pid?e:this.puzzle).pid;if(void 0!==t.variety[e])return t.variety[e]}return t.val},set:function(e,t){var e=this.getNormalizedName(e),i=e.name;this.list[i]&&(t=this.setproper(e,t),this.configevent(i,t),this.puzzle.emit("config",i,t))},reset:function(e){var t=this.getNormalizedName(e),i=this.list[t.name];i&&(i.variety&&!t.pid?(i.variety={},this.set(t.name,i.defval)):this.set(e,i.defval))},getList:function(){var e,t={};for(e in this.list)this.getexec(e)&&(t[e]=this.get(e));return t},getvariant:function(e){e=this.list[e];return e?e.variant:null},getVariants:function(){var e,t={};for(e in this.list)this.list[e].variant&&this.getexec(e)&&(t[e]=this.get(e));return t},getAll:function(){var e,t={};for(e in this.list){var i=this.list[e];if(!i.volatile&&(i.val!==i.defval&&(t[e]=i.val),i.variety))for(var n in i.variety)i.variety[n]!==i.defval&&(t[e+"@"+n]=i.variety[n])}return t},setAll:function(e){for(var t in this.init(),e)this.set(t,e[t])},setproper:function(e,t){var i=e.name,i=this.list[i];switch(typeof i.defval){case"boolean":t=!!t;break;case"number":t=+t;break;case"string":t=""+t}return(!i.option||0<=i.option.indexOf(t))&&(i.variety?(e=(void 0!==e.pid?e:this.puzzle).pid)&&(i.variety[e]=t):i.val=t),t},getexec:function(e){var t=this.puzzle,i=t.pid,n=!t.playeronly,s=!1;switch(e){case"use":s=t.mouse.use;break;case"use_tri":case"support_tri":s="shakashaka"===i;break;case"dispmove":s=t.board.linegraph.moveline;break;case"disptype_bosanowa":s="bosanowa"===i;break;case"context_marks":s="context"===i;break;case"disptype_yajilin":s="yajilin"===i||"koburin"===i||"lixloop"===i;break;case"disptype_interbd":s="interbd"===i;break;case"bgcolor":s="slither"===i||"myopia"===i;break;case"irowake":s=t.painter.irowake;break;case"irowakeblk":s=t.painter.irowakeblk;break;case"snakebd":s="hebi"===i;break;case"ensquare":s="tajmahal"===i;break;case"dispqnumbg":s="yinyang"===i;break;case"mouseonly":s="lollipops"===i||"magnets"===i;break;case"patchwork_leftaux":s="patchwork"===i;break;case"undefcell":s="shugaku"===i||"lightshadow"===i;break;case"autocmp":s=!!t.painter.autocmp;break;case"autoerr":s="hitori"===i||"gokigen"===i||"wagiri"===i;break;case"singlenum":s="hanare"===i||"putteria"===i;break;case"singleregion":s="parquet"===i;break;case"enline":case"lattice":s="kouchoku"===i||"angleloop"===i;break;case"discolor":s=n&&"tentaisho"===i;break;case"uramashu":s="mashu"===i;break;case"forceallcell":s="fillomino"===i||"symmarea"===i||"snakepit"===i;break;case"dontpassallcell":s="arukone"===i;break;case"aquarium_regions":s="aquarium"===i;break;case"country_empty":s="country"===i;break;case"voxas_tatami":s="voxas"===i;break;case"tren_new":s="tren"===i||"news"===i;break;case"nuriuzu_connect":s="nuriuzu"===i;break;case"bdwalk_height":s="bdwalk"===i;break;case"pentopia_transparent":s="pentopia"===i;break;case"koburin_minesweeper":s="koburin"===i;break;case"akichi_maximum":s="akichi"===i;break;case"magnets_anti":s="magnets"===i;break;case"heyapin_overlap":s="heyapin"===i;break;default:s=!!this.list[e]}return s},configevent:function(e,t){var i=this.puzzle;if(i.klass&&this.getexec(e))switch(e){case"irowake":case"irowakeblk":case"dispmove":case"cursor":case"trialmarker":case"undefcell":case"autocmp":case"autoerr":case"aquarium_regions":case"koburin_minesweeper":case"snakebd":case"context_marks":case"disptype_yajilin":case"disptype_interbd":case"dispqnumbg":case"mouseonly":i.redraw();break;case"font":i.painter.initFont(),i.redraw();break;case"multierr":i.checker.resetCache();break;case"disptype_bosanowa":i.setCanvasSizeByCellSize();break;case"uramashu":i.board.revCircleConfig(t),i.redraw()}}},p.classmgr.makeCommon({Position:{bx:null,by:null,NDIR:0,UP:1,DN:2,LT:3,RT:4,equals:function(e){return e&&this.bx===e.bx&&this.by===e.by},getaddr:function(){return new this.klass.Address(this.bx,this.by)},relcell:function(e,t){return this.board.getc(this.bx+e,this.by+t)},relcross:function(e,t){return this.board.getx(this.bx+e,this.by+t)},relbd:function(e,t){return this.board.getb(this.bx+e,this.by+t)},relexcell:function(e,t){return this.board.getex(this.bx+e,this.by+t)},relobj:function(e,t){return this.board.getobj(this.bx+e,this.by+t)},reldirbd:function(e,t){return this.getaddr().movedir(e,t).getb()},draw:function(){this.puzzle.painter.paintRange(this.bx-1,this.by-1,this.bx+1,this.by+1)},drawaround:function(){this.puzzle.painter.paintRange(this.bx-3,this.by-3,this.bx+3,this.by+3)},isinside:function(){var e=this.board;return this.bx>=e.minbx&&this.bx<=e.maxbx&&this.by>=e.minby&&this.by<=e.maxby},getdir:function(e,t){var i=e.bx-this.bx,e=e.by-this.by;return 0==i&&e==-t?this.UP:0==i&&e===t?this.DN:i==-t&&0==e?this.LT:i===t&&0==e?this.RT:this.NDIR},getvert:function(e,t){e=this.getdir(e,t);return e===this.UP||e===this.DN||e!==this.LT&&e!==this.RT&&void 0},getnb:function(e){return e.bx-this.bx==0&&e.by-this.by==-2?this.relbd(0,-1):e.bx-this.bx==0&&e.by-this.by==2?this.relbd(0,1):e.bx-this.bx==-2&&e.by-this.by==0?this.relbd(-1,0):e.bx-this.bx==2&&e.by-this.by==0?this.relbd(1,0):this.board.emptyborder},getborderobj:function(e){return 0==(1&e.bx)&&this.bx===e.bx&&1===Math.abs(this.by-e.by)||0==(1&e.by)&&this.by===e.by&&1===Math.abs(this.bx-e.bx)?(this.onborder()?this:e).getb():this.board.nullobj}},"Address:Position":{initialize:function(e,t){2<=arguments.length&&this.init(e,t)},reset:function(){this.bx=null,this.by=null},clone:function(){return new this.constructor(this.bx,this.by)},set:function(e){return this.bx=e.bx,this.by=e.by,this},init:function(e,t){return this.bx=e,this.by=t,this},move:function(e,t){return this.bx+=e,this.by+=t,this},oncell:function(){return!!(1&this.bx&&1&this.by)},oncross:function(){return!(1&this.bx||1&this.by)},onborder:function(){return!!(this.bx+this.by&1)},getc:function(){return this.board.getc(this.bx,this.by)},getx:function(){return this.board.getx(this.bx,this.by)},getb:function(){return this.board.getb(this.bx,this.by)},getex:function(){return this.board.getex(this.bx,this.by)},getobj:function(){return this.board.getobj(this.bx,this.by)},getDot:function(){return this.board.getDot(this.bx,this.by)},movedir:function(e,t){switch(e){case this.UP:this.by-=t;break;case this.DN:this.by+=t;break;case this.LT:this.bx-=t;break;case this.RT:this.bx+=t}return this}},"RawAddress:Address":{},"Dot:Position":{isnull:!0,id:null,piece:null,getDot:function(){return this.piece.qnum},setDot:function(e){this.puzzle.opemgr.disCombine=!0,this.piece.setQnum(e),this.puzzle.opemgr.disCombine=!1},iserror:function(){return 0<this.piece.error},getaddr:function(){return new this.klass.Address(this.bx,this.by)}}}),p.classmgr.makeCommon({"BoardPiece:Position":{group:"none",id:null,isnull:!0,ques:0,qdir:0,qnum:-1,qnum2:-1,qnum3:-1,qnum4:-1,qnums:[],qchar:0,qans:0,anum:-1,line:0,qsub:0,qcmp:0,snum:-1,error:0,qinfo:0,trial:0,propques:["ques","qdir","qnum","qnum2","qnum3","qnum4","qchar","qnums"],propans:["qans","anum","line","trial"],propsub:["qsub","qcmp","snum"],propinfo:["error","qinfo"],propnorec:{color:1,error:1,qinfo:1},maxnum:999,minnum:1,initAdjacent:function(){this.adjacent={top:this.relobj(0,-2),bottom:this.relobj(0,2),left:this.relobj(-2,0),right:this.relobj(2,0)}},initAdjBorder:function(){this.adjborder={top:this.relbd(0,-1),bottom:this.relbd(0,1),left:this.relbd(-1,0),right:this.relbd(1,0)}},setQues:function(e){this.setdata("ques",e)},setQans:function(e){this.setdata("qans",e)},setQdir:function(e){this.setdata("qdir",e)},setQnum:function(e){this.setdata("qnum",e)},setQnum2:function(e){this.setdata("qnum2",e)},setQchar:function(e){this.setdata("qchar",e)},setAnum:function(e){this.setdata("anum",e)},setLineVal:function(e){this.setdata("line",e)},setQsub:function(e){this.setdata("qsub",e)},setQcmp:function(e){this.setdata("qcmp",e)},setSnum:function(e){this.setdata("snum",e)},distinctQnums:!1,isValidQnums:function(e){return e.length<=4},setQnums:function(e){this.setdata("qnums",e)},setQnumDir:function(e,t){switch(e){case this.RT:return void this.setdata("qnum",t);case this.DN:return void this.setdata("qnum2",t);case this.LT:return void this.setdata("qnum3",t);case this.UP:return void this.setdata("qnum4",t)}},getQnumDir:function(e){switch(e){case this.RT:return this.qnum;case this.DN:return this.qnum2;case this.LT:return this.qnum3;case this.UP:return this.qnum4}return-1},setdata:function(e,t,i){("qnums"===e?this.puzzle.pzpr.util.sameArray(this[e],t):this[e]===t)||this.prehook[e]&&this.prehook[e].call(this,t)&&!i||(this.addOpe(e,this[e],t),this[e]=t,0<(i=this.board.trialstage)&&(this.trial=i),this.board.modifyInfo(this,this.group+"."+e),this.posthook[e]&&this.posthook[e].call(this,t))},addOpe:function(e,t,i){"qnums"===e?this.puzzle.pzpr.util.sameArray(t,i)||this.puzzle.opemgr.add(new this.klass.ObjectOperation2(this,t,i)):t!==i&&this.puzzle.opemgr.add(new this.klass.ObjectOperation(this,e,t,i))},setdata2:function(e,t,i,n){this[e][t]===i||this.prehook[e]&&this.prehook[e].call(this,t,i)&&!n||(this.addOpe(e+t,this[e][t],i),this[e][t]=i,0<(n=this.board.trialstage)&&(this.trial=n),this.posthook[e]&&this.posthook[e].call(this,t,i))},getprops:function(){for(var e={},t=this.getproplist(["ques","ans","sub"]),i=0;i<t.length;i++){var n=t[i];e[n]=this[n]}return e},compare:function(e,t){for(var i=this.getproplist(["ques","ans","sub"]),n=0;n<i.length;n++){var s=i[n];("qnums"===s?this.puzzle.pzpr.util.sameArray(e[s],this[s]):e[s]===this[s])||t(this.group,this.id,s)}},getproplist:function(e){for(var t=[],i=0;i<e.length;i++){var n=[];switch(e[i]){case"ques":n=this.propques;break;case"ans":n=this.propans;break;case"sub":n=this.propsub;break;case"info":n=this.propinfo;break;case"trial":n=["trial"]}t=t.concat(n)}return 0<=t.indexOf("snum")&&this.enableSubNumberArray&&t.splice(t.indexOf("snum"),1,"snum0","snum1","snum2","snum3"),t},getmaxnum:function(){return"function"==typeof this.maxnum?this.maxnum():this.maxnum},getminnum:function(){return"function"==typeof this.minnum?this.minnum():this.minnum},prehook:{},posthook:{},seterr:function(e){this.board.isenableSetError()&&(this.error=e)},setinfo:function(e){this.qinfo=e},setCrossBorderError:function(){this.seterr(1),this.board.borderinside(this.bx-1,this.by-1,this.bx+1,this.by+1).seterr(1)}},"Cell:BoardPiece":{group:"cell",lcnt:0,base:null,dirs51:2,disInputHatena:!1,numberWithMB:!1,numberAsObject:!1,numberAsLetter:!1,numberRemainsUnshaded:!1,enableSubNumberArray:!1,disableAnum:!1,supportQnumAnum:!1,adjacent:{},adjborder:{},initialize:function(){var e;this.temp=this.constructor.prototype,this.enableSubNumberArray&&(e=this.temp.anum,this.snum=[e,e,e,e])},prehook:{qnum:function(e){return 0<this.getminnum()&&0===e},qnum2:function(e){return 0<this.getminnum()&&0===e},anum:function(e){return 0<this.getminnum()&&0===e}},posthook:{},isShade:function(){return!this.isnull&&1===this.qans},isUnshade:function(){return!this.isnull&&1!==this.qans},setShade:function(){this.setQans(1)},clrShade:function(){this.setQans(0)},allowShade:function(){return!this.numberRemainsUnshaded||-1===this.qnum},allowUnshade:function(){return!this.numberRemainsUnshaded||(-1===this.qnum||this.puzzle.painter.enablebcolor)},isShadeDecided:function(){return!!this.isnull||(!!this.isShade()||(0<this.qsub||(!this.allowShade()||!this.allowUnshade())))},getNum:function(){return-1!==this.qnum?this.qnum:this.anum},setNum:function(e){var t;0<this.getminnum()&&0===e||(this.puzzle.editmode?(e=!this.numberAsObject&&-2!==e||this.qnum!==e?e:-1,this.setQnum(e),this.setAnum(-1),this.numberRemainsUnshaded&&this.setQans(0),this.puzzle.painter.enablebcolor||this.setQsub(0),this.setQcmp(0),this.clrSnum()):-1!==this.qnum||this.disableAnum||(t=-1<e&&(!this.numberAsObject||this.anum!==e)?e:-1,e=e<-1&&(!this.numberAsObject||this.qsub!==-e-1)?-e-1:0,this.setAnum(t),this.setQsub(e),this.setQdir(0),this.setQcmp(0),this.numberWithMB&&-1===t||this.clrSnum()))},isNum:function(){return!this.isnull&&(this.qnum!==this.temp.qnum||this.anum!==this.temp.anum)},noNum:function(){return!this.isnull&&this.qnum===this.temp.qnum&&this.anum===this.temp.anum},isValidNum:function(){return!this.isnull&&(0<=this.qnum||0<=this.anum&&this.qnum===this.temp.qnum)},isNumberObj:function(){return this.qnum!==this.temp.qnum||this.anum!==this.temp.anum||this.numberWithMB&&1===this.qsub},sameNumber:function(e){return this.isValidNum()&&e.isValidNum()&&this.getNum()===e.getNum()},setSnum:function(e,t){this.isNum()&&-1!==t||(this.enableSubNumberArray?this.setdata2("snum",e,t):this.setdata("snum",t))},clrSnum:function(){this.enableSubNumberArray?(this.setSnum(0,-1),this.setSnum(1,-1),this.setSnum(2,-1),this.setSnum(3,-1)):this.setSnum(-1)},is51cell:function(){return 51===this.ques},set51cell:function(e){this.setQues(51);for(var t=1;t<=4;t++)this.setQnumDir(t,-1);this.setAnum(-1)},remove51cell:function(e){this.setQues(0);for(var t=1;t<=4;t++)this.setQnumDir(t,-1);this.setAnum(-1)},ice:function(){return 6===this.ques},isDot:function(){return 1===this.qsub},isEmpty:function(){return this.isnull||7===this.ques},isValid:function(){return!this.isnull&&7!==this.ques},setValid:function(e){for(var t in this.setQues(e),this.setQnum(-1),this.setQans(0),this.setQsub(0),this.adjborder)this.adjborder[t].setQans(0);this.drawaround(),this.board.roommgr.rebuild()},isDeparture:function(){return!this.isnull&&!!this.base&&this.isNum()},isDestination:function(){return!this.isnull&&!!this.base&&!this.base.isnull},isLineStraight:function(){return 2===this.lcnt&&this.adjborder.top.isLine()&&this.adjborder.bottom.isLine()?1:2===this.lcnt&&this.adjborder.left.isLine()&&this.adjborder.right.isLine()?2:0},isLineCurve:function(){return 2===this.lcnt&&!this.isLineStraight()},isLPobj:{1:{11:1,12:1,14:1,15:1},2:{11:1,12:1,16:1,17:1},3:{11:1,13:1,15:1,16:1},4:{11:1,13:1,14:1,17:1}},noLPobj:{1:{1:1,4:1,5:1,13:1,16:1,17:1,21:1},2:{1:1,2:1,3:1,13:1,14:1,15:1,21:1},3:{1:1,2:1,5:1,12:1,14:1,17:1,22:1},4:{1:1,3:1,4:1,12:1,15:1,16:1,22:1}},isLP:function(e){return!!this.isLPobj[e][this.ques]},noLP:function(e){return!!this.noLPobj[e][this.ques]},countDir4Cell:function(e){for(var t=this.adjacent,i=0,n=[t.top,t.bottom,t.left,t.right],s=0;s<4;s++)"cell"===n[s].group&&!n[s].isnull&&e(n[s])&&i++;return i},getdir4clist:function(){for(var e=this.adjacent,t=[],i=[e.top,e.bottom,e.left,e.right],n=0;n<4;n++)"cell"!==i[n].group||i[n].isnull||t.push([i[n],n+1]);return t},getdir4cblist:function(){for(var e=this.adjacent,t=this.adjborder,i=[],n=[e.top,e.bottom,e.left,e.right],s=[t.top,t.bottom,t.left,t.right],o=0;o<4;o++)("cell"!==n[o].group||n[o].isnull)&&s[o].isnull||i.push([n[o],s[o],o+1]);return i},getdir8clist:function(){for(var e=[],t=[this.relcell(-2,-2),this.relcell(0,-2),this.relcell(2,-2),this.relcell(-2,0),this.relcell(2,0),this.relcell(-2,2),this.relcell(0,2),this.relcell(2,2)],i=0;i<8;i++)"cell"!==t[i].group||t[i].isnull||e.push([t[i],i+1]);return e},getdiagclist:function(){for(var e=[],t=[this.relcell(-2,-2),this.relcell(2,-2),this.relcell(-2,2),this.relcell(2,2)],i=0;i<4;i++)"cell"!==t[i].group||t[i].isnull||e.push([t[i],i+1]);return e},getOrthogonalCell:function(e){return this.bx===e.bx?this.by===e.by?this.board.emptycell:this.by>e.by?this.adjacent.top:this.adjacent.bottom:this.by===e.by?this.bx>e.bx?this.adjacent.left:this.adjacent.right:this.board.emptycell},eraseMovedLines:function(){if(null!==this.path){for(var e=this.path.clist,t=0,i=0,n=e.length;i<n;i++)for(var s=i+1;s<n;s++){var o=e[i].getnb(e[s]);o.isnull||(o.removeLine(),t++)}0<t&&e.draw()}}},"Cross:BoardPiece":{group:"cross",lcnt:0,adjborder:{},getNum:function(){return this.qnum},setNum:function(e){e=-2===e&&this.qnum===e?-1:e,this.setQnum(e)},noNum:function(){return!this.isnull&&-1===this.qnum}},"Border:BoardPiece":{initialize:function(){this.sidecell=[null,null],this.sidecross=[null,null],this.sideobj=[]},group:"border",isvert:!1,inside:!1,path:null,enableLineNG:!1,initSideObject:function(){var e=2===this.board.hasborder&&2===this.board.hasexcell;this.isvert?(this.sidecell[0]=!e||0<this.bx?this.relcell(-1,0):this.relexcell(-1,0),this.sidecell[1]=!e||this.bx<2*this.board.cols?this.relcell(1,0):this.relexcell(1,0),this.sidecross[0]=this.relcross(0,-1),this.sidecross[1]=this.relcross(0,1)):(this.sidecell[0]=!e||0<this.by?this.relcell(0,-1):this.relexcell(0,-1),this.sidecell[1]=!e||this.by<2*this.board.rows?this.relcell(0,1):this.relexcell(0,1),this.sidecross[0]=this.relcross(-1,0),this.sidecross[1]=this.relcross(1,0)),this.sideobj=this.board.borderAsLine?this.sidecross:this.sidecell},prehook:{qans:function(e){return 0!==this.ques},line:function(e){return this.checkStableLine(e)}},posthook:{},draw:function(){this.puzzle.painter.paintRange(this.bx-2,this.by-2,this.bx+2,this.by+2)},isLine:function(){return 0<this.line},setLine:function(e){this.setLineVal(1),2===this.qsub&&this.setQsub(0)},setPeke:function(e){this.setLineVal(0),this.setQsub(2)},removeLine:function(e){this.setLineVal(0),2===this.qsub&&this.setQsub(0)},removeLineAndQsub:function(e){this.setLineVal(0),this.setQsub(0)},isBorder:function(){return 0<this.ques||0<this.qans},setBorder:function(){this.puzzle.editmode?(this.setQues(1),this.setQans(0)):1!==this.ques&&this.setQans(1)},removeBorder:function(){this.puzzle.editmode?(this.setQues(0),this.setQans(0)):1!==this.ques&&this.setQans(0)},isVert:function(){return this.isvert},isHorz:function(){return!this.isvert},checkStableLine:function(e){return!!this.enableLineNG&&(0!==e&&this.isLineNG())},checkFormCurve:function(e){if(0===e)return!1;for(var t=0;t<=1;t++){if(this.isVert()&&(this.sidecell[t].adjborder.top.isLine()||this.sidecell[t].adjborder.bottom.isLine()))return!0;if(!this.isVert()&&(this.sidecell[t].adjborder.left.isLine()||this.sidecell[t].adjborder.right.isLine()))return!0}return!1},isLineEX:function(){return!1},isLineNG:function(){var e=this.sidecell[0],t=this.sidecell[1];return this.isVert()?e.noLP(e.RT)||t.noLP(t.LT):e.noLP(e.DN)||t.noLP(t.UP)}},"ExCell:BoardPiece":{group:"excell",adjacent:{},getNum:function(){return this.qnum},setNum:function(e){this.setQnum(e)},noNum:function(){return!this.isnull&&-1===this.qnum},is51cell:function(){return 51===this.ques},ice:function(){return!1}}}),p.classmgr.makeCommon({PieceList:{initialize:function(e){e&&this.extend(e)},length:0,add:Array.prototype.push,extend:function(e){var t=(e=e instanceof Set?Array.from(e):e).length,i=this.length;this.length+=t;for(var n=0;n<t;n++)this[i+n]=e[n]},pop:Array.prototype.pop,each:Array.prototype.forEach,some:Array.prototype.some,filter:function(e){for(var t=new this.constructor,i=this.length,n=0,s=0;s<i;s++)e(this[s])&&(t[n]=this[s],n++);return t.length=n,t},notnull:function(e){return this.filter(function(e){return!e.isnull})},map:function(e){for(var t=new this.constructor,i=t.length=this.length,n=0;n<i;n++)t[n]=e(this[n]);return t},indexOf:Array.prototype.indexOf,include:function(e){return 0<=this.indexOf(e)},remove:function(e){e=this.indexOf(e);0<=e&&Array.prototype.splice.call(this,e,1)},seterr:function(e){if(this.board.isenableSetError())for(var t=0;t<this.length;t++)this[t].error=e},setnoerr:function(){if(this.board.isenableSetError())for(var e=0;e<this.length;e++)0===this[e].error&&(this[e].error=-1)},setinfo:function(e){for(var t=0;t<this.length;t++)this[t].qinfo=e},allclear:function(e){this.propclear(["ques","ans","sub","info"],e)},ansclear:function(){this.propclear(["ans","sub","info"],!0)},subclear:function(){this.propclear(["sub","info"],!0)},errclear:function(){this.propclear(["info"],!1)},trialclear:function(){this.propclear(["trial"],!1)},propclear:function(e,t){var i=[],n={};0<this.length&&(i=this[0].getproplist(e),n=this[0].propnorec);for(var s=0;s<this.length;s++)for(var o=this[s],r=0;r<i.length;r++){var a,h=i[r],l="";4<h.length&&"snum"===h.substr(0,4)?(l=h.charAt(4),h=h.substr(0,4),a=o.constructor.prototype[h],o[h][l]!==a&&(t&&!n[h]&&o.addOpe(h+l,o[h][l],a),o[h][l]=a)):(a=o.constructor.prototype[h],("qnums"===h?this.puzzle.pzpr.util.sameArray(o[h],a):o[h]===a)||(t&&!n[h]&&o.addOpe(h,o[h],a),o[h]=a))}}},"CellList:PieceList":{getRectSize:function(){for(var e=this.board,t={x1:e.maxbx+1,x2:e.minbx-1,y1:e.maxby+1,y2:e.minby-1,cols:0,rows:0,cnt:0},i=0;i<this.length;i++){var n=this[i];t.x1>n.bx&&(t.x1=n.bx),t.x2<n.bx&&(t.x2=n.bx),t.y1>n.by&&(t.y1=n.by),t.y2<n.by&&(t.y2=n.by),t.cnt++}return t.cols=(t.x2-t.x1+2)/2,t.rows=(t.y2-t.y1+2)/2,t},singleQnumCell:!1,getQnumCell:function(){for(var e=null,t=0,i=this.length;t<i;t++)if(this[t].isNum()){if(this.singleQnumCell){if(e)return this.board.emptycell}else if(-2!==this[t].qnum)return this[t];e=this[t]}return e||this.board.emptycell},getTopCell:function(){for(var e=this.board,t=null,i=e.maxbx,n=e.maxby,s=0;s<this.length;s++){var o=this[s];o.bx>i||o.bx===i&&o.by>=n||(t=this[s],i=o.bx,n=o.by)}return t},eraseLines:function(){for(var e=0,t=0,i=this.length;t<i;t++)for(var n=t+1;n<i;n++){var s=this.puzzle.mouse.getnb(this[t].getaddr(),this[n].getaddr());s.isnull||(s.removeLine(),e++)}0<e&&this.draw()},draw:function(){var e=this.getRectSize();this.puzzle.painter.paintRange(e.x1-1,e.y1-1,e.x2+1,e.y2+1)},getBlockShapes:function(){if(this.shape)return this.shape;for(var e=this.board,t=this.getRectSize(),i=t.x2-t.x1==t.cols-1?1:2,n=t.y2-t.y1==t.rows-1?1:2,s=[[],[],[],[],[],[],[],[]],o=[],r=0;r<=t.y2-t.y1;r+=n)for(var a=0;a<=t.x2-t.x1;a+=i)s[0].push(this.include(e.getc(t.x1+a,t.y1+r))?1:0),s[1].push(this.include(e.getc(t.x1+a,t.y2-r))?1:0);for(a=0;a<=t.x2-t.x1;a+=i)for(r=0;r<=t.y2-t.y1;r+=n)s[4].push(this.include(e.getc(t.x1+a,t.y1+r))?1:0),s[5].push(this.include(e.getc(t.x1+a,t.y2-r))?1:0);s[2]=s[1].concat().reverse(),s[3]=s[0].concat().reverse(),s[6]=s[5].concat().reverse(),s[7]=s[4].concat().reverse();for(var h=0;h<8;h++)o[h]=(h<4?t.cols:t.rows)+":"+s[h].join("");var l=o[0];return o.sort(),this.shape={canon:o[0],id:l}}},"CrossList:PieceList":{},"BorderList:PieceList":{cellinside:function(){for(var e=new this.klass.CellList,t=[],i=0;i<this.length;i++){var n=this[i],s=n.sidecell[0],n=n.sidecell[1];s.isnull||!0===t[s.id]||(e.add(s),t[s.id]=!0),n.isnull||!0===t[n.id]||(e.add(n),t[n.id]=!0)}return e},crossinside:function(){for(var e=new this.klass.CrossList,t=[],i=0;i<this.length;i++){var n=this[i],s=n.sidecross[0],n=n.sidecross[1];s.isnull||!0===t[s.id]||(e.add(s),t[s.id]=!0),n.isnull||!0===t[n.id]||(e.add(n),t[n.id]=!0)}return e}},"ExCellList:PieceList":{}}),p.classmgr.makeCommon({Board:{initialize:function(){var e=this.klass;this.minbx=0,this.minby=0,this.maxbx=0,this.maxby=0,this.diserror=0,this.haserror=!1,this.hasinfo=!1,this.cell=new e.CellList,this.cross=new e.CrossList,this.border=new e.BorderList,this.excell=new e.ExCellList,this.nullobj=new e.BoardPiece,this.emptycell=new e.Cell,this.emptycross=new e.Cross,this.emptyborder=new e.Border,this.emptyexcell=new e.ExCell;try{Object.freeze(this.nullobj),Object.freeze(this.emptycell),Object.freeze(this.emptycross),Object.freeze(this.emptyborder),Object.freeze(this.emptyexcell)}catch(e){}this.createExtraObject(),this.disrecinfo=0,this.infolist=[],this.linegraph=this.addInfoList(e.LineGraph),this.roommgr=this.addInfoList(e.AreaRoomGraph),this.sblkmgr=this.addInfoList(e.AreaShadeGraph),this.ublkmgr=this.addInfoList(e.AreaUnshadeGraph),this.nblkmgr=this.addInfoList(e.AreaNumberGraph),e.Bank.prototype.enabled&&(this.bank=new e.Bank,this.bank.init(),this.bank.initialize(this.bank.defaultPreset())),this.addExtraInfo(),this.exec=new e.BoardExec,this.exec.insex.cross=1===this.hascross?{2:!0}:{0:!0},this.trialstage=0},addInfoList:function(e){e=new e;return e.enabled&&this.infolist.push(e),e},addExtraInfo:function(){},cols:10,rows:10,hascross:2,hasborder:0,hasexcell:0,hasflush:0,borderAsLine:!1,disable_subclear:!1,excellRows:function(e,t){return 1},excellCols:function(e,t){return 1},initBoardSize:function(e,t){void 0!==e&&!isNaN(e)||(e=this.cols,t=this.rows),this.allclear(!1),this.initGroup("cell",e,t),this.initGroup("cross",e,t),this.initGroup("border",e,t),this.initGroup("excell",e,t),this.cols=e,this.rows=t,this.setminmax(),this.setposAll(),this.hasdots&&this.initDots(this.cols,this.rows,2===this.hasdots),this.initExtraObject(e,t),this.bank&&(this.bank.width=this.cols/this.puzzle.painter.bankratio,this.bank.performLayout()),this.rebuildInfo(),this.puzzle.cursor.initCursor(),this.puzzle.opemgr.allerase()},createExtraObject:function(){},initExtraObject:function(e,t){},getBankPiecesInGrid:function(){return[]},initGroup:function(e,t,i){var n=this.getGroup(e),s=this.estimateSize(e,t,i),t=n.length;if(s<t)for(var o=t-1;s<=o;o--)n.pop();else if(t<s){for(var r=new n.constructor,o=t;o<s;o++){var a=this.newObject(e,o);n.add(a),r.add(a)}r.allclear(!1)}return(n.length=s)-t},getGroup:function(e){return"cell"===e?this.cell:"cross"===e?this.cross:"border"===e?this.border:"excell"===e?this.excell:new this.klass.PieceList},estimateSize:function(e,t,i){if("cell"===e)return t*i;if("cross"===e)return(t+1)*(i+1);if("border"===e){if(1===this.hasborder)return 2*t*i-(t+i);if(2===this.hasborder)return 2*t*i+(t+i)}else if("excell"===e){var n;if(1===this.hasexcell)return e=this.excellRows(t,i),n=this.excellCols(t,i),(t*=e)+(i*=n)+(51===this.emptyexcell.ques?1:0);if(2===this.hasexcell)return 2*(t+i)}return 0},newObject:function(e,t){var i=this.nullobj,n=this.klass;return"cell"===e?i=new n.Cell:"cross"===e?i=new n.Cross:"border"===e?i=new n.Border:"excell"===e&&(i=new n.ExCell),i!==this.nullobj&&void 0!==t&&(i.id=t),i},setposAll:function(){this.setposCells(),this.setposCrosses(),this.setposBorders(),this.setposExCells()},setposGroup:function(e){"cell"===e?this.setposCells():"cross"===e?this.setposCrosses():"border"===e?this.setposBorders():"excell"===e&&this.setposExCells()},setposCells:function(){for(var e=this.cols,t=0;t<this.cell.length;t++){var i=this.cell[t];i.id=t,i.isnull=!1,i.bx=t%e*2+1,i.by=1+(t/e<<1),i.initAdjacent(),i.initAdjBorder()}},setposCrosses:function(){for(var e=this.cols,t=0;t<this.cross.length;t++){var i=this.cross[t];i.id=t,i.isnull=!1,i.bx=t%(e+1)*2,i.by=t/(e+1)<<1,i.initAdjBorder()}},setposBorders:function(){for(var e=this.cols,t=this.rows,i=2*e*t-e-t,n=0;n<this.border.length;n++){var s=this.border[n],o=n;s.id=n,s.isnull=!1,0<=o&&o<(e-1)*t&&(s.bx=o%(e-1)*2+2,s.by=1+(o/(e-1)<<1)),0<=(o-=(e-1)*t)&&o<e*(t-1)&&(s.bx=o%e*2+1,s.by=2+(o/e<<1)),o-=e*(t-1),2===this.hasborder&&(0<=o&&o<e&&(s.bx=2*o+1,s.by=0),0<=(o-=e)&&o<e&&(s.bx=2*o+1,s.by=2*t),0<=(o-=e)&&o<t&&(s.bx=0,s.by=2*o+1),0<=(o-=t)&&o<t&&(s.bx=2*e,s.by=2*o+1),o-=t),s.isvert=!(1&s.bx),s.inside=n<i,s.initSideObject()}},setposExCells:function(){for(var e=this.excellRows(this.cols,this.rows),t=this.excellCols(this.cols,this.rows),i=this.cols*e,n=this.rows*t,s=0;s<this.excell.length;s++){var o=this.excell[s],r=s;o.id=s,o.isnull=!1,1===this.hasexcell?(0<=r&&r<i&&(o.bx=2*(r/e|0)+1,o.by=r%e*-2-1),0<=(r-=i)&&r<n&&(o.bx=r%t*-2-1,o.by=2*(r/t|0)+1),0===(r-=n)&&51===o.ques&&(o.bx=-1,o.by=-1),r--):2===this.hasexcell&&(0<=r&&r<i&&(o.bx=2*r+1,o.by=-1),0<=(r-=i)&&r<i&&(o.bx=2*r+1,o.by=2*n+1),0<=(r-=i)&&r<n&&(o.bx=-1,o.by=2*r+1),0<=(r-=n)&&r<n&&(o.bx=2*i+1,o.by=2*r+1),r-=n),o.initAdjacent()}},setminmax:function(){var e=0<this.hasexcell,t=2===this.hasexcell;this.minbx=e?-2*this.excellCols(this.cols,this.rows):0,this.minby=e?-2*this.excellRows(this.cols,this.rows):0,this.maxbx=t?2*this.cols+2:2*this.cols,this.maxby=t?2*this.rows+2:2*this.rows,this.puzzle.cursor.setminmax()},allclear:function(e){this.cell.allclear(e),this.cross.allclear(e),this.border.allclear(e),this.excell.allclear(e),e&&this.puzzle.opemgr.rejectTrial(!0)},ansclear:function(){var e=this.puzzle.opemgr;e.rejectTrial(!0),e.newOperation(),e.add(new this.puzzle.klass.BoardClearOperation),this.cell.ansclear(),this.cross.ansclear(),this.border.ansclear(),this.excell.ansclear(),this.bank&&this.bank.ansclear(),this.rebuildInfo()},subclear:function(){this.puzzle.opemgr.newOperation(),this.cell.subclear(),this.cross.subclear(),this.border.subclear(),this.excell.subclear(),this.bank&&this.bank.subclear(),this.rebuildInfo()},errclear:function(){var e=this.haserror||this.hasinfo;return e&&(this.cell.errclear(),this.cross.errclear(),this.border.errclear(),this.excell.errclear(),this.bank&&this.bank.errclear(),this.haserror=!1,this.hasinfo=!1),e},trialclear:function(e){(0<this.trialstage||e)&&(this.cell.trialclear(),this.cross.trialclear(),this.border.trialclear(),this.excell.trialclear(),this.puzzle.redraw(),this.trialstage=0)},getObjectPos:function(e,t,i){var n=this.nullobj;return"cell"===e?n=this.getc(t,i):"cross"===e?n=this.getx(t,i):"border"===e?n=this.getb(t,i):"excell"===e?n=this.getex(t,i):"obj"===e&&(n=this.getobj(t,i)),n},getc:function(e,t){var i=null,n=this.cols,s=this.rows;return null!==(i=!(e<0||n<<1<e||t<0||s<<1<t)&&1&e&&1&t?(e>>1)+(t>>1)*n:i)?this.cell[i]:this.emptycell},getx:function(e,t){var i=null,n=this.cols,s=this.rows;return e<0||n<<1<e||t<0||s<<1<t||1&e||1&t||(i=(e>>1)+(t>>1)*(n+1)),0!==this.hascross&&null!==i?this.cross[i]:this.emptycross},getb:function(e,t){var i=null,n=this.cols,s=this.rows;return this.hasborder&&1<=e&&e<=2*n-1&&1<=t&&t<=2*s-1?!(1&e)&&1&t?i=(e>>1)-1+(t>>1)*(n-1):1&e&&!(1&t)&&(i=(e>>1)+((t>>1)-1)*n+(n-1)*s):2===this.hasborder&&(0===t&&1&e&&1<=e&&e<=2*n-1?i=(n-1)*s+n*(s-1)+(e>>1):t===2*s&&1&e&&1<=e&&e<=2*n-1?i=(n-1)*s+n*(s-1)+n+(e>>1):0===e&&1&t&&1<=t&&t<=2*s-1?i=(n-1)*s+n*(s-1)+2*n+(t>>1):e===2*n&&1&t&&1<=t&&t<=2*s-1&&(i=(n-1)*s+n*(s-1)+2*n+s+(t>>1))),null!==i?this.border[i]:this.emptyborder},getex:function(e,t){var i=this.excellRows(this.cols,this.rows),n=this.excellCols(this.cols,this.rows),s=null,o=this.cols*i,r=this.rows*n;return 1===this.hasexcell?51===this.emptyexcell.ques&&-1===e&&-1===t?s=o+r:t>=this.minby&&t<0&&0<e&&e<2*o?s=(-t>>1)+(e>>1)*i:e>=this.minbx&&e<0&&0<t&&t<2*r&&(s=(-e>>1)+o+(t>>1)*n):2===this.hasexcell&&(-1===t&&0<e&&e<2*o?s=e>>1:t===2*r+1&&0<e&&e<2*o?s=o+(e>>1):-1===e&&0<t&&t<2*r?s=2*o+(t>>1):e===2*o+1&&0<t&&t<2*r&&(s=2*o+r+(t>>1))),null!==s?this.excell[s]:this.emptyexcell},getobj:function(e,t){if(e+t&1)return this.getb(e,t);if(!(1&e||1&t))return this.getx(e,t);var i=this.getc(e,t);return i===this.emptycell&&this.hasexcell?this.getex(e,t):i},operate:function(e){if(0<this.trialstage&&this.exec.isBoardOp(e))throw Error("board operations are not possible in trial mode");this.exec.execadjust(e)},flushexcell:function(){this.puzzle.opemgr.newOperation();var e=this.cols,t=this.rows,i=this.excell;this.genericFlush(this.excellCols(e,t),this.excellRows(e,t),e,t,function(e){return i[e].qnum},function(e,t){i[e].setQcmp(0),i[e].setQnum(t)}),this.puzzle.redraw()},genericFlush:function(e,t,i,n,s,o){for(var r=i*t,a=n*e,h=0,l=0;l<r+a;l++)if(-1!==s(l)&&(l!==h-1&&o(h,s(l)),h++),l<r&&l%t==t-1||r<=l&&(l-r)%e==e-1){for(var c=h;c<=l;c++)o(c,-1);h=l+1}},objectinside:function(e,t,i,n,s){return"cell"===e?this.cellinside(t,i,n,s):"cross"===e?this.crossinside(t,i,n,s):"border"===e?this.borderinside(t,i,n,s):"excell"===e?this.excellinside(t,i,n,s):new this.klass.PieceList},cellinside:function(e,t,i,n){for(var s=new this.klass.CellList,o=1|t;o<=n;o+=2)for(var r=1|e;r<=i;r+=2){var a=this.getc(r,o);a.isnull||s.add(a)}return s},crossinside:function(e,t,i,n){var s=new this.klass.CrossList;if(this.hascross)for(var o=t+(1&t);o<=n;o+=2)for(var r=e+(1&e);r<=i;r+=2){var a=this.getx(r,o);a.isnull||s.add(a)}return s},borderinside:function(e,t,i,n){var s=new this.klass.BorderList;if(this.hasborder)for(var o=t;o<=n;o++)for(var r=e+(e+o&1^1);r<=i;r+=2){var a=this.getb(r,o);a.isnull||s.add(a)}return s},excellinside:function(e,t,i,n){var s=new this.klass.ExCellList;if(this.hasexcell)for(var o=1|t;o<=n;o+=2)for(var r=1|e;r<=i;r+=2){var a=this.getex(r,o);a&&!a.isnull&&s.add(a)}return s},disableInfo:function(){this.puzzle.opemgr.disableRecord(),this.disrecinfo++},enableInfo:function(){this.puzzle.opemgr.enableRecord(),0<this.disrecinfo&&this.disrecinfo--},isenableInfo:function(){return 0===this.disrecinfo},rebuildInfo:function(){this.bank&&this.bank.rebuildExtraData(),this.infolist.forEach(function(e){e.rebuild()})},modifyInfo:function(e,t){if(this.isenableInfo())for(var i=0;i<this.infolist.length;++i){var n=this.infolist[i];n.relation[t]&&n.modifyInfo(e,t)}},irowakeRemake:function(){for(var e=0;e<this.infolist.length;++e){var t=this.infolist[e];t.coloring&&t.newIrowake()}},disableSetError:function(){this.diserror++},enableSetError:function(){this.diserror--},isenableSetError:function(){return this.diserror<=0},freezecopy:function(){var e,t={cell:[],cross:[],border:[],excell:[]};for(e in t)for(var i=0;i<this[e].length;i++)t[e][i]=this[e][i].getprops();return t},compareData:function(e,t){for(var i in e)if(this[i])for(var n=0;n<e[i].length;n++)this[i][n]&&this[i][n].compare(e[i][n],t)},dotsmax:0,dots:[],initDots:function(e,t,i){var n=2*e+(i?1:-1);this.dotsmax=n*(2*t+(i?1:-1)),this.dots=[];for(var s=0;s<this.dotsmax;s++){this.dots[s]=new this.klass.Dot;var o=this.dots[s];o.id=s,o.bx=s%n+(i?0:1),o.by=(s/n|0)+(i?0:1),o.isnull=!1,o.piece=o.getaddr().getobj()}},getDot:function(e,t){var i=this.cols,n=this.rows,s=-1;if(1===this.hasdots){if(e<=0||i<<1<=e||t<=0||n<<1<=t)return null;s=e-1+(t-1)*(2*i-1)}if(2===this.hasdots){if(e<0||i<<1<e||t<0||n<<1<t)return null;s=e+t*(2*i+1)}if(-1===s)return null;n=this.dots[s];return n.isnull?null:n},dotinside:function(e,t,i,n){for(var s=new this.klass.PieceList,o=t;o<=n;o++)for(var r=e;r<=i;r++){var a=this.getDot(r,o);a&&s.add(a)}return s}}}),m=128,p.classmgr.makeCommon({BoardExec:{UP:1,DN:2,LT:3,RT:4,EXPAND:16,REDUCE:32,TURN:64,FLIP:m,TURNFLIP:192,EXPANDUP:17,EXPANDDN:18,EXPANDLT:19,EXPANDRT:20,REDUCEUP:33,REDUCEDN:34,REDUCELT:35,REDUCERT:36,TURNL:65,TURNR:66,FLIPX:129,FLIPY:130,ALLOWALL:195,allowedOperations:function(e){return this.ALLOWALL},boardtype:{expandup:[33,17],expanddn:[34,18],expandlt:[35,19],expandrt:[36,20],reduceup:[17,33],reducedn:[18,34],reducelt:[19,35],reducert:[20,36],turnl:[66,65],turnr:[65,66],flipy:[130,130],flipx:[129,129]},qnumw:[],qnumh:[],insex:{cell:{1:!0},cross:{},border:{1:!0,2:!0},excell:{1:!0}},isBoardOp:function(e){return!!this.boardtype[e]},adjustSize:function(){var e=this.board;return{x1:0,y1:0,x2:2*e.cols,y2:2*e.rows}},execadjust:function(e){if(this.isBoardOp(e)){var t=this.puzzle,i=this.board;if(0===e.indexOf("reduce"))if("reduceup"===e||"reducedn"===e){if(i.rows<=1)return}else if(("reducelt"===e||"reducert"===e)&&i.cols<=1)return;t.opemgr.newOperation(),t.painter.suspendAll();var n=this.adjustSize();this.execadjust_main(this.boardtype[e][1],n),this.addOpe(n,e),i.setminmax(),i.rebuildInfo(),t.painter.resizeCanvas(),t.emit("adjust"),t.painter.unsuspend()}},execadjust_main:function(t,i){var e,n=this.board;this.adjustBoardData(t,i),n.roommgr.hastop&&32&t&&this.reduceRoomNumber(t,i),64&t?(e=n.cols,n.cols=n.rows,n.rows=e,i={x1:0,y1:0,x2:i.y2,y2:i.x2}):16&t&&(t===this.EXPANDUP||t===this.EXPANDDN?n.rows++:t!==this.EXPANDLT&&t!==this.EXPANDRT||n.cols++),["cell","cross","border","excell"].forEach(function(e){16&t?n.exec.expandGroup(e,t):32&t?n.exec.reduceGroup(e,t):n.exec.turnflipGroup(e,t,i)}),32&t&&(t===this.REDUCEUP||t===this.REDUCEDN?n.rows--:t!==this.REDUCELT&&t!==this.REDUCERT||n.cols--),n.setminmax(),n.setposAll(),n.hasdots&&n.initDots(n.cols,n.rows,2===n.hasdots),n.bank&&(n.bank.width=n.cols/this.puzzle.painter.bankratio,n.bank.performLayout()),this.adjustBoardData2(t,i)},addOpe:function(e,t){var i=this.boardtype[t][1],n=this.puzzle,i=i&this.TURNFLIP?new n.klass.BoardFlipOperation(e,t):new n.klass.BoardAdjustOperation(t);n.opemgr.add(i)},expandGroup:function(e,t){var i=this.board,n=i.initGroup(e,i.cols,i.rows),s=i.getGroup(e),o=new s.constructor;i.setposGroup(e);for(var r=s.length-1;0<=r;r--){var a=s[r];this.isdel(t,a)?(a=i.newObject(e,r),s[r]=a,o.add(a),n--):0<n&&(s[r]=s[r-n])}o.allclear(!1),"border"===e&&this.expandborder(t)},reduceGroup:function(e,t){for(var i=this.board,n=("border"===e&&this.reduceborder(t),0),s=i.getGroup(e),o=new s.constructor,r=0;r<s.length;r++){var a=s[r];this.isdel(t,a)?(a.id=r,o.add(a),n++):0<n&&(s[r-n]=s[r])}i=this.puzzle.opemgr;i.undoExec||i.redoExec||(i.forceRecord=!0,o.allclear(!0),i.forceRecord=!1);for(r=0;r<n;r++)s.pop()},isdel:function(e,t){if("excell"===t.group&&e&(this.EXPAND|this.REDUCE)){var i=this.board,n=i.cols,s=i.rows,o=((7&e)===this.UP||(7&e)===this.DN?s--:n--,i.excellCols(n,s)),i=i.excellRows(n,s);if(t.bx<-2*o+1||t.by<-2*i+1)return!0}return!!this.insex[t.group][this.distObj(e,t)]},turnflipGroup:function(e,t,i){for(var n,s=this.board,o=("excell"===e&&(1===s.hasexcell&&t&this.FLIP?(n={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},t===this.FLIPY?(n.x1=-2*s.excellCols(s.cols,s.rows)+1,n.x2=-1):t===this.FLIPX&&(n.y1=-2*s.excellRows(s.cols,s.rows)+1,n.y2=-1),i=n):2===s.hasexcell&&(i={x1:-1,y1:-1,x2:i.x2+1,y2:i.y2+1})),s.objectinside(e,i.x1,i.y1,i.x2,i.y2)),r={},a=i.x1+i.x2,h=i.y1+i.y2,l=0;l<o.length;l++){var c=o[l],u=null;switch(t){case this.FLIPY:u=s.getObjectPos(e,c.bx,h-c.by).id;break;case this.FLIPX:u=s.getObjectPos(e,a-c.bx,c.by).id;break;case this.TURNL:u=s.getObjectPos(e,c.by,h-c.bx).id;break;case this.TURNR:u=s.getObjectPos(e,a-c.by,c.bx).id}r[u]=c}var d,b=s.getGroup(e);for(d in r)b[+d]=r[d]},distObj:function(e,t){var i=this.board;return t.isnull?-1:(e&=15)===this.UP?t.by:e===this.DN?2*i.rows-t.by:e===this.LT?t.bx:e===this.RT?2*i.cols-t.bx:-1},expandborder:function(e){var t=this.board,i=t.borderAsLine;if(i||!t.puzzle.opemgr.undoExec){for(var n=new this.klass.BorderList,s=(t.setposBorders(),i?2:1),o=0;o<t.border.length;o++){var r,a=t.border[o];this.distObj(e,a)===s&&(r=i?this.outerBorder(o,e):this.innerBorder(o,e),this.copyBorder(a,r),n.add(r))}i&&n.allclear(!1)}},reduceborder:function(e){var t=this.board;if(t.borderAsLine)for(var i=0;i<t.border.length;i++){var n,s=t.border[i];0===this.distObj(e,s)&&(n=this.innerBorder(i,e),this.copyBorder(s,n))}},copyBorder:function(e,t){e.ques=t.ques,e.qans=t.qans,this.board.borderAsLine&&(e.line=t.line,e.qsub=t.qsub)},innerBorder:function(e,t){e=this.board.border[e];return(t&=15)===this.UP?e.relbd(0,2):t===this.DN?e.relbd(0,-2):t===this.LT?e.relbd(2,0):t===this.RT?e.relbd(-2,0):null},outerBorder:function(e,t){e=this.board.border[e];return(t&=15)===this.UP?e.relbd(0,-2):t===this.DN?e.relbd(0,2):t===this.LT?e.relbd(-2,0):t===this.RT?e.relbd(2,0):null},reduceRoomNumber:function(e,t){for(var i=[],n=this.board,s=0;s<n.cell.length;s++){var o=n.cell[s];this.insex.cell[this.distObj(e,o)]&&(-1!==o.qnum&&(i.push({cell:o,area:o.room,pos:[o.bx,o.by],val:o.qnum}),o.qnum=-1),o.room.clist.remove(o))}for(var r=0;r<i.length;r++){var a,h=i[r],l=h.area.clist.getTopCell();l.isnull?(a=this.puzzle.opemgr).undoExec||a.redoExec||(a.forceRecord=!0,h.cell.addOpe("qnum",h.val,-1),a.forceRecord=!1):l.qnum=h.val}},adjustBoardData:function(e,t){},adjustBoardData2:function(e,t){}}}),p.classmgr.makeCommon({GraphBase:{enabled:!1,relation:{},pointgroup:"",linkgroup:"",coloring:!1,removeFromArray:function(e,t){t=e.indexOf(t);0<=t&&Array.prototype.splice.call(e,t,1)},setComponentRefs:function(e,t){},getObjNodeList:function(e){return[]},resetObjNodeList:function(e){},isnodevalid:function(e){return!1},isedgevalidbylinkobj:function(e){return!0},isedgevalidbynodeobj:function(e,t){return!0},isedgeexistsbylinkobj:function(e){e=this.getSideNodesBySeparator(e);return!!e&&0<=e[0].nodes.indexOf(e[1])},calcNodeCount:function(e){return this.isnodevalid(e)?1:0},rebuildmode:!1,rebuild:function(){this.enabled&&(this.rebuildmode=!0,this.components=[],this.modifyNodes=[],this.rebuild2(),this.searchGraph(),this.rebuildmode=!1)},rebuild2:function(){for(var e=this.board[this.pointgroup],t=this.board[this.linkgroup],i=0;i<e.length;i++)this.setComponentRefs(e[i],null),this.resetObjNodeList(e[i]),this.isnodevalid(e[i])&&this.createNode(e[i]);if(this.linkgroup)for(var n=0;n<t.length;n++)this.setComponentRefs(t[n],null),this.isedgevalidbylinkobj(t[n])&&this.addEdgeByLinkObj(t[n]);else for(i=0;i<e.length;i++)this.isnodevalid(e[i])&&this.setEdgeByNodeObj(e[i])},createComponent:function(){var e=new this.klass.GraphComponent;return this.components.push(e),e},deleteComponent:function(e){for(var t=0;t<e.nodes.length;t++)this.modifyNodes.push(e.nodes[t]),this.setComponentRefs(e.nodes[t].obj,null),e.nodes[t].component=null;this.removeFromArray(this.components,e)},createNode:function(e){var t=new this.klass.GraphNode(e);return this.getObjNodeList(e).push(t),this.modifyNodes.push(t),t},deleteNode:function(e){var t=e.obj,i=(this.setComponentRefs(t,null),this.removeFromArray(this.getObjNodeList(t),e),this.removeFromArray(this.modifyNodes,e),e.component);null!==i&&(this.removeFromArray(i.nodes,e),this.resetExtraData(t),0===i.nodes.length&&this.deleteComponent(i))},createNodeIfEmpty:function(e){0===this.getObjNodeList(e).length&&this.createNode(e)},deleteNodeIfEmpty:function(e){var t=this.getObjNodeList(e);0!==t[0].nodes.length||this.isnodevalid(e)||this.deleteNode(t[0])},addEdge:function(e,t){0<=e.nodes.indexOf(t)||(e.nodes.push(t),t.nodes.push(e),this.rebuildmode||(this.modifyNodes.indexOf(e)<0&&this.modifyNodes.push(e),this.modifyNodes.indexOf(t)<0&&this.modifyNodes.push(t)))},removeEdge:function(e,t){e.nodes.indexOf(t)<0||(this.removeFromArray(e.nodes,t),this.removeFromArray(t.nodes,e),this.rebuildmode||(this.modifyNodes.indexOf(e)<0&&this.modifyNodes.push(e),this.modifyNodes.indexOf(t)<0&&this.modifyNodes.push(t)))},getSideObjByLinkObj:function(e){return e.sideobj},getSideObjByNodeObj:function(e){for(var t=e.getdir4clist(),i=[],n=0;n<t.length;n++){var s=t[n][0];this.isnodevalid(s)&&i.push(s)}return i},getSideNodesByLinkObj:function(e){for(var t=[],i=this.getSideObjByLinkObj(e),n=0;n<i.length;n++){var s=i[n],s=this.getObjNodeList(s),o=s[0];s[1]&&e.isvert&&(o=s[1]),t.push(o)}return t},getSideNodesBySeparator:function(e){for(var t=[],i=e.sideobj,n=0;n<i.length;n++){var s=this.getObjNodeList(i[n]);s&&s[0]&&t.push(s[0])}return 2<=t.length?t:null},modifyInfo:function(e,t){if(this.enabled){var i=this.relation[t];if(i){switch(this.modifyNodes=[],i){case"node":this.setEdgeByNodeObj(e);break;case"link":this.setEdgeByLinkObj(e);break;case"separator":this.setEdgeBySeparator(e);break;default:this.modifyOtherInfo(e,i)}0<this.modifyNodes.length&&this.remakeComponent()}}},setEdgeBySeparator:function(e){var t=this.isedgevalidbylinkobj(e);t!==this.isedgeexistsbylinkobj(e)&&(this.incdecBorderCount&&this.incdecBorderCount(e,!t),t?this.addEdgeBySeparator(e):this.removeEdgeBySeparator(e))},addEdgeBySeparator:function(e){e=this.getSideNodesBySeparator(e);e&&this.addEdge(e[0],e[1])},removeEdgeBySeparator:function(e){var t=this.getSideNodesBySeparator(e);t&&(this.removeEdge(t[0],t[1]),this.linkgroup&&this.setComponentRefs(e,null))},attachNode:function(e,t){(e.component=t).nodes.push(e),this.setComponentInfo(t)},remakeComponent:function(){var e=this.getAffectedComponents();1===e.length&&this.checkDividedComponent(e[0]),this.modifyNodes&&0<this.modifyNodes.length&&this.remakeMaximalComponents(e)},getAffectedComponents:function(){for(var e=[],t=0;t<this.modifyNodes.length;t++){var i=this.modifyNodes[t].component;null===i||i.isremake||(e.push(i),i.isremake=!0)}return e},checkDividedComponent:function(e){for(var t=0,i=this.modifyNodes.length;t<i;t++)(s=this.modifyNodes[t]).component=null,this.setComponentRefs(s.obj,null),this.removeFromArray(e.nodes,s);var n=new this.klass.GraphComponent;if(this.searchSingle(this.modifyNodes[0],n),n.nodes.length===this.modifyNodes.length){for(var s,t=0;t<this.modifyNodes.length;t++)((s=this.modifyNodes[t]).component=e).nodes.push(s);this.modifyNodes=[],this.setComponentInfo(e),e.isremake=!1}},remakeMaximalComponents:function(e){for(var t=this.coloring?this.getLongColor(e):null,i=0;i<e.length;i++)this.deleteComponent(e[i]);var n=this.searchGraph();this.coloring&&this.setLongColor(n,t)},searchGraph:function(){for(var e=this.modifyNodes,t=[],i=0,n=e.length;i<n;i++)e[i].component=null;for(var s,i=0,n=e.length;i<n;i++)null===e[i].component&&(s=this.createComponent(),this.searchSingle(e[i],s),this.setComponentInfoExtra(s,!1),t.push(s));this.modifyNodes=[];for(i=0;i<t.length;i++)this.setExtraData(t[i]);return t},searchSingle:function(e,t){for(var i=[e];0<i.length;){var n=i.pop();if(null===n.component){(n.component=t).nodes.push(n);for(var s=0;s<n.nodes.length;s++)i.push(n.nodes[s])}}},setComponentInfo:function(e){this.setComponentInfoExtra(e,!0)},setComponentInfoExtra:function(e,t){for(var i=0,n=0;n<e.nodes.length;n++){var s=e.nodes[n];i+=s.nodes.length,this.setComponentRefs(s.obj,e)}e.circuits=(i>>1)-e.nodes.length+1,t&&this.setExtraData(e)},resetExtraData:function(e){},setExtraData:function(e){},getLargeComponent:function(e){if(0===e.length)return null;for(var t=e[0],i=t.isTrial(),n=1;n<e.length;n++){var s=e[n],o=s.isTrial();o===i?t.nodes.length<s.nodes.length&&(t=s,i=o):o||(t=s,i=o)}return t},getLongColor:function(e){e=this.getLargeComponent(e);return e?e.color:null},setLongColor:function(e,t){var i,n;0!==e.length&&t&&(i=this.puzzle,(n=this.getLargeComponent(e))&&(n.color=t),this.coloring&&(i.execConfig("irowake")||i.execConfig("irowakeblk"))&&this.repaintNodes(e))},repaintNodes:function(e){},newIrowake:function(){for(var e=this.components,t=e.length,i=360*Math.random(),n=360/t,s=60+40*this.puzzle.painter.maxYdeg,o=60+40*this.puzzle.painter.minYdeg,r=0;r<t;r++){var a=(i+r*n)%360,h=r%3*(s-o)/2+o,l=52*Math.random()+75,c=Math.sin(a*Math.PI/180)*l,a=Math.cos(a*Math.PI/180)*l;e[r].color=this.puzzle.painter.labToRgbStr(h,c,a)}for(r=t-1;0<r;r--){var u=Math.floor(Math.random()*(r+1)),d=e[r].color;e[r].color=e[u].color,e[u].color=d}}},GraphComponent:{initialize:function(){this.nodes=[],this.color="",this.circuits=-1},getLinkObjByNodes:function(e,t){var i=e.obj.bx,e=e.obj.by,n=t.obj.bx,t=t.obj.by;return n<i||i===n&&t<e?null:this.board.getobj(i+n>>1,e+t>>1)},getnodeobjs:function(){for(var e=new(this.board.getGroup(this.nodes[0].obj.group).constructor),t=0;t<this.nodes.length;t++)e.add(this.nodes[t].obj);return e},getedgeobjs:function(){for(var e=[],t=0;t<this.nodes.length;t++)for(var i=this.nodes[t],n=0;n<i.nodes.length;n++){var s=this.getLinkObjByNodes(i,i.nodes[n]);s&&e.push(s)}return e},checkAutoCmp:function(){var e=!!this.clist.checkCmp&&this.clist.checkCmp();this.cmp!==e&&(this.cmp=e,this.puzzle.execConfig("autocmp")&&this.clist.draw())},isTrial:function(){for(var e=this.getedgeobjs(),t=0;t<e.length;t++)if(!e[t].trial)return!1;return!0},setedgeerr:function(e){for(var t=this.getedgeobjs(),i=0;i<t.length;i++)t[i].seterr(e)},setedgeinfo:function(e){for(var t=this.getedgeobjs(),i=0;i<t.length;i++)t[i].setinfo(e)}},GraphNode:{initialize:function(e){this.obj=e,this.nodes=[],this.component=null}}}),p.classmgr.makeCommon({"LineGraph:GraphBase":{initialize:function(){this.moveline&&(this.relation["cell.qnum"]="move")},enabled:!1,relation:{"border.line":"link"},pointgroup:"cell",linkgroup:"border",countprop:"lcnt",isLineCross:!1,makeClist:!1,moveline:!1,coloring:!0,setComponentRefs:function(e,t){e.path=t},isedgeexistsbylinkobj:function(e){return null!==e.path},getObjNodeList:function(e){return e.pathnodes},resetObjNodeList:function(e){e.pathnodes=[],this.moveline&&this.resetExtraData(e)},isnodevalid:function(e){return 0<e[this.countprop]||this.moveline&&e.isNum()},isedgevalidbylinkobj:function(e){return e.isLine()},iscrossing:function(e){return this.isLineCross},rebuild:function(){this.board.borderAsLine&&(this.pointgroup="cross"),p.common.GraphBase.prototype.rebuild.call(this)},rebuild2:function(){this.incdecLineCount&&this.resetLineCount(),p.common.GraphBase.prototype.rebuild2.call(this)},resetLineCount:function(){var e=this.board[this.pointgroup],t=this.board[this.linkgroup];this.ltotal=[e.length];for(var i=0;i<e.length;i++)e[i][this.countprop]=0;for(var n=0;n<t.length;n++)this.isedgevalidbylinkobj(t[n])&&this.incdecLineCount(t[n],!0)},incdecLineCount:function(e,t){if(e.group===this.linkgroup)for(var i=0;i<2;i++){var n=e.sideobj[i];n.isnull||(this.ltotal[n[this.countprop]]--,t?n[this.countprop]++:n[this.countprop]--,this.ltotal[n[this.countprop]]=(this.ltotal[n[this.countprop]]||0)+1)}},setEdgeByLinkObj:function(e){var t=this.isedgevalidbylinkobj(e);t!==this.isedgeexistsbylinkobj(e)&&(this.incdecLineCount&&this.incdecLineCount(e,t),t?this.addEdgeByLinkObj(e):this.removeEdgeByLinkObj(e))},addEdgeByLinkObj:function(e){var t,i=0===this.modifyNodes.length,n=this.getSideObjByLinkObj(e),n=(this.createNodeIfEmpty(n[0]),this.createNodeIfEmpty(n[1]),this.getSideNodesByLinkObj(e));this.addEdge(n[0],n[1]),!this.rebuildmode&&i&&(e=null,i=n[0],t=n[1],1===i.obj[this.countprop]&&null===i.component&&null!==t.component?e=[n[0],n[1]]:1===t.obj[this.countprop]&&null===t.component&&null!==i.component&&(e=[n[1],n[0]]),e&&(this.attachNode(e[0],e[1].component),this.modifyNodes=[]))},removeEdgeByLinkObj:function(e){var t,i,n,s=0===this.modifyNodes.length,o=this.getSideNodesByLinkObj(e);this.removeEdge(o[0],o[1]),this.deleteNodeIfEmpty(o[0].obj),this.deleteNodeIfEmpty(o[1].obj),this.setComponentRefs(e,null),s&&(e=null,s=o[0],t=o[1],i=s.obj[this.countprop],n=t.obj[this.countprop],0===i&&(1===n||!this.isLineCross&&1<n)&&null!==t.component?e=[o[0],o[1]]:0===n&&(1===i||!this.isLineCross&&1<i)&&null!==s.component&&(e=[o[1],o[0]]),e&&(this.setComponentInfo(e[1].component),this.modifyNodes=[]))},modifyOtherInfo:function(e,t){var i=!!e.path;i!==this.isnodevalid(e)?i?this.deleteNodeIfEmpty(e):this.createNodeIfEmpty(e):i?this.setComponentInfo(e.path):this.resetExtraData(e)},createNodeIfEmpty:function(e){var t,i,n,s=this.getObjNodeList(e);0===s.length?this.createNode(e):!s[1]&&2===s[0].nodes.length&&this.iscrossing(e)&&(n=s[0].nodes,(t=[e.getvert(n[0].obj,2),e.getvert(n[1].obj,2)])[0]!==t[1]?(i=n[t[0]?0:1],n=n[t[0]?1:0],this.removeEdge(s[0],i),this.removeEdge(s[0],n),this.deleteNode(s[0]),this.createNode(e),this.createNode(e),this.addEdge(s[0],i),this.addEdge(s[1],n)):(this.createNode(e),t[0]||t[1]||s.push(s.shift())))},deleteNodeIfEmpty:function(e){var t=this.getObjNodeList(e);1!==t.length||0!==t[0].nodes.length||this.isnodevalid(e)?t[1]&&t[0].nodes.length+t[1].nodes.length===2&&this.iscrossing(e)&&(1===t[1].nodes.length?(e=t[1].nodes[0],this.removeEdge(t[1],e),this.addEdge(t[0],e)):2===t[1].nodes.length&&t.push(t.shift()),this.deleteNode(t[1])):this.deleteNode(t[0])},resetExtraData:function(e){this.moveline&&(e.base=e.isNum()?e:this.board.emptycell)},setExtraData:function(e){this.coloring&&!e.color&&(e.color=this.puzzle.painter.getNewLineColor());for(var t=e.getedgeobjs(),i=0;i<t.length;i++)this.setComponentRefs(t[i],e);(this.makeClist||this.moveline)&&(e.clist=new this.klass.CellList(e.getnodeobjs()),this.moveline&&this.setMovedBase(e))},repaintNodes:function(e){for(var t=new this.klass.BorderList,i=0;i<e.length;i++)t.extend(e[i].getedgeobjs());this.puzzle.painter.repaintLines(t)},setMovedBase:function(e){var t=this.board.emptycell,i=(e.departure=e.destination=t,e.movevalid=!1,e.clist);if(!(i.length<1)){for(var n=0;n<i.length;n++)(a=i[n]).base=a.isNum()?a:t;var s=null,o=null,r=0;if(1===i.length)s=o=i[0],r=2;else for(var a,n=0;n<i.length;n++)1===(a=i[n])[this.countprop]&&(r++,a.isNum()?s=a:o=a);null!==s&&null!==o&&2===r&&(s.base=t,e.departure=o.base=s,e.destination=o,e.movevalid=!0)}}}}),p.classmgr.makeCommon({"AreaGraphBase:GraphBase":{pointgroup:"cell",countprop:"lcnt",isedgevalidbynodeobj:function(e,t){return this.isedgevalidbylinkobj(this.board.getb(e.bx+t.bx>>1,e.by+t.by>>1))},setEdgeByNodeObj:function(e){0<this.getObjNodeList(e).length&&this.removeEdgeByNodeObj(e),0<this.calcNodeCount(e)&&this.addEdgeByNodeObj(e)},removeEdgeByNodeObj:function(e){for(var t=this.getSideObjByNodeObj(e),i=this.getObjNodeList(e)[0],e=i.nodes.length,n=i.component,s=0===this.modifyNodes.length,o=0;o<t.length;o++){var r=this.getObjNodeList(t[o])[0];i&&r&&(this.removeEdge(i,r),this.incdecBorderCount&&this.incdecBorderCount(this.board.getb(i.obj.bx+r.obj.bx>>1,i.obj.by+r.obj.by>>1),!0))}i&&this.deleteNode(i),!this.rebuildmode&&1===e&&s&&(this.setComponentInfo(n),this.modifyNodes=[])},addEdgeByNodeObj:function(e){for(var t=0,i=this.calcNodeCount(e);t<i;t++)this.createNode(e);for(var n,s=this.getSideObjByNodeObj(e),o=this.getObjNodeList(e)[0],r=0===this.modifyNodes.length,t=0;t<s.length;t++)this.isedgevalidbynodeobj(e,s[t])&&(n=this.getObjNodeList(s[t])[0],o&&n&&(this.addEdge(o,n),this.incdecBorderCount&&this.incdecBorderCount(this.board.getb(o.obj.bx+n.obj.bx>>1,o.obj.by+n.obj.by>>1),!1)));!this.rebuildmode&&1===o.nodes.length&&r&&(this.attachNode(o,o.nodes[0].component),this.modifyNodes=[])},setExtraData:function(e){e.clist=new this.klass.CellList(e.getnodeobjs())}},"AreaShadeGraph:AreaGraphBase":{relation:{"cell.qans":"node"},setComponentRefs:function(e,t){e.sblk=t},getObjNodeList:function(e){return e.sblknodes},resetObjNodeList:function(e){e.sblknodes=[]},isnodevalid:function(e){return e.isShade()},setExtraData:function(e){e.clist=new this.klass.CellList(e.getnodeobjs()),this.coloring&&!e.color&&(e.color=this.puzzle.painter.getNewLineColor())},repaintNodes:function(e){for(var t=new this.klass.CellList,i=0;i<e.length;i++)t.extend(e[i].getnodeobjs());this.puzzle.painter.repaintBlocks(t)}},"AreaUnshadeGraph:AreaGraphBase":{relation:{"cell.qans":"node"},getComponentRefs:function(e){return e.ublk},setComponentRefs:function(e,t){e.ublk=t},getObjNodeList:function(e){return e.ublknodes},resetObjNodeList:function(e){e.ublknodes=[]},isnodevalid:function(e){return e.isUnshade()}},"AreaNumberGraph:AreaGraphBase":{relation:{"cell.qnum":"node","cell.anum":"node","cell.qsub":"node"},setComponentRefs:function(e,t){e.nblk=t},getObjNodeList:function(e){return e.nblknodes},resetObjNodeList:function(e){e.nblknodes=[]},isnodevalid:function(e){return e.isNumberObj()}},"AreaRoomGraph:AreaGraphBase":{relation:{"cell.ques":"node","border.ques":"separator","border.qans":"separator"},hastop:!1,getComponentRefs:function(e){return e.room},setComponentRefs:function(e,t){e.room=t},getObjNodeList:function(e){return e.roomnodes},resetObjNodeList:function(e){e.roomnodes=[]},isnodevalid:function(e){return 7!==e.ques},isedgevalidbylinkobj:function(e){return!e.isBorder()},rebuild2:function(){this.klass.AreaGraphBase.prototype.rebuild2.call(this),this.resetBorderCount()},resetBorderCount:function(){for(var e=this.board,t=e.border,i=0;i<e.cross.length;i++){var n=e.cross[i],s=n.bx,o=n.by,s=1===e.hasborder&&(0===s||s===2*e.cols||0===o||o===2*e.rows);n[this.countprop]=s?2:0}for(var r=0;r<t.length;r++)this.isedgevalidbylinkobj(t[r])||this.incdecBorderCount(t[r],!0)},incdecBorderCount:function(e,t){for(var i=0;i<2;i++){var n=e.sidecross[i];n.isnull||(t?n[this.countprop]++:n[this.countprop]--)}},addEdgeBySeparator:function(e){var t=this.getSideNodesBySeparator(e);t&&(this.addEdge(t[0],t[1]),0===e.sidecross[0][this.countprop]||0===e.sidecross[1][this.countprop]?this.modifyNodes=[]:this.hastop&&2<=t.length&&this.setTopOfRoom_combine(t[0].obj,t[1].obj))},removeEdgeBySeparator:function(e){var t=this.getSideNodesBySeparator(e);t&&(this.removeEdge(t[0],t[1]),1!==e.sidecross[0][this.countprop]&&1!==e.sidecross[1][this.countprop]||(this.modifyNodes=[]))},setTopOfRoom_combine:function(e,t){var i;e.room&&t.room&&e.room!==t.room&&(e=e.room.top,t=t.room.top,t=e.bx>t.bx||e.bx===t.bx&&e.by>t.by?(i=e,t):(i=t,e),i.isNum()&&(t.noNum()&&(t.setQnum(i.qnum),t.draw()),i.setQnum(-1),i.draw()))},setExtraData:function(e){var t=e.clist=new this.klass.CellList(e.getnodeobjs());if(this.hastop&&(e.top=t.getTopCell(),this.rebuildmode)){for(var i=-1,n=e.top,s=0,o=t.length;s<o;s++){var r=t[s];r.room===e&&-1!==r.qnum&&(-1===i&&(i=r.qnum),n!==r&&(r.qnum=-1))}-1!==i&&-1===n.qnum&&(n.qnum=i)}this.puzzle.validConfig("autocmp")&&e.checkAutoCmp()},getSideAreaInfo:function(){for(var e=[],t=this.components.length,i={},n=this.board,s=0;s<this.components.length;s++)this.components[s].id=s;for(var o=0;o<n.border.length;o++){var r,a=this.getComponentRefs(n.border[o].sidecell[0]),h=this.getComponentRefs(n.border[o].sidecell[1]);a!==h&&a&&h&&(i[r=a.id<h.id?a.id*t+h.id:h.id*t+a.id]||(i[r]=!0,e.push([a,h])))}return e}}}),p.classmgr.makeCommon({Graphic:{initialize:function(){this.gridcolor=this.gridcolor_list[this.gridcolor_type]||this.gridcolor;var t=this;[["getQuesCellColor",this.fgcellcolor_func],["getBGCellColor",this.bgcellcolor_func],["getBorderColor",this.bordercolor_func],["getQuesNumberColor",this.numbercolor_func],["getCircleFillColor",this.circlefillcolor_func],["getCircleStrokeColor",this.circlestrokecolor_func]].forEach(function(e){t[e[0]]===p.common.Graphic.prototype[e[0]]&&(t[e[0]]=t[e[0]+"_"+e[1]]||t[e[0]])}),this.resetRange(),this.initFont()},context:null,subcontext:null,fgcellcolor_func:"ques",bgcellcolor_func:"error1",bordercolor_func:"ques",numbercolor_func:"mixed",circlefillcolor_func:"qnum",circlestrokecolor_func:"qnum",quescolor:"black",qanscolor:"rgb(0, 160, 0)",qcmpcolor:"silver",qcmpbgcolor:"rgb(224, 224, 255)",trialcolor:"rgb(160, 160, 160)",subcolor:"rgb(127, 127, 255)",subshadecolor:"rgb(220, 220, 255)",shadecolor:"black",errcolor1:"rgb(192, 0, 0)",errcolor2:"rgb(32, 32, 255)",fontShadecolor:"rgb(224, 224, 224)",enablebcolor:!1,bcolor:"rgb(160, 255, 160)",errbcolor1:"rgb(255, 160, 160)",errbcolor2:"rgb(64, 255, 64)",qsubcolor1:"rgb(160,255,160)",qsubcolor2:"rgb(255,255,127)",qsubcolor3:"rgb(192,192,192)",icecolor:"rgb(192, 224, 255)",erricecolor:"rgb(224,  96, 160)",circlebasecolor:"white",mbcolor:"rgb(0, 160, 0)",linecolor:"rgb(0, 160, 0)",errlinecolor:"rgb(255, 0, 0)",noerrcolor:"rgb(160, 160, 160)",linetrialcolor:"rgb(160, 160, 160)",movelinecolor:"silver",movetrialcolor:"rgb(255, 160, 0)",pekecolor:"rgb(0, 127, 0)",bbcolor:"rgb(160, 160, 160)",targetColorEdit:"rgb(255, 64,  64)",targetColorPlay:"rgb(64,  64, 255)",targetColorTrial:"rgb(255,  64, 255)",ttcolor:"rgb(127,255,127)",ttshadecolor:"rgb(0,127,0)",movecolor:"red",gridcolor:"black",gridcolor_type:"",gridcolor_list:{DARK:"rgb( 48,  48,  48)",LIGHT:"rgb(127, 127, 127)",DLIGHT:"rgb(160, 160, 160)",SLIGHT:"rgb(191, 191, 191)",THIN:"rgb(224, 224, 224)"},bgcolor:"white",textoption:null,fontsizeratio:.8,fontwidth:[.5,.4,.33],fontfamily:"",isSupportMaxWidth:!0,crosssize:.4,circleratio:[.4,.35],margin:.15,bankratio:.5,canvasWidth:null,canvasHeight:null,x0:0,y0:0,basex0:0,basey0:0,cw:36,ch:36,bw:18,bh:18,devicePixelRatio:1,gw:1,lw:1,lwmin:3,lm:1,lwratio:10,addlw:0,lastHdeg:0,lastYdeg:0,minYdeg:.18,maxYdeg:.7,range:null,useBuffer:!1,outputImage:!1,showBank:!0,pendingResize:!1,suspended:!0,suspendedAll:!0,hideHatena:!1,autocmp:"",irowake:!1,irowakeblk:!1,initCanvas:function(){var e,t=this.puzzle;(this.context=t.canvas?t.canvas.getContext("2d"):null).use.canvas&&(this.subcontext=t.subcanvas?t.subcanvas.getContext("2d"):null,this.useBuffer=!!this.subcontext),null!==this.canvasWidth&&null!==this.canvasHeight||(e=p.util.getRect(t.canvas),this.resizeCanvas(e.width,e.height)),this.pendingResize=!0,this.resize_canvas_main(),t.emit("canvasReady"),this.unsuspend()},initFont:function(){var e=1===this.puzzle.getConfig("font");this.puzzle.pzpr.env.OS.Android?this.fontfamily=e?"Helvetica, Verdana, Arial, ":'"Times New Roman", ':this.fontfamily="",this.fontfamily+=e?"sans-serif":"serif"},cellexpandratio:1,resizeCanvas:function(e,t){var i=this.suspended;this.suspendAll(),this.canvasWidth=e||this.canvasWidth,this.canvasHeight=t||this.canvasHeight,this.pendingResize=!0,i||this.unsuspend()},resizeCanvasByCellSize:function(e,t){var i=this.suspended;this.suspendAll(),e&&(this.cw=e*(t?1:this.cellexpandratio),this.ch=e*(t?1:this.cellexpandratio)),this.canvasWidth=this.cw*this.getCanvasCols(),this.canvasHeight=this.ch*this.getCanvasRows(),this.pendingResize=!0,i||this.unsuspend()},resize_canvas_main:function(){this.pendingResize&&(this.pendingResize=!1,this.setParameter(),this.setOffset(),this.puzzle.emit("resize"),this.clearObject())},setParameter:function(){var e=this.canvasWidth,t=this.canvasHeight,e=e/this.getCanvasCols()|0,t=t/this.getCanvasRows()|0,e=(this.devicePixelRatio=this.puzzle.pzpr.env.browser&&window.devicePixelRatio||1,this.puzzle.getConfig("squarecell")?this.cw=this.ch=Math.min(e,t):(this.cw=e,this.ch=t),this.bw=this.cw/2,this.bh=this.ch/2,Math.min(this.cw/40,1)),t=1/this.devicePixelRatio,e=Math.max(1,Math.round(e/t)),e=(this.gw=e*t,Math.max(this.cw/this.lwratio,this.lwmin)),e=Math.max(1,Math.round(e/t));this.lw=e*t,this.lm=this.lw/2},setOffset:function(){var e=this.context,t=this.subcontext,i=this.canvasWidth,n=this.canvasHeight,i=(e.changeSize(0|i,0|n),t&&t.changeSize(0|i,0|n),(this.x0=.5+((i-this.cw*this.getBoardCols())/2+this.cw*this.getOffsetCols()|0))+this.basex0),n=(this.y0=.5+((n-this.ch*this.getBoardRows())/2+this.ch*this.getOffsetRows()|0))+this.basey0;e.use.canvas?(e.translate(i,n),t&&t.translate(i,n)):(t=p.util.getRect(e.canvas),e.translate(i-t.left%1,n-t.top%1))},clearObject:function(){this.context.clear()},getCanvasCols:function(){return this.getBoardCols()+2*this.margin},getCanvasRows:function(){var e=this.getBoardRows()+2*this.margin;return this.board.bank&&this.showBank&&(e+=this.board.bank.height*this.bankratio+1/16),e},getBoardCols:function(){var e=this.board;return(e.maxbx-e.minbx)/2},getBoardRows:function(){var e=this.board;return(e.maxby-e.minby)/2},getOffsetCols:function(){return(0-this.board.minbx)/2},getOffsetRows:function(){var e=(0-this.board.minby)/2;return this.board.bank&&this.showBank&&(e-=this.board.bank.height*this.bankratio/2),e},suspend:function(){this.suspended=!0},suspendAll:function(){this.suspendedAll=!0,this.suspended=!0},unsuspend:function(){var e;this.context&&(this.resize_canvas_main(),this.suspendedAll&&(e=this.board,this.range.bank=!0,this.setRange(e.minbx-2,e.minby-2,e.maxbx+2,e.maxby+2),this.suspendedAll=!1),this.suspended&&(this.suspended=!1,this.prepaint()))},prepaint:function(){var e,t,i,n,s,o;!this.suspended&&this.context&&(this.isSupportMaxWidth=this.context.use.svg&&p.env.API.svgTextLength||this.context.use.canvas&&p.env.API.maxWidth,s=this.board,o=2*this.margin,e=this.range.x1,t=this.range.y1,i=this.range.x2,n=this.range.y2,(this.showBank&&(this.range.bank||0<this.range.bankPieces.length)||!(i<e||n<t||e>=s.maxbx+o||t>=s.maxby+o||i<=s.minbx-o||n<=s.minby-(o+("starbattle"===this.pid?2:0))))&&(this.useBuffer?(s=this.context,o=this.subcontext,this.context=o,this.setRangeObject(e-1,t-1,i+1,n+1),this.flushCanvas(),this.paintMain(),this.context=s,this.copyBufferData(s,o,e,t,i,n)):(this.setRangeObject(e,t,i,n),this.flushCanvas(),this.paintMain())),this.resetRange())},paintMain:function(){this.paint(),this.paintPost()},paint:function(){},paintPost:function(){},setRange:function(e,t,i,n){this.range.x1>e&&(this.range.x1=e),this.range.y1>t&&(this.range.y1=t),this.range.x2<i&&(this.range.x2=i),this.range.y2<n&&(this.range.y2=n)},setRangeObject:function(e,t,i,n){var s=this.board;this.range.cells=s.cellinside(e,t,i,n),this.range.crosses=s.crossinside(e,t,i,n),this.range.borders=s.borderinside(e,t,i,n),this.range.excells=s.excellinside(e,t,i,n)},resetRange:function(){var e=this.puzzle,t=e.board,e=e.klass;this.range={x1:t.maxbx+1,y1:t.maxby+1,x2:t.minbx-1,y2:t.minby-1,cells:new e.CellList,crosses:new e.CrossList,borders:new e.BorderList,excells:new e.ExCellList,bank:!1,bankPieces:[]}},copyBufferData:function(e,t,i,n,s,o){i=this.x0+i*this.bw-1,n=this.y0+n*this.bh-1,s=this.x0+s*this.bw+2,o=this.y0+o*this.bh+2;s>t.child.width&&(s=t.child.width),o>t.child.height&&(o=t.child.height),e.drawImage(t.child,i=i<0?0:i,n=n<0?0:n,s-i,o-n,i-this.x0,n-this.y0,s-i,o-n)},paintRange:function(e,t,i,n){this.setRange(e,t,i,n),this.prepaint()},paintAll:function(){this.suspended&&(this.suspendedAll=!0);var e=this.board;this.range.bank=!0,this.paintRange(e.minbx-2,e.minby-2,e.maxbx+2,e.maxby+2)},labToRgbStr:function(e,t,i){function n(e){return 6/29<e?Math.pow(e,3):3*Math.pow(6/29,2)*(e-4/29)}var e=(e+16)/116,t=95.0489*n(e+t/500),s=100*n(e),e=108.884*n(e-i/500),i=2.041369*t-.5649464*s-.3446944*e,o=-.969266*t+1.8760108*s+.041556*e,t=.0134474*t-.1183897*s+1.0154096*e;return"rgb("+(0|Math.max(Math.min(2.55*i,255),0))+","+(0|Math.max(Math.min(2.55*o,255),0))+","+(0|Math.max(Math.min(2.55*t,255),0))+")"},getNewLineColor:function(){var e=60+40*this.puzzle.painter.maxYdeg,t=60+40*this.puzzle.painter.minYdeg,e=Math.random()*(e-t)+t,t=(void 0===this.currentColorTheta?this.currentColorTheta=360*Math.random():this.currentColorTheta+=137.28,52*Math.random()+75),i=Math.sin(this.currentColorTheta*Math.PI/180)*t,t=Math.cos(this.currentColorTheta*Math.PI/180)*t;return this.labToRgbStr(e,i,t)},repaintBlocks:function(e){e.draw()},repaintLines:function(e){this.range.borders=e,this.drawLines(),this.context.use.canvas&&this.repaintParts(e)},repaintParts:function(e){},flushCanvas:function(){var e=this.vinc("background","crispEdges",!0),t=this.bw,i=this.bh,n=.15<this.margin?this.margin:0,s=this.board,o=s.minbx-n,r=s.minby-n,a=s.maxbx+n-o,s=s.maxby+n-r;e.vid="BG",e.fillStyle=this.bgcolor,e.fillRect(o*t-.5,r*i-.5,a*t+1,s*i+1)},vinc:function(e,t,i){var n=this.context,i={freeze:!!i};return i.rendering=t,n.setLayer(e,i),n},CENTER:1,BOTTOMLEFT:2,BOTTOMRIGHT:3,TOPRIGHT:4,TOPLEFT:5,UP:6,DN:7,RT:9,LT:8,disptext:function(e,t,i,n){var s=this.context,o=this.cw*((n=n||{}).ratio||this.fontsizeratio)|0,r=void 0,a=n.width||this.fontwidth,h=e.length<=a.length+1?e.length-2:a.length-1,a=0<=h?a[h]*e.length:null,h=(this.isSupportMaxWidth?r=a?o*a:void 0:a&&(o=o*a*1.5/e.length|0),n.style?n.style+" ":""),l=(s.font=h+o+"px "+this.fontfamily,this.bw*(n.hoffset||.9)),c=this.bh*(n.voffset||.82),a=n.position||1;switch(a){case 1:case 6:case 7:s.textAlign="center";break;case 2:case 5:case 8:s.textAlign="left",t-=l;break;case 3:case 4:case 9:s.textAlign="right",t+=l}switch(a){case 1:case 8:case 9:s.textBaseline="middle";break;case 4:case 5:case 6:s.textBaseline="candle-top",i-=c;break;case 3:case 2:case 7:s.textBaseline="alphabetic",i+=c}s.fillText(e,t,i,r)}},ImageTile:{cols:1,rows:1,width:0,height:0,initialize:function(){var e=this.puzzle;"undefined"!=typeof Image?(this.image_canvas=this.image_svg=new Image,this.image_canvas.onload=function(){e.painter.paintAll()}):(this.image_canvas=e.pzpr.Candle.Canvas?new e.pzpr.Candle.Canvas.Image:{},this.image_svg={}),this.image_canvas.src=this.image_svg.src=this.imgsrc_dataurl,this.image_canvas.height=this.image_svg.height=this.height,this.image_canvas.width=this.image_svg.width=this.width,this.cwidth=this.image_canvas.width/this.cols,this.cheight=this.image_canvas.height/this.rows,this.loaded=!0},putImage:function(e,t,i,n,s,o,r){var a=e.use.canvas?this.image_canvas:this.image_svg,h=this.cwidth,l=this.cheight,c=h*(i%this.cols),u=l*(i/this.cols|0);void 0===o&&(o=h,r=l),e.vid=t,e.drawImage(null!==i?a:null,c,u,h,l,n,s,o,r)}}}),p.classmgr.makeCommon({MouseEvent:{initialize:function(){this.cursor=this.puzzle.cursor,this.enableMouse=!0,this.mouseCell=null,this.firstCell=null,this.inputPoint=new this.klass.RawAddress,this.firstPoint=new this.klass.RawAddress,this.prevPos=new this.klass.Address,this.btn="",this.inputData=null,this.firstState=null,this.bordermode=!1,this.mousestart=!1,this.mousemove=!1,this.mouseend=!1,this.inputMode="auto",this.savedInputMode={edit:"auto",play:"auto"},this.mousereset()},RBShadeCell:!1,use:!1,bgcolor:!1,inputMode:"auto",savedInputMode:{},inputModes:{edit:[],play:[]},inversion:!1,mousereset:function(){var e=this.mouseCell,t=(this.mouseCell=this.firstCell=this.board.emptycell,this.firstPoint.reset(),this.prevPos.reset(),this.btn="",this.inputData=null,this.bordermode=!1,this.mousestart=!1,this.mousemove=!1,this.mouseend=!1,this);[["mouseinputAutoEdit",this.autoedit_func],["mouseinputAutoPlay",this.autoplay_func]].forEach(function(e){t[e[0]]===p.common.MouseEvent.prototype[e[0]]&&(t[e[0]]=t[e[0]+"_"+e[1]]||t[e[0]])}),this.puzzle.execConfig("dispmove")&&e&&!e.isnull&&e.draw()},modechange:function(){this.mousereset(),this.inputMode=this.savedInputMode[this.puzzle.editmode?"edit":"play"]},e_mousedown:function(e){if(!this.enableMouse)return!0;var t;this.setMouseButton(e),this.btn?(t=this.getBoardAddress(e),this.moveTo(t.bx,t.by),e.stopPropagation(),e.preventDefault()):this.mousereset()},e_mouseup:function(e){if(!this.enableMouse||!this.btn)return!0;this.inputEnd(),e.stopPropagation(),e.preventDefault()},e_mousemove:function(e){if(!this.enableMouse||!this.btn)return!0;var t;void 0!==e.touches||void 0===e.which||0!==e.which||e.type.match(/pointermove/i)&&0<e.buttons?(t=this.getBoardAddress(e),this.lineTo(t.bx,t.by)):this.mousereset(),e.stopPropagation(),e.preventDefault()},e_mousecancel:function(e){this.mousereset()},setMouseButton:function(e){this.btn=p.util.getMouseButton(e);var t=this.puzzle.key;t.checkmodifiers(e),((t.isSHIFT||t.isMETA)!==this.inversion||this.inputMode&&this.inputMode.indexOf("-")===this.inputMode.length-1)&&("left"===this.btn?this.btn="right":"right"===this.btn&&(this.btn="left"))},getBoardAddress:function(e){var t,i=this.puzzle.painter,n={px:NaN,py:NaN};return i.context?{bx:((n=!p.env.API.touchevent||p.env.API.pointerevent||p.env.OS.iOS?isNaN(e.offsetX)?{px:e.layerX,py:e.layerY}:{px:e.offsetX,py:e.offsetY}:(e=p.util.getPagePos(e),t=p.util.getRect(i.context.child),{px:e.px-t.left,py:e.py-t.top})).px-i.x0)/i.bw,by:(n.py-i.y0)/i.bh}:n},moveTo:function(e,t){this.inputPoint.init(e,t),this.mouseevent(0)},lineTo:function(e,t){for(var i=e-this.inputPoint.bx,n=t-this.inputPoint.by,s=2*((0<=i?i:-i)+(0<=n?n:-n))+.9|0,o=i/s,r=n/s,a=0;a<s-1;a++)this.inputPoint.move(o,r),this.mouseevent(1);this.inputPoint.init(e,t),this.mouseevent(1)},inputEnd:function(){this.mouseevent(2),this.mousereset()},inputPath:function(){var e=Array.prototype.slice.call(arguments);this.mousereset(),this.btn="string"==typeof e[0]?e.shift():"left",this.moveTo(e[0],e[1]);for(var t=2;t<e.length-1;t+=2)this.lineTo(e[t],e[t+1]);this.inputEnd()},mouseevent:function(e){this.cancelEvent=!1,this.mousestart=0===e,this.mousemove=1===e,this.mouseend=2===e;e=this.puzzle;e.emit("mouse"),this.cancelEvent||"left"!==this.btn&&"right"!==this.btn||(this.mousestart?(e.opemgr.newOperation(),e.errclear(),e.opemgr.updateStarts()):e.opemgr.newChain(),this.mouseinput())},mouseinput:function(){var e,t,i=this.inputMode;switch(this.puzzle.key.isZ&&-1===this.inputMode.indexOf(/info\-/)&&(e=0<=this.inputModes.play.indexOf("info-ublk"),0<=this.inputModes.play.indexOf("info-line")?i="info-line":0<=this.inputModes.play.indexOf("info-blk")?(t=this.getcell(),i=e&&t.isUnshade()?"info-ublk":"info-blk"):e?i="info-ublk":0<=this.inputModes.play.indexOf("info-room")&&(i="info-room")),i){case"auto":this.mouseinput_auto();break;case"number":case"number-":this.mouseinput_number();break;case"clear":this.mouseinput_clear();break;case"cell51":this.input51_fixed();break;case"circle-unshade":this.inputFixedNumber(1);break;case"circle-shade":this.inputFixedNumber(2);break;case"undef":this.inputFixedNumber(-2);break;case"ice":this.inputIcebarn();break;case"numexist":this.inputFixedNumber(-2);break;case"numblank":this.inputFixedNumber(-3);break;case"bgcolor":this.inputBGcolor();break;case"subcircle":case"bgcolor1":this.inputFixedQsub(1);break;case"subcross":case"bgcolor2":this.inputFixedQsub(2);break;case"completion":this.mousestart&&this.inputqcmp();break;case"objblank":this.inputDot();break;case"direc":this.inputdirec();break;case"arrow":this.inputarrow_cell();break;case"crossdot":this.mousestart&&this.inputcrossMark();break;case"border":this.inputborder();break;case"subline":this.inputQsubLine();break;case"shade":case"unshade":this.inputShade();break;case"line":this.inputLine();break;case"peke":this.inputpeke();break;case"bar":this.inputTateyoko();break;case"empty":this.inputempty();break;case"info-line":this.mousestart&&this.dispInfoLine();break;case"info-blk":this.mousestart&&this.dispInfoBlk();break;case"info-ublk":this.mousestart&&this.dispInfoUblk();break;case"info-room":this.mousestart&&this.dispInfoRoom();break;default:this.mouseinput_other()}},mouseinput_number:function(){this.mousestart&&this.inputqnum()},mouseinput_clear:function(){this.inputclean_cell()},mouseinput_auto:function(){this.puzzle.playmode?this.mouseinputAutoPlay():this.puzzle.editmode&&this.mouseinputAutoEdit()},mouseinputAutoEdit:function(){},mouseinputAutoPlay:function(){},autoedit_func:"",autoplay_func:"",mouseinput_other:function(){},notInputted:function(){return!this.puzzle.opemgr.changeflag},setInputMode:function(e){if(e=e||"auto",!(0<=this.getInputModeList().indexOf("number-"===e?"number":e)))throw Error("Invalid input mode :"+e);this.inputMode=e,this.savedInputMode[this.puzzle.editmode?"edit":"play"]=e,this.puzzle.redraw()},getInputModeList:function(e){if("viewer"===this.puzzle.instancetype)return[];e=e||(this.puzzle.editmode?"edit":"play");var t=["auto"];return 0<=(t=t.concat(this.inputModes[e])).indexOf("number")&&t.splice(t.indexOf("number")+1,0,"number-"),t},setInversion:function(e){this.inversion=!!e},getcell:function(){return this.getpos(0).getc()},getcell_excell:function(){var e=this.getpos(0),t=e.getex();return t.isnull?e.getc():t},getcross:function(){return this.getpos(.5).getx()},getbank:function(){var e=this.board.bank,t=this.puzzle.painter.bankratio,i=this.inputPoint.bx/(2*t),n=(this.inputPoint.by-(this.board.maxby+1))/(2*t);if(i<0||n<0)return null;for(var s=e.pieces.length,o=this.puzzle.editmode&&("function"==typeof this.allowAdd?e.allowAdd():!!e.allowAdd),r=0;r<s+(o?1:0);r++){var a=r<s?e.pieces[r]:e.addButton;if(null!==a.index&&i>=a.x-.25&&n>=a.y-.25&&i<a.x+a.w+.75&&n<a.y+a.h+.75)return a}return null},getpos:function(e){var t=this.inputPoint,i=2*e,e=2*(1-e),n=Math.min(this.board.minbx,this.board.minby),n=4+(0<=n?0:-2&-n),s=t.bx+n,t=t.by+n,o=s%2,r=t%2;return new this.klass.Address(+(i<=o)+(-2&s)+ +(e<=o)-n,+(i<=r)+(-2&t)+ +(e<=r)-n)},getcrossorcell:function(e){var t=this.inputPoint.clone(),t=(t.bx+=1,this.getDiagonalAddress(t,e,!1));return t?(--t.bx,t):this.getpos(.25)},getborder:function(e){e=this.getDiagonalAddress(this.inputPoint,e,!0);return e?e.getb():this.board.emptyborder},getDiagonalAddress:function(e,t,i){var n=1+(-2&e.bx),s=1+(-2&e.by),o=e.bx+1-n,e=e.by+1-s,r=this.board;if(i&&r.linegraph.isLineCross)if(r.borderAsLine){h=2*(.5+t);if((a=2*(.5-t))<o&&o<h&&a<e&&e<h)return null}else{var a,h=2*(1-t);if((o<(a=2*t)||h<o)&&(e<a||h<e))return null}return o<2-e?e<o?new this.klass.Address(n,s-1):new this.klass.Address(n-1,s):e<o?new this.klass.Address(1+n,s):new this.klass.Address(n,1+s)},isBorderMode:function(){return this.mousestart&&(this.bordermode=!this.getpos(.25).oncell()),this.bordermode},setcursor:function(e){var t=this.cursor.getaddr();this.cursor.setaddr(e),t.draw(),e.draw()},setcursorsnum:function(e){var t=this.cursor.getaddr(),i=(this.cursor.setaddr(e),this.inputPoint.bx),n=this.inputPoint.by,n=this.cursor.disableAnum?[5,4,2,3][2*(n=n%2|0)+(i=i%2|0)]:("factors"!==this.pid?[5,0,4,0,0,0,2,0,3]:[0,0,4,0,0,0,2,0,3])[3*(n=(n+12)%2*1.5|0)+(i=(i+12)%2*1.5|0)];this.cursor.targetdir!==n&&(this.cursor.targetdir=n),t.draw(),e.draw()}}}),p.classmgr.makeCommon({KeyEvent:{initialize:function(){this.cursor=this.puzzle.cursor,this.enableKey=!0,this.keyreset()},enablemake:!1,enableplay:!1,keyup_event:!1,keyreset:function(){this.isCTRL=!1,this.isMETA=!1,this.isALT=!1,this.isSHIFT=!1,this.isZ=!1,this.isX=!1,this.isY=!1,this.keydown=!1,this.keyup=!1,this.ca="",this.prev=null},isenablemode:function(){return this.puzzle.editmode&&this.enablemake||this.puzzle.playmode&&this.enableplay},e_keydown:function(e){var t=this.getchar(e);this.enableKey?(this.checkbutton(t,0),t&&this.keyevent(t,0),e.target!==this.puzzle.canvas&&!this.cancelDefault||(e.stopPropagation(),e.preventDefault())):e.target!==document.body||"BS"!==t&&" "!==t||(e.stopPropagation(),e.preventDefault())},e_keyup:function(e){var t=this.getchar(e);this.enableKey?(this.checkbutton(t,1),t&&this.keyevent(t,1),e.target!==this.puzzle.canvas&&!this.cancelDefault||(e.stopPropagation(),e.preventDefault())):e.target!==document.body||"BS"!==t&&" "!==t||(e.stopPropagation(),e.preventDefault())},checkmodifiers:function(e){this.isSHIFT=e.shiftKey,this.isCTRL=e.ctrlKey,this.isMETA=e.metaKey,this.isALT=e.altKey},checkbutton:function(e,t){e=e.split(/\+/).pop();"z"===e&&(this.isZ=0===t),"x"===e&&(this.isX=0===t),"y"===e&&(this.isY=0===t)},getchar:function(e){this.checkmodifiers(e);var t="",e=e.keyCode||e.charCode,e=(38===e?t="up":40===e?t="down":37===e?t="left":39===e?t="right":48<=e&&e<=57?t=(e-48).toString(36):65<=e&&e<=90?t=(e-55).toString(36):96<=e&&e<=105?t=(e-96).toString(36):112<=e&&e<=123?t="F"+(e-111).toString(10):32===e||46===e?t=" ":8===e?t="BS":109===e||189===e||173===e?t="-":106===e?t="*":107===e&&(t="+"),t?[t]:[]);return this.isMETA&&e.unshift("meta"),this.isALT&&e.unshift("alt"),this.isCTRL&&e.unshift("ctrl"),this.isSHIFT&&e.unshift("shift"),"alt+h"===(t=e.join("+"))?t="left":"alt+k"===t?t="up":"alt+j"===t?t="down":"alt+l"===t&&(t="right"),t},inputKeys:function(e){for(var t=0;t<arguments.length;t++)this.keyevent(arguments[t],0),this.keyevent(arguments[t],1)},keyevent:function(e,t){var i=this.puzzle;this.cancelEvent=!1,this.cancelDefault=!1,this.keydown=0===t,this.keyup=1===t,"BS"!==e&&" "!==e||(this.cancelDefault=!0),this.keydown?i.opemgr.newOperation():i.opemgr.newChain(),this.keydown&&!this.isZ&&(i.errclear(),i.opemgr.updateStarts()),i.emit("key",e),this.cancelEvent||this.keyexec(e)&&this.keyDispInfo(e)&&this.isenablemode()&&(this.keydown&&this.moveTarget(e)?this.cancelDefault=!0:(this.keydown||this.keyup&&this.keyup_event)&&this.keyinput(e))},keyexec:function(e){var t=this.puzzle;return!(this.keydown&&"alt+c"===e&&!t.playeronly)||(t.setMode(t.playmode?t.MODE_EDITOR:t.MODE_PLAYER),!1)},keyDispInfo:function(e){return!0},keyinput:function(e){this.key_inputqnum(e)},moveTarget:function(e){return this.moveTCell(e)},moveTCell:function(e){return this.moveTC(e,2)},moveTCross:function(e){return this.moveTC(e,2)},moveTBorder:function(e){return this.moveTC(e,1)},moveTC:function(e,t){var i=this.cursor,n=i.getaddr(),s=!0,o=i.NDIR;switch(e){case"up":("easyasabc"===this.pid&&-1===i.by||i.by-t>=i.miny)&&(o=i.UP);break;case"down":i.by+t<=i.maxy&&(o=i.DN);break;case"left":i.bx-t>=i.minx&&(o=i.LT);break;case"right":i.bx+t<=i.maxx&&(o=i.RT);break;default:s=!1}return s&&(i.movedir(o,t),n.draw(),i.draw()),s},moveExCell:function(e){var t=this.cursor,i=t.getaddr(),n=!0,s=i.NDIR;switch(e){case"up":t.by===t.maxy&&t.minx<t.bx&&t.bx<t.maxx?t.by=t.miny:t.by>t.miny?s=i.UP:n=!1;break;case"down":t.by===t.miny&&t.minx<t.bx&&t.bx<t.maxx?t.by=t.maxy:t.by<t.maxy?s=i.DN:n=!1;break;case"left":t.bx===t.maxx&&t.miny<t.by&&t.by<t.maxy?t.bx=t.minx:t.bx>t.minx?s=i.LT:n=!1;break;case"right":t.bx===t.minx&&t.miny<t.by&&t.by<t.maxy?t.bx=t.maxx:t.bx<t.maxx?s=i.RT:n=!1;break;default:n=!1}return n&&(s!==i.NDIR&&t.movedir(s,2),i.draw(),t.draw()),n}},"TargetCursor:Address":{initialize:function(){this.bx=1,this.by=1,this.bankpiece=null,this.mode51=51===this.puzzle.klass.ExCell.prototype.ques,this.modesnum=this.puzzle.klass.Cell.prototype.enableSubNumberArray,this.disableAnum=this.puzzle.klass.Cell.prototype.disableAnum,this.targetdirs=this.puzzle.klass.Cell.prototype.dirs51,this.mode51&&this.puzzle.editmode?this.targetdir=4:this.disableAnum&&this.puzzle.playmode&&(this.targetdir=5)},init:function(e,t){return this.bx=e,this.by=t,this.bankpiece=null,this.mode51||(this.targetdir=this.disableAnum&&this.puzzle.playmode?5:0),this},getc:function(){return null===this.bankpiece?this.board.getc(this.bx,this.by):this.board.emptycell},minx:null,miny:null,maxx:null,maxy:null,crosstype:!1,initCursor:function(){this.crosstype?this.init(0,0):this.init(1,1),this.adjust_init()},setminmax:function(){var e=this.board,t=this.crosstype?0:1;this.minx=e.minbx+t,this.miny=e.minby+t,this.maxx=e.maxbx-t,this.maxy=e.maxby-t,this.setminmax_customize(),this.adjust_init()},setminmax_customize:function(){},adjust_init:function(){this.bx<this.minx&&(this.bx=this.minx),this.by<this.miny&&(this.by=this.miny),this.bx>this.maxx&&(this.bx=this.maxx),this.by>this.maxy&&(this.by=this.maxy)},adjust_modechange:function(){this.setminmax_customize!==this.common.setminmax_customize&&this.setminmax(),this.mode51&&this.puzzle.editmode?this.targetdir=4:this.modesnum&&(this.targetdir=this.puzzle.playmode&&this.disableAnum?5:0)},adjust_cell_to_excell:function(){var e=this.board,t=Math.min(this.bx,2*e.cols-this.bx,this.by,2*e.rows-this.by);t<=0||(this.by===t?this.by=this.miny:2*e.rows-this.by===t?this.by=this.maxy:this.bx===t?this.bx=this.minx:2*e.cols-this.bx===t&&(this.bx=this.maxx))},checksnum:function(e){var t,i,n=2*(((e.bx+12)/2|0)-6)+1,s=2*(((e.by+12)/2|0)-6)+1,n=this.bx===n&&this.by===s;return n=n&&this.modesnum&&this.puzzle.playmode?this.disableAnum?(t=e.bx%2|0,[5,4,2,3][2*(i=e.by%2|0)+t]===this.targetdir):(t=(e.bx+12)%2*1.5|0,i=(e.by+12)%2*1.5|0,"factors"!==this.pid?[5,0,4,0,0,0,2,0,3][3*i+t]===this.targetdir:[0,0,4,0,0,0,2,0,3][3*i+t]===this.targetdir):n},movedir:function(e,t){return null!==this.bankpiece||(this.puzzle.klass.Address.prototype.movedir.call(this,e,t),this.modesnum&&this.puzzle.playmode&&!this.disableAnum&&(this.targetdir=0)),this},setaddr:function(e){e.bx<this.minx||this.maxx<e.bx||e.by<this.miny-("easyasabc"===this.pid?2:0)||this.maxy<e.by||(this.bankpiece=null,this.set(e),this.modesnum&&this.puzzle.playmode&&!this.disableAnum&&(this.targetdir=0))},moveTo:function(e,t){this.init(e,t),this.modesnum&&this.puzzle.playmode&&!this.disableAnum&&(this.targetdir=0)},targetdir:0,chtarget:function(e,t,i){var n;this.oncell()&&this.modesnum&&this.puzzle.playmode?this.disableAnum?this.targetdir=[5,1,3,5,2,4][this.targetdir]:"factors"!==this.pid?this.targetdir=[5,1,3,0,2,4][this.targetdir]:this.targetdir=[4,1,3,0,2,0][this.targetdir]:4===this.targetdirs?e?(n=t+i<0,this.targetdir=0<t-i?n?1:4:n?3:2):this.targetdir=[4,0,3,1,2,0][this.targetdir]:this.targetdir=e?0<t-i?4:2:2===this.targetdir?4:2,this.draw()},detectTarget:function(e){e=e||this.getobj();var t=this.board,i=e.adjacent;if(e.isnull)return 0;if("cell"===e.group){if(51!==e.ques)return 0;if(2===this.targetdirs){var n=i.right.isnull||51===i.right.ques,s=i.bottom.isnull||51===i.bottom.ques;if(n&&s)return 0;if(s)return e.RT;if(n)return e.DN}}else{if("excell"!==e.group)return 0;if(e.id===t.cols+t.rows)return 0;if(-1===e.by&&51===i.bottom.ques||-1===e.bx&&51===i.right.ques)return 0;if(-1===e.by)return e.DN;if(-1===e.bx)return e.RT}return this.targetdir},getNumOfTarget:function(e){var t=1;return e.isnull?t=0:"cell"===e.group&&(this.modesnum&&this.puzzle.playmode?t=4-("factors"===this.pid?1:0):51===e.ques&&(t=((e=e.adjacent).right.isnull||51===e.right.ques?0:1)+(e.bottom.isnull||51===e.bottom.ques?0:1))),t},getDot:function(){return this.board.getDot(this.bx,this.by)}}}),p.classmgr.makeCommon({Encode:{pflag:"",outpflag:"",outvariant:null,outcols:null,outrows:null,outbstr:"",fio:null,checkpflag:function(e){return 0<=this.pflag.indexOf(e)},decodeURL:function(e){var t=p.parser.parseURL(e),i=this.puzzle,e=i.board;if(null!==t.variant&&(i.setConfig("variant",!0),i.setConfig("variantid",t.variant)),t.type===t.URL_PZPRFILE)(new i.klass.FileIO).filedecode(t.body);else{if(e.initBoardSize(t.cols,t.rows),t.body)switch(this.pflag=t.pflag,this.outbstr=t.body,t.type){case t.URL_PZPRV3:case t.URL_KANPENP:this.decodePzpr(t.URL_PZPRV3);break;case t.URL_PZPRAPP:this.decodePzpr(t.URL_PZPRAPP);break;case t.URL_KANPEN:this.fio=new i.klass.FileIO,this.fio.dataarray=this.outbstr.replace(/_/g," ").split("/"),this.decodeKanpen(),this.fio=null;break;case t.URL_HEYAAPP:this.decodeHeyaApp()}e.rebuildInfo()}},encodeURL:function(e,t){var i=this.puzzle,n=i.pid,s=i.board,o=new p.parser.URLData("",t),t=((e=e||o.URL_PZPRV3)===o.URL_KANPEN&&"lits"===n&&(e=o.URL_KANPENP),this.outpflag=null,i.getConfig("variant"));switch(this.outvariant=t?i.getConfig("variantid"):null,this.outcols=s.cols,this.outrows=s.rows,this.outbstr="",e){case o.URL_PZPRV3:this.encodePzpr(o.URL_PZPRV3);break;case o.URL_PZPRFILE:var r=(r=this.puzzle.getFileData(o.FILE_PZPRV3).split("\n")).map(encodeURIComponent);this.outbstr=r.join("/");break;case o.URL_PZPRAPP:throw Error("no implementation");case o.URL_KANPENP:if(!i.info.exists.kanpen)throw Error("no implementation");this.encodePzpr(o.URL_PZPRAPP),this.outpflag=this.outpflag||"";break;case o.URL_KANPEN:this.fio=new i.klass.FileIO,this.encodeKanpen(),this.outbstr=this.fio.datastr.replace(/\r?\n/g,"/").replace(/ /g,"_"),this.fio=null;break;case o.URL_HEYAAPP:this.encodeHeyaApp();break;default:throw Error("invalid URL Type")}return o.pid=n,o.type=e,o.pflag=this.outpflag,o.variant=this.outvariant,o.cols=this.outcols,o.rows=this.outrows,o.body=this.outbstr,o.generate()},decodePzpr:function(e){throw Error("no implementation")},encodePzpr:function(e){throw Error("no implementation")},decodeKanpen:function(){throw Error("no implementation")},encodeKanpen:function(){throw Error("no implementation")},decodeHeyaApp:function(){throw Error("no implementation")},encodeHeyaApp:function(){throw Error("no implementation")}}}),p.classmgr.makeCommon({FileIO:{filever:0,lineseek:0,dataarray:null,xmldoc:null,datastr:"",currentType:0,filedecode:function(e){var t=this.puzzle,i=t.board,e=p.parser.parseFile(e,t.pid),n=this.currentType=e.type;switch(i.initBoardSize(e.cols,e.rows),this.filever=e.filever,n!==e.FILE_PBOX_XML?(this.lineseek=0,this.dataarray=e.body.split("\n")):this.xmldoc=e.body,n){case e.FILE_PZPR:this.decodeData(),(this.readLine()||"").match(/TrialData/)&&(this.lineseek--,this.decodeTrial());break;case e.FILE_PBOX:this.kanpenOpen();break;case e.FILE_PBOX_XML:this.kanpenOpenXML()}t.metadata.update(e.metadata),e.history&&n===e.FILE_PZPR&&t.opemgr.decodeHistory(e.history),i.rebuildInfo(),this.dataarray=null},fileencode:function(e,t){var i,n=this.puzzle,s=n.board,o=new p.parser.FileData("",n.pid);switch(this.currentType=e=e||o.FILE_PZPR,t=t||{},this.filever=0,this.datastr="",e===o.FILE_PBOX_XML&&(this.xmldoc=(new f).parseFromString('<?xml version="1.0" encoding="utf-8" ?><puzzle />',"text/xml"),(i=this.xmldoc.querySelector("puzzle")).appendChild(this.createXMLNode("board")),i.appendChild(this.createXMLNode("answer"))),e){case o.FILE_PZPR:this.encodeData(),!t.history&&t.trial&&0<s.trialstage&&this.encodeTrial();break;case o.FILE_PBOX:this.kanpenSave();break;case o.FILE_PBOX_XML:this.kanpenSaveXML();break;default:throw Error("invalid filetype")}return o.type=e,o.filever=this.filever,o.cols=s.cols,o.rows=s.rows,e!==o.FILE_PBOX_XML?o.body=this.datastr:o.body=this.xmldoc,o.metadata.update(n.metadata),t.history&&e===o.FILE_PZPR&&(o.history=n.opemgr.encodeHistory({time:!!t.time})),this.datastr="",o.generate()},decodeData:D,encodeData:D,kanpenOpen:D,kanpenSave:D,kanpenOpenXML:D,kanpenSaveXML:D,decodeTrial:function(){for(var e=this.puzzle.opemgr,o=this.board,t=(0|this.readLine().match(/TrialData\((\d+)\)/)[1])-1;0<=t;t--){var r=[],a=o.freezecopy();o.allclear(!1),this.decodeData(),o.compareData(a,function(e,t,i){var n=o[e][t],s=n[i],e=a[e][t][i];r.push(new this.puzzle.klass.ObjectOperation(n,i,s,e))}),e.history.unshift(r),e.history.unshift([new this.puzzle.klass.TrialEnterOperation(t,t+1)]),e.trialpos.unshift(2*t),this.readLine()}e.position=e.history.length,e.resumeTrial()},encodeTrial:function(){var e=this.puzzle.opemgr,t=e.position;e.disableRecord();for(var i=this.board.trialstage;0<i;i--)this.writeLine("TrialData("+i+")"),e.resumeGoto(e.trialpos[i-1]),this.encodeData();e.resumeGoto(t),e.resumeTrial(),e.enableRecord()},readLine:function(){return this.lineseek++,this.dataarray[this.lineseek-1]},getItemList:function(e){for(var t,i=[],n=0;n<e;n++)if(t=this.readLine())for(var s=t.split(" "),o=0;o<s.length;o++)""!==s[o]&&i.push(s[o]);return i},writeLine:function(e){this.datastr+=(e="number"==typeof e?""+e:e||"")+"\n"},decodeObj:function(e,t,i,n,s,o){for(var r=i,a=n,h=this.getItemList((o-n)/2+1),l=0;l<h.length&&(e.call(this,this.board.getObjectPos(t,r,a),h[l]),s<(r+=2)&&(r=i,a+=2),!(o<a));l++);},decodeCell:function(e){this.decodeObj(e,"cell",1,1,2*this.board.cols-1,2*this.board.rows-1)},decodeCross:function(e){this.decodeObj(e,"cross",0,0,2*this.board.cols,2*this.board.rows)},decodeBorder:function(e,t){var i=this.puzzle.board;1===(t=t||i.hasborder)?(this.decodeObj(e,"border",2,1,2*i.cols-2,2*i.rows-1),this.decodeObj(e,"border",1,2,2*i.cols-1,2*i.rows-2)):2===t&&(this.currentType===p.parser.FILE_PZPR?(this.decodeObj(e,"border",0,1,2*i.cols,2*i.rows-1),this.decodeObj(e,"border",1,0,2*i.cols-1,2*i.rows)):this.currentType===p.parser.FILE_PBOX&&(this.decodeObj(e,"border",1,0,2*i.cols-1,2*i.rows),this.decodeObj(e,"border",0,1,2*i.cols,2*i.rows-1)))},decodeCellExCell:function(e){this.decodeObj(e,"obj",this.board.minbx+1,this.board.minby+1,this.board.maxbx-1,this.board.maxby-1)},encodeObj:function(e,t,i,n,s,o){for(var r=n;r<=o;r+=2){for(var a="",h=i;h<=s;h+=2)a+=e.call(this,this.board.getObjectPos(t,h,r));this.writeLine(a)}},encodeCell:function(e){this.encodeObj(e,"cell",1,1,2*this.board.cols-1,2*this.board.rows-1)},encodeCross:function(e){this.encodeObj(e,"cross",0,0,2*this.board.cols,2*this.board.rows)},encodeBorder:function(e,t){var i=this.puzzle.board;1===(t=t||i.hasborder)?(this.encodeObj(e,"border",2,1,2*i.cols-2,2*i.rows-1),this.encodeObj(e,"border",1,2,2*i.cols-1,2*i.rows-2)):2===t&&(this.currentType===p.parser.FILE_PZPR?(this.encodeObj(e,"border",0,1,2*i.cols,2*i.rows-1),this.encodeObj(e,"border",1,0,2*i.cols-1,2*i.rows)):this.currentType===p.parser.FILE_PBOX&&(this.encodeObj(e,"border",1,0,2*i.cols-1,2*i.rows),this.encodeObj(e,"border",0,1,2*i.cols,2*i.rows-1)))},encodeCellExCell:function(e){this.encodeObj(e,"obj",this.board.minbx+1,this.board.minby+1,this.board.maxbx-1,this.board.maxby-1)},decodeFlags:function(){for(var e=this.readLine().split(","),t=0;t<e.length;t++)this.puzzle.setConfig(e[t],!0)},encodeFlags:function(e){for(var t=[],i=0;i<e.length;i++)this.puzzle.getConfig(e[i])&&t.push(e[i]);this.writeLine(t.join(","))},decodeConfigFlag:function(e,t,i,n){void 0===i&&(i=!0),void 0===n&&(n=!i),this.dataarray[this.lineseek]===e?(this.puzzle.setConfig(t,i),this.readLine()):this.puzzle.setConfig(t,n)},encodeConfigFlag:function(e,t,i){void 0===i&&(i=!0),this.puzzle.getConfig(t)===i&&this.writeLine(e)},decodeCellXMLBoard:function(e){for(var t=this.xmldoc.querySelectorAll("board number"),i=0;i<t.length;i++){var n=t[i],s=this.board.getc(2*+n.getAttribute("c")-1,2*+n.getAttribute("r")-1);s.isnull||e(s,+n.getAttribute("n"))}},encodeCellXMLBoard:function(e){for(var t=this.xmldoc.querySelector("board"),i=this.board,n=0;n<i.cell.length;n++){var s=i.cell[n],o=e(s);null!==o&&t.appendChild(this.createXMLNode("number",{r:1+(s.by/2|0),c:1+(s.bx/2|0),n:o}))}},PBOX_ADJUST:0,decodeCellXMLBrow:function(e){this.decodeCellXMLrow_com(e,"board","brow")},encodeCellXMLBrow:function(e){this.encodeCellXMLrow_com(e,"board","brow")},decodeCellXMLArow:function(e){this.decodeCellXMLrow_com(e,"answer","arow")},encodeCellXMLArow:function(e){this.encodeCellXMLrow_com(e,"answer","arow")},decodeCellXMLrow_com:function(e,t,i){for(var n=this.xmldoc.querySelectorAll(t+" "+i),s=this.PBOX_ADJUST,o=0;o<n.length;o++)for(var r=1-s,a=2*+n[o].getAttribute("row")-1-s,h=n[o].childNodes,l=0;l<h.length;l++)if(1===h[l].nodeType){var c=h[l].nodeName,u=h[l].getAttribute("n")||1;"z"===c?c="n0":"n"===c&&(c="n"+ +h[l].getAttribute("v"));for(var d=0;d<u;d++)e(this.board.getobj(r,a),c),r+=2}},encodeCellXMLrow_com:function(e,t,i){for(var n=this.xmldoc.querySelector(t),s=this.PBOX_ADJUST,o=this.board,r=1-s;r<=o.maxby;r+=2){for(var a=this.createXMLNode(i,{row:1+((r+s)/2|0)}),h=1-s;h<=o.maxbx;h+=2){var l=e(o.getobj(h,r)),l=l.match(/n(\d\d+)/)||l.match(/n(\-\d+)/)?this.createXMLNode("n",{v:RegExp.$1}):"n0"===l?this.createXMLNode("z"):this.createXMLNode(l);a.appendChild(l)}n.appendChild(a)}},createXMLNode:function(e,t){var i=this.xmldoc.createElement(e);if(t)for(var n in t)i.setAttribute(n,t[n]);return i}}}),p.classmgr.makeCommon({AnsCheck:{initialize:function(){this.inCheck=!1,this.checkOnly=!1,this.makeCheckList()},failcodemode:void 0,failcode:void 0,_info:void 0,checklist:[],makeCheckList:function(){for(var e=this.checklist,t=[],i=0;i<e.length;i++){var n=e[i],s=!0;n.match("@")&&(s=p.util.checkpid(n.substr(n.indexOf("@")+1),this.puzzle.pid),n=n.substr(0,n.indexOf("@"))),s&&(s=(n.match(/\+/)||[]).length,n=n.replace(/\+/g,""),t.push([this[n],s]))}this.checklist_normal=[];for(i=0;i<t.length;i++)this.checklist_normal.push(t[i][0]);t=t.sort(function(e,t){return t[1]-e[1]}),this.checklist_auto=[];for(i=0;i<t.length;i++)this.checklist_auto.push(t[i][0])},check:function(e){var t=this.puzzle,i=this.board;return this.inCheck=!0,e?(this.checkOnly=!1,this.checkAns(!1),this.failcode.complete||(i.haserror=!0,t.redraw(!0))):void 0!==this.failcode&&this.failcodemode===e||(i.disableSetError(),this.checkOnly=!0,this.checkAns(!1===e),this.failcodemode=e,i.enableSetError()),this.inCheck=!1,this.failcode},checkAns:function(e){this.failcode=new this.klass.CheckInfo;for(var t=!this.puzzle.getConfig("multierr")||e,i=this.checkOnly&&t?this.checklist_auto:this.checklist_normal,n=0;n<i.length&&(i[n].call(this),!(t&&0<this.failcode.length));n++);e||(this.failcode.text=this.failcode.gettext())},resetCache:function(){this.failcode=this.failcodemode=void 0,this._info={}}},CheckInfo:{initialize:function(e){this.add(e)},complete:!0,undecided:!1,text:"",length:0,lastcode:null,add:function(e){e&&(e!==this.lastcode&&(this[this.length++]=this.lastcode=e),this.complete=!1)},gettext:function(e){var t=this.puzzle,i=p.failcodes,n=[],s="ja"===(e||p.lang)?"ja":"en";if(0===this.length)return i[s].complete;for(var o=0;o<this.length;o++){var r=this[o],a=r+"."+this.pid,h=r+"."+this.pidbase,a=(r in t.faillist?r=t.faillist[r]:a in i.en?r=a:h in i.en&&(r=h),i[s][r]||i.en[r]||i[s].invalid);n.push(a)}return n.join("\n")},setUndecided:function(){this.undecided=!0}},FailCode:{}}),p.classmgr.makeCommon({Operation:{external:!1,initialize:function(){var e;this.manager=this.puzzle.opemgr,0<arguments.length&&(e=Array.prototype.slice.call(arguments),this.setData.apply(this,e))},reqReset:!1,setData:function(e,t){this.old=e,this.num=t},decode:function(e){return!1},toString:function(){return""},toJSON:function(){return this.toString()},broadcast:function(){},undo:function(){this.exec(this.old)},redo:function(){this.exec(this.num)},exec:function(e){}},"ObjectOperation:Operation":{group:"",property:"",pos:null,STRGROUP:{C:"cell",X:"cross",B:"border",E:"excell"},STRPROP:{U:"ques",N:"qnum",Z:"qnum2",C:"qchar",M:"anum",D:"qdir",A:"qans",S:"qsub",K:"qcmp",B:"snum",L:"line"},setData:function(e,t,i,n){this.group=e.group,this.property=t,this.bx=e.bx,this.by=e.by,this.old=i,this.num=n,4<t.length&&"snum"===t.substr(0,4)&&(this.property="snum",this.pos=t.substr(4))},decode:function(e){return this.group=this.STRGROUP[e[0].charAt(0)],this.property=this.STRPROP[e[0].charAt(1)],!(!this.group||!this.property)&&(this.pos="CB"===e[0].substr(0,2)&&2<e[0].length?+e[0].charAt(2):null,this.bx=+e[1],this.by=+e[2],this.old=+e[3],this.num=+e[4],!0)},toString:function(){var e,t="";for(e in this.STRGROUP)if(this.group===this.STRGROUP[e]){t+=e;break}for(e in this.STRPROP)if(this.property===this.STRPROP[e]){t+=e;break}return"CB"===t&&null!==this.pos&&(t+=this.pos),[t,this.bx,this.by,this.old,this.num].join(",")},broadcast:function(){this.external||this.puzzle.emit("cellop",this.toJSON())},isModify:function(e){var t=this.property;return e.group===this.group&&e.property===this.property&&e.num===this.old&&e.bx===this.bx&&e.by===this.by&&("qnum"===t||"qnum2"===t||"qchar"===t||"anum"===t||"snum"===t&&e.pos===this.pos)&&(e.num=this.num,!0)},isNoop:function(){return this.num===this.old},getPiece:function(){return this.board.getObjectPos(this.group,this.bx,this.by)},exec:function(e){var t=this.getPiece(),i=this.board;if(this.group!==t.group)return!0;null===this.pos?t.setdata(this.property,e,!0):t.setdata2(this.property,this.pos,e,!0),t.draw(),"qcmp"===this.property?i.cell.each(function(e){t===e.base&&e.draw()}):this.puzzle.checker.resetCache()}},"ObjectOperation2:Operation":{setData:function(e,t,i){this.bx=e.bx,this.by=e.by,this.old=t,this.val=i,this.property="qnums"},decode:function(e){if("CR"!==e.shift())return!1;this.bx=+e.shift(),this.by=+e.shift();e=e.join(","),e=e.substr(1,e.length-2).split(/\],\[/);if(0===e[0].length)this.old=[];else{this.old=e[0].split(/,/);for(var t=0;t<this.old.length;t++)this.old[t]=+this.old[t]}if(0===e[1].length)this.val=[];else{this.val=e[1].split(/,/);for(t=0;t<this.val.length;t++)this.val[t]=+this.val[t]}return!0},toString:function(){return["CR",this.bx,this.by,"["+this.old.join(",")+"]","["+this.val.join(",")+"]"].join(",")},isModify:function(e){return!(e.property!==this.property||e.bx!==this.bx||e.by!==this.by||!this.puzzle.pzpr.util.sameArray(e.val,this.old))&&(e.val=this.val,!0)},undo:function(){this.exec(this.old)},redo:function(){this.exec(this.val)},exec:function(e){var t=this.puzzle,i=t.board.getobj(this.bx,this.by);i.setQnums(e),i.draw(),t.checker.resetCache()}},"BoardClearOperation:Operation":{prefix:"AC",reqReset:!0,decode:function(e){return e[0]===this.prefix},toString:function(){return this.prefix}},"BoardAdjustOperation:Operation":{prefix:"AJ",reqReset:!0,setData:function(e){this.old=this.num=e},decode:function(e){return e[0]===this.prefix&&(this.old=this.num=e[1],!0)},toString:function(){return[this.prefix,this.num].join(",")},undo:function(){var e=this.board.exec.boardtype[this.old][0];this.exec(e)},redo:function(){var e=this.board.exec.boardtype[this.num][1];this.exec(e)},exec:function(e){var t=this.puzzle,i=t.board,n={x1:0,y1:0,x2:2*i.cols,y2:2*i.rows};i.exec.execadjust_main(e,n),t.redraw()}},"BoardFlipOperation:Operation":{prefix:"AT",reqReset:!0,area:{},setData:function(e,t){this.area=e,this.old=this.num=t},decode:function(e){return e[0]===this.prefix&&(this.old=this.num=e[1],this.area.x1=+e[2],this.area.y1=+e[3],this.area.x2=+e[4],this.area.y2=+e[5],!0)},toString:function(){var e=this.area;return[this.prefix,this.num,e.x1,e.y1,e.x2,e.y2].join(",")},undo:function(){var e,t=this.area,t={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2},i=this.board.exec.boardtype[this.old][0];i&this.board.exec.TURN&&(e=t.x1,t.x1=t.y1,t.y1=e,e=t.x2,t.x2=t.y2,t.y2=e),this.exec(i,t)},redo:function(){var e=this.area,e={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},t=this.board.exec.boardtype[this.num][1];this.exec(t,e)},exec:function(e,t){var i=this.puzzle;i.board.exec.execadjust_main(e,t),i.redraw()}},"TrialEnterOperation:Operation":{setData:function(e,t){this.old=e,this.num=t},undo:function(){this.manager.position--,this.manager.resumeTrial(),this.manager.position++,this.manager.trialpos.pop(),this.manager.emitTrial(this.old)},redo:function(){this.manager.trialpos.push(this.manager.position),this.manager.emitTrial(this.num)},decode:function(e){return"TE"===e[0]&&(this.old=+e[1],this.num=+e[2],!0)},toString:function(){return["TE",this.old,this.num].join(",")}},"TrialFinalizeOperation:Operation":{num:[],setData:function(e){this.old=e},exec:function(e){this.manager.trialpos=e.concat(),0===e.length?this.board.trialclear():(this.manager.position--,this.manager.resumeTrial(),this.manager.position++),this.manager.emitTrial(e.length),this.puzzle.redraw()},decode:function(e){return"TF"===e[0]&&(e.shift(),this.old=JSON.parse(e.join(",")),!0)},toString:function(){return"TF,["+this.old.join(",")+"]"}},OperationList:{initialize:function(){this.time=this.puzzle.getTime(),this.length=0},push:function(e){this[this.length++]=e},some:function(e){return Array.prototype.slice.call(this).some(e)}},OperationManager:{initialize:function(){this.lastope=null,this.history=[],this.position=0,this.trialpos=[],this.disEmitTrial=0,this.savedStarts=[],this.broken=!1,this.initpos=0,this.disrec=0,this.disCombine=!1,this.forceRecord=!1,this.changeflag=!1,this.chainflag=!1,this.enableUndo=!1,this.enableRedo=!1,this.limitTrialUndo=!1,this.undoExec=!1,this.redoExec=!1,this.reqReset=!1,this.enableNetwork=!0;var e=this.klass;this.operationlist=[e.ObjectOperation,e.ObjectOperation2,e.BankEditOperation,e.BankReplaceOperation,e.BankPieceOperation,e.BoardClearOperation,e.BoardAdjustOperation,e.BoardFlipOperation,e.TrialEnterOperation,e.TrialFinalizeOperation],this.addExtraOperation()},addExtraOperation:function(){},getStarts:function(){for(var e=[],t=0;t<this.trialpos.length;t++){var i=this.trialpos[t];i+1<this.history.length&&((i=this.history[i+1][0]).getPiece&&e.push(i.getPiece()))}return e},updateStarts:function(){for(var e=this.savedStarts,t=e.length;0<t&&e[t-1].isnull;t--);var i=this.getStarts();if(t!==i.length){for(var n=0;n<i.length;n++)this.savedStarts[n]=i[n];for(n=i.length;n<this.savedStarts.length;n++)this.savedStarts[n]=new this.puzzle.board.klass.BoardPiece;for(n=0;n<e.length;n++)e[n].draw();for(n=0;n<this.savedStarts.length;n++)this.savedStarts[n].draw()}},disableRecord:function(){this.disrec++},enableRecord:function(){0<this.disrec&&this.disrec--},checkexec:function(){void 0!==this.history&&(this.checkenable(),this.puzzle.emit("history"))},atStartOfTrial:function(){return 0<this.trialpos.length&&this.position<=this.trialpos[this.trialpos.length-1]+1},checkenable:function(){this.limitTrialUndo&&0<this.trialpos.length?this.enableUndo=!this.atStartOfTrial():this.enableUndo=0<this.position,this.enableRedo=this.position<this.history.length,this.board.trialstage=this.trialpos.length},allerase:function(){this.lastope=null,this.history=[],this.position=0,this.broken=!1,this.initpos=0,this.changeflag=!1,this.chainflag=!1,this.checkexec(),this.trialpos=[],this.limitTrialUndo=!1,this.puzzle.checker.resetCache()},newOperation:function(){this.changeflag=!1,this.chainflag=!1},newChain:function(){this.chainflag=!1},isModified:function(){return this.broken||this.initpos<this.position},resetModifiedState:function(){this.broken=!1,this.initpos=this.position},removeDescendant:function(){this.position<this.initpos&&(this.broken=!0);for(var e=this.history.length-1;e>=this.position;e--)this.history.pop();this.position=this.history.length,this.chainflag=!1},add:function(e){var t;!this.puzzle.ready||!this.forceRecord&&0<this.disrec||(e.broadcast(),this.enableRedo&&this.removeDescendant(),t=this.puzzle,!this.disCombine&&this.lastope&&e.isModify&&e.isModify(this.lastope)?this.lastope.isNoop&&this.lastope.isNoop()&&(this.history.pop(),this.position--,this.lastope=null):(this.chainflag||(this.history.push(new this.klass.OperationList),this.position++,this.chainflag=!0),this.history[this.history.length-1].push(e),this.lastope=e,this.updateStarts()),"qcmp"!==e.property&&"snum"!==e.property&&t.checker.resetCache(),this.changeflag=!0,this.checkexec())},decodeHistory:function(e){this.allerase(),this.initpos=this.position=e.current||0,this.history=[];for(var t=e.datas||[],i=0,n=t.length;i<n;i++){var s=new this.klass.OperationList,o=(this.history.push(s),t[i]);void 0!==o.time&&(s.time=o.time,o=o.ope);for(var r=0,a=o.length;r<a;r++){for(var h=o[r].split(/,/),l=null,c=this.operationlist,u=0;u<c.length;u++){var d=new c[u];if(d.decode(h)){l=d;break}}l&&(s.push(l),this.lastope=l)}}this.checkexec(),this.trialpos=e.trialpos||[],0<this.trialpos.length&&(this.resumeTrial(),this.limitTrialUndo=!0)},encodeHistory:function(e){e=e||{},this.initpos=this.position;var t={type:"pzpr",version:.4};if(e.time&&(t.time=this.puzzle.getTime()),0<this.history.length){t.current=this.position,0<this.trialpos.length&&(t.trialpos=this.trialpos);for(var i=[],n=0;n<this.history.length;++n){var s=Array.prototype.slice.call(this.history[n]);e.time?i.push({ope:s,time:this.history[n].time}):i.push(s)}t.datas=i}return t},undo:function(){if(!this.enableUndo)return!1;var e=this.history[this.position-1];return this.reqReset=this.checkReqReset(e),this.preproc(),this.undoCore(),this.postproc(),this.enableUndo},redo:function(){if(!this.enableRedo)return!1;var e=this.history[this.position];return this.reqReset=this.checkReqReset(e),this.preproc(),this.redoCore(),this.postproc(),this.enableRedo},undoCore:function(){this.undoExec=!0;for(var e=this.history[this.position-1],t=e.length-1;0<=t;t--)e[t]&&e[t].undo();this.position--,this.undoExec=!1},redoCore:function(){this.redoExec=!0;for(var e=this.history[this.position],t=0;t<e.length;++t)e[t]&&e[t].redo();this.position++,this.redoExec=!1},resumeGoto:function(e){if(e<this.position)for(;e<this.position;)this.undoCore();else if(this.position<e)for(;this.position<e;)this.redoCore();this.checkenable()},checkReqReset:function(e){return e.some(function(e){return e.reqReset})},preproc:function(e){var t=this.puzzle,i=t.board;this.disableRecord(),t.painter.suspend(),t.errclear(),this.updateStarts(),this.reqReset&&i.disableInfo()},postproc:function(){var e=this.puzzle,t=e.board;this.reqReset&&(t.setposAll(),t.setminmax(),t.enableInfo(),t.rebuildInfo(),e.redraw(!0),e.emit("adjust")),e.painter.unsuspend(),this.enableRecord(),this.checkexec()},enterTrial:function(){this.atStartOfTrial()||(this.newOperation(),this.add(new this.puzzle.klass.TrialEnterOperation(this.trialpos.length,this.trialpos.length+1)),this.trialpos.push(this.position-1),this.limitTrialUndo=!0,this.checkexec(),this.newOperation(),this.emitTrial())},acceptTrial:function(){this.trialpos[this.trialpos.length-1]+1===this.position&&(this.position--,this.removeDescendant(),this.trialpos.pop()),0<this.trialpos.length&&(this.newOperation(),this.add(new this.puzzle.klass.TrialFinalizeOperation(this.trialpos)),this.board.trialclear()),this.trialpos=[],this.limitTrialUndo=!1,this.removeDescendant(),this.checkexec(),this.newOperation(),this.emitTrial()},rejectTrial:function(e){0!==this.trialpos.length&&(this.disableRecord(),this.board.errclear(),e||1===this.trialpos.length?(e=this.trialpos[0],this.board.trialclear(),this.trialpos=[],this.limitTrialUndo=!1,this.resumeGoto(e)):(this.resumeGoto(this.trialpos[this.trialpos.length-1]),this.resumeTrial()),this.enableRecord(),this.removeDescendant(),this.checkexec(),this.newOperation(),this.emitTrial())},resumeTrial:function(){var e;0<this.trialpos.length&&(this.disEmitTrial++,e=this.position,this.checkenable(),this.resumeGoto(this.trialpos[0]),this.board.trialclear(!0),this.position<e&&(this.board.trialstage=1,this.resumeGoto(e)),this.disEmitTrial--)},emitTrial:function(e){0===this.disEmitTrial&&this.puzzle.emit("trial",void 0===e?this.trialpos.length:e)}}}),p.classmgr.makeCommon({Bank:{enabled:!1,allowAdd:!1,presets:[],pieces:null,addButton:null,init:function(){this.addButton=new this.klass.BankAddButton},defaultPreset:function(){return[]},applyPreset:function(e){var t;if(e.constant)t=e.constant;else{if(!e.func)return;t=this[e.func]()}e=new this.klass.BankReplaceOperation(t);e.isNoop()||(this.ansclear(),e.redo(),this.puzzle.opemgr.add(e))},initialize:function(e){if(this.pieces=[],e){for(var t in e){var i=new this.klass.BankPiece;i.deserialize(e[t]),this.pieces.push(i)}this.rebuildExtraData(),this.performLayout()}},width:1,height:1,shouldDrawBank:function(){return!0},performLayout:function(){if(this.pieces&&this.width){for(var e=0,t=0,i=0,n=!this.puzzle.playeronly&&!!this.allowAdd,s=this.pieces.length,o=0;o<s+(n?1:0);o++){var r=o<s?this.pieces[o]:this.addButton;e+r.w+1>this.width&&(e=0,t=i),r.x=e,r.y=t,i=Math.max(i,t+r.h+1),r.index=o,e+=r.w+1}n||(this.addButton.index=null),this.height=i}},rebuildExtraData:function(){},draw:function(){this.puzzle.painter.range.bank=!0,this.puzzle.painter.prepaint()},errclear:function(){for(var e=0;e<this.pieces.length;e++)this.pieces[e].seterr(0)},setPiece:function(e,t){e=new this.klass.BankEditOperation(e,t);e.isNoop()||(t<this.pieces.length&&this.pieces[t].setQcmp(0),e.redo(),this.puzzle.opemgr.add(e))},ansclear:function(){this.subclear()},subclear:function(){for(var e=0;e<this.pieces.length;e++)this.pieces[e].setQcmp(0)}},BankPiece:{count:1,mincount:1,maxcount:1,deserialize:function(e){},canonize:function(){return this.serialize()},serialize:function(){return""},w:1,h:1,index:0,x:0,y:0,error:0,qcmp:0,seterr:function(e){this.board.isenableSetError()&&(this.error=e)},setQcmp:function(e){this.addOpe("qcmp",e)},draw:function(){this.puzzle.painter.range.bankPieces.push(this),this.puzzle.painter.prepaint()},addOpe:function(e,t){e=new this.klass.BankPieceOperation(this.index,e,this[e],t);e.isNoop()||(e.redo(),this.puzzle.opemgr.add(e))}},"BankAddButton:BankPiece":{isadd:!0,w:2,h:2,serialize:function(){return""},addOpe:function(){}},"BankEditOperation:Operation":{old:null,num:null,index:null,setData:function(e,t){var i=this.board.bank.pieces.length;if(t<0||i<t)throw Error("Index out of range");this.old=t<i?this.board.bank.pieces[t].serialize():null,this.num=e||null,this.index=t},undo:function(){var e=new this.klass.BankPiece;null!==this.old?(e.deserialize(this.old),null!==this.num?this.board.bank.pieces[this.index]=e:this.board.bank.pieces.splice(this.index,0,e)):(e=this.board.bank.pieces.pop())&&(e.index=null),this.board.bank.rebuildExtraData(),this.board.bank.performLayout(),this.puzzle.painter.resizeCanvas(),this.puzzle.emit("adjust")},redo:function(){var e=new this.klass.BankPiece;null!==this.num&&e.deserialize(this.num),this.index<this.board.bank.pieces.length?null!==this.num?this.board.bank.pieces[this.index]=e:(this.board.bank.pieces[this.index].index=null,this.board.bank.pieces.splice(this.index,1)):this.board.bank.pieces.push(e),this.board.bank.rebuildExtraData(),this.board.bank.performLayout(),this.puzzle.painter.resizeCanvas(),this.puzzle.emit("adjust")},isNoop:function(){return this.old===this.num},toString:function(){return["PP",this.index,this.num,this.old].join(",")},decode:function(e){return"PP"===e[0]&&(this.index=+e[0],this.num=e[1]||null,this.old=e[2]||null,!0)}},"BankReplaceOperation:Operation":{old:[],num:[],setData:function(e,t){this.old=this.board.bank.pieces.map(function(e){return e.serialize()}),e&&"string"!=typeof e?this.num=e:(this.num=this.old.concat(),e?t===this.old.length?this.num.push(e):this.num[t]=e:this.num.splice(t,1))},exec:function(e){this.board.bank.initialize(e),this.puzzle.painter.resizeCanvas(),this.puzzle.emit("adjust")},isNoop:function(){return this.puzzle.pzpr.util.sameArray(this.old,this.num)},toString:function(){return["PR",this.num.join("/"),this.old.join("/")].join(",")},decode:function(e){return"PR"===e[0]&&(this.num=e[1].split("/"),this.old=e[2].split("/"),!0)}},"BankPieceOperation:Operation":{index:0,num:0,old:0,property:"",STRPROP:{K:"qcmp"},isNoop:function(){return this.num===this.old},setData:function(e,t,i,n){this.index=e,this.property=t,this.old=i,this.num=n},exec:function(e){var t=this.board.bank.pieces[this.index];t[this.property]=e,t.draw()},toString:function(){var e,t="P";for(e in this.STRPROP)if(this.property===this.STRPROP[e]){t+=e;break}return[t,this.index,this.num,this.old].join(",")},decode:function(e){return this.property=this.STRPROP[e[0].charAt(1)],!(!this.property||"P"!==e[0].charAt(0))&&(this.index=+e[1],this.num=+e[2],this.old=+e[3],!0)}}}),p.classmgr.makeCommon({Graphic:{paintPost:function(){this.drawTrialStarts()},drawQuesCells:function(){this.vinc("cell_front","crispEdges",!0),this.drawCells_common("c_fullf_",this.getQuesCellColor)},getQuesCellColor:function(e){return null},getQuesCellColor_ques:function(e){return 1!==e.ques?null:1===(e.error||e.qinfo)?this.errcolor1:this.quescolor},getQuesCellColor_qnum:function(e){return-1===e.qnum?null:1===(e.error||e.qinfo)?this.errcolor1:this.quescolor},drawShadedCells:function(){this.vinc("cell_shaded","crispEdges",!0),this.drawCells_common("c_fulls_",this.getShadedCellColor)},getShadedCellColor:function(e){if(1!==e.qans)return null;var t=this.board.haserror||this.board.hasinfo,i=e.error||e.qinfo;return 1===i?this.errcolor1:2===i?this.errcolor2:e.trial?this.trialcolor:this.puzzle.execConfig("irowakeblk")&&!t?e.sblk.color:this.shadecolor},drawBGCells:function(){this.vinc("cell_back","crispEdges",!0),this.drawCells_common("c_fullb_",this.getBGCellColor)},getBGCellColor:function(e){return null},getBGCellColor_error1:function(e){return 1===e.error||1===e.qinfo?this.errbcolor1:null},getBGCellColor_error2:function(e){e=e.error||e.qinfo;return 1===e?this.errbcolor1:2===e?this.errbcolor2:null},getBGCellColor_qcmp:function(e){return 1===e.error||1===e.qinfo?this.errbcolor1:this.puzzle.execConfig("autocmp")&&e.room&&e.room.cmp?this.qcmpbgcolor:null},getBGCellColor_qcmp1:function(e){return 1===e.error||1===e.qinfo?this.errbcolor1:1===e.qsub?this.bcolor:this.puzzle.execConfig("autocmp")&&e.room&&e.room.cmp?this.qcmpbgcolor:null},getBGCellColor_qsub1:function(e){return 1===(e.error||e.qinfo)?this.errbcolor1:1===e.qsub?this.bcolor:null},getBGCellColor_qsub2:function(e){return this.bcolor="silver",1===(e.error||e.qinfo)?this.errbcolor1:1===e.qsub?this.qsubcolor1:2===e.qsub?this.qsubcolor2:null},getBGCellColor_qsub3:function(e){return 1===(e.error||e.qinfo)?this.errbcolor1:1===e.qsub?this.qsubcolor1:2===e.qsub?this.qsubcolor2:3===e.qsub?this.qsubcolor3:null},getBGCellColor_icebarn:function(e){return 1===e.error||1===e.qinfo?6===e.ques?this.erricecolor:this.errbcolor1:6===e.ques?this.icecolor:null},drawCells_common:function(e,t){for(var i=this.context,n=this.range.cells,s=0;s<n.length;s++){var o=n[s],r=t.call(this,o);i.vid=e+o.id,r?(i.fillStyle=r,i.fillRectCenter(o.bx*this.bw+this.getCellHorizontalOffset(o),o.by*this.bh,this.bw+.5,this.bh+.5)):i.vhide()}},getCellHorizontalOffset:function(e){return 0},drawBGExCells:function(){for(var e=this.vinc("excell_back","crispEdges",!0),t=this.range.excells,i=0;i<t.length;i++){var n=t[i],s=this.getBGExCellColor(n);e.vid="ex_full_"+n.id,s?(e.fillStyle=s,e.fillRectCenter(n.bx*this.bw,n.by*this.bh,this.bw+.5,this.bh+.5)):e.vhide()}},getBGExCellColor:function(e){if(1===e.error||1===e.qinfo)return this.errbcolor1},drawDotCells:function(){for(var e=this.vinc("cell_dot","auto",!0),t=Math.max(.06*this.cw,2),i=this.range.cells,n=0;n<i.length;n++){var s=i[n];e.vid="c_dot_"+s.id,s.isDot()?(e.fillStyle=s.trial?this.trialcolor:this.qanscolor,e.fillCircle(s.bx*this.bw,s.by*this.bh,t)):e.vhide()}},drawCellArrows:function(e,t){var i,n,s=this.vinc("cell_arrow","auto"),o=e?(i=.35*this.cw,r=.12*this.cw,n=0,.35*this.cw):(i=.4*this.cw,r=.03*this.cw,n=.16*this.cw,.16*this.cw),r=1<=r?r:1;o=5<=o?o:5;for(var a=this.range.cells,h=0;h<a.length;h++){var l=a[h],c=l.numberAsObject?l.getNum():l.qdir,u=1<=c&&c<=4?this.getCellArrowColor(l):null;if(s.vid="c_arrow_"+l.id,u){s.lineWidth=1.5,s.strokeStyle=s.fillStyle=u,s.beginPath();var d=l.bx*this.bw,b=l.by*this.bh;switch(c){case l.UP:s.setOffsetLinePath(d,b,0,-i,-o,-n,-r,-n,-r,i,r,i,r,-n,o,-n,!0);break;case l.DN:s.setOffsetLinePath(d,b,0,i,-o,n,-r,n,-r,-i,r,-i,r,n,o,n,!0);break;case l.LT:s.setOffsetLinePath(d,b,-i,0,-n,-o,-n,-r,i,-r,i,r,-n,r,-n,o,!0);break;case l.RT:s.setOffsetLinePath(d,b,i,0,n,-o,n,-r,-i,-r,-i,r,n,r,n,o,!0)}t?s.stroke():s.fill()}else s.vhide()}},getCellArrowColor:function(e){var t=e.numberAsObject?e.getNum():e.qdir;return 1<=t&&t<=4?e.numberAsObject&&-1===e.qnum?e.trial?this.trialcolor:this.qanscolor:this.quescolor:null},drawSlashes:function(){for(var e=this.vinc("cell_slash","auto"),t=Math.max(this.bw/4,2),i=this.puzzle.execConfig("irowake"),n=this.range.cells,s=0;s<=1;s++)for(var o=0;o<n.length;o++){var r,a,h,l=n[o],c=(e.vid="c_slash_"+s+"_"+l.id,31<=l.ques&&l.ques<=33),u=c?l.ques:l.qans;33===u||u===(s?32:31)?(h=l.qinfo||l.error,r=0,c||l.trial&&this.puzzle.execConfig("irowake")?r=-t/2:"gokigen"!==this.pid&&"wagiri"!==this.pid||1!==h&&3!==h||(r=t/2),c?a=this.quescolor:"kinkonkan"!==this.pid&&0<h?h&(s?4:8)?a=this.noerrcolor:1&h?a=this.errcolor1:2&h&&(a=this.errcolor2):a=-1===h?this.noerrcolor:i&&33===u?(!!s===l.parity()?l.path:l.path2).color:i&&l.path&&l.path.color?l.path.color:i&&l.path2&&l.path2.color?l.path2.color:l.trial?this.linetrialcolor:this.linecolor,e.lineWidth=t+r,e.strokeStyle=a,e.beginPath(),c=l.bx*this.bw,h=l.by*this.bh,s?e.setOffsetLinePath(c,h,this.bw,-this.bh,-this.bw,this.bh,!0):e.setOffsetLinePath(c,h,-this.bw,-this.bh,this.bw,this.bh,!0),e.stroke()):e.vhide()}},drawQuesNumbers:function(){this.vinc("cell_number","auto"),this.drawNumbers_com(this.getQuesNumberText,this.getQuesNumberColor,"cell_text_",this.textoption)},drawAnsNumbers:function(){this.vinc("cell_ans_number","auto"),this.drawNumbers_com(this.getAnsNumberText,this.getAnsNumberColor,"cell_ans_text_",{})},drawHatenas:function(){this.vinc("cell_number","auto"),this.drawNumbers_com(function(e){return-2===e.ques||-2===e.qnum?"?":""},this.getQuesNumberColor_qnum,"cell_text_",this.textoption)},drawNumbers_com:function(e,t,i,n){for(var s=this.context,o=this.range.cells,r=0;r<o.length;r++){var a,h=o[r],l=e.call(this,h);s.vid=i+h.id,l?(s.fillStyle=t.call(this,h),a=h.bx*this.bw+this.getCellHorizontalOffset(h),h=h.by*this.bh+this.getNumberVerticalOffset(h),this.disptext(l,a,h,n)):s.vhide()}},getNumberVerticalOffset:function(e){return 0},getQuesNumberText:function(e){return this.getNumberText(e,(this.puzzle.execConfig("dispmove")?e.base:e).qnum)},getAnsNumberText:function(e){return this.getNumberText(e,e.anum)},getNumberText:function(e,t){return e.numberAsLetter?this.getNumberTextCore_letter(t):this.getNumberTextCore(t)},getNumberTextCore:function(e){var t="yajilin"!==this.pid&&"koburin"!==this.pid?this.hideHatena:2===this.puzzle.getConfig("disptype_yajilin");return 0<=e?""+e:t||-2!==e?"":"?"},getNumberTextCore_letter:function(e){var t=""+e;return-1===e?t="":-2===e?t="?":0<e&&e<=26?t=(e+9).toString(36).toUpperCase():26<e&&e<=52&&(t=(e-17).toString(36).toLowerCase()),t},getQuesNumberColor:function(e){return null},getQuesNumberColor_fixed:function(e){return this.quescolor},getQuesNumberColor_fixed_shaded:function(e){return this.fontShadecolor},getQuesNumberColor_qnum:function(e){return 1===(e.error||e.qinfo)?this.errcolor1:this.quescolor},getQuesNumberColor_move:function(e){var t=this.puzzle,i=e.error||e.qinfo;return 1===i||4===i?this.errcolor1:t.execConfig("dispmove")&&t.mouse.mouseCell===e?this.movecolor:this.quescolor},getQuesNumberColor_mixed:function(e){var t=e.error||e.qinfo;return 1<=e.ques&&e.ques<=5||1===e.qans?this.fontShadecolor:1===t||4===t?this.errcolor1:this.quescolor},getAnsNumberColor:function(e){return 1===(e.error||e.qinfo)?this.errcolor1:e.trial?this.trialcolor:this.qanscolor},drawNumbersExCell:function(){for(var e=this.vinc("excell_number","auto"),t=this.range.excells,i=0;i<t.length;i++){var n=t[i],s=this.getQuesNumberText(n);e.vid="excell_text_"+n.id,s?(e.fillStyle=this.getQuesNumberColor(n),this.disptext(s,n.bx*this.bw,n.by*this.bh)):e.vhide()}},drawSubNumbers:function(e){for(var t=this.vinc("cell_subnumber","auto"),i=[5,4,2,3],n=this.range.cells,s=0;s<n.length;s++)for(var o=n[s],r=0;r<4;r++){var a,h=o.numberAsLetter?this.getNumberTextCore_letter(o.snum[r]):this.getNumberTextCore(o.snum[r]);t.vid="cell_subtext_"+o.id+"_"+r,h?(t.fillStyle=e&&o.isShade()?this.subshadecolor:o.trial?this.trialcolor:this.subcolor,a=o.bx*this.bw+this.getCellHorizontalOffset(o),this.disptext(h,a,o.by*this.bh,{position:i[r],ratio:.33,hoffset:.8})):t.vhide()}},drawArrowNumbers:function(e){for(var t=this.vinc("cell_arrownumber","auto"),i=e&&e.scale||1,n=.4*this.cw*i,s=.03*this.cw*i,o=.16*this.cw*i,r=.12*this.cw*i,a=.6*-this.bh,h=[.6*this.bw,.7*this.bw,.8*this.bw,.85*this.bw],l=(e&&e.bottom&&(a*=-1),this.range.cells),c=0;c<l.length;c++){var u,d=l[c],b=d.qdir,m=this.getQuesNumberText(d),p=d.bx*this.bw,f=d.by*this.bh,g=m.length-1;if(m&&(t.fillStyle=this.getQuesNumberColor(d)),t.vid="cell_arrow_"+d.id,m&&b!==d.NDIR){switch(t.beginPath(),b){case d.UP:t.setOffsetLinePath(p+h[g]*i,f,0,-n,-r,-o,-s,-o,-s,n,s,n,s,-o,r,-o,!0);break;case d.DN:t.setOffsetLinePath(p+h[g]*i,f,0,n,-r,o,-s,o,-s,-n,s,-n,s,o,r,o,!0);break;case d.LT:t.setOffsetLinePath(p,f+a,-n,0,-o,-r,-o,-s,n,-s,n,s,-o,s,-o,r,!0);break;case d.RT:t.setOffsetLinePath(p,f+a,n,0,o,-r,o,-s,-n,-s,-n,s,o,s,o,r,!0)}t.fill()}else t.vhide();t.vid="cell_arnum_"+d.id,m?(u={ratio:this.fontsizeratio},b!==d.NDIR&&(u.ratio=e&&e.arrowfontsize?e.arrowfontsize:.7),b===d.UP||b===d.DN?p-=.1*this.cw:b!==d.LT&&b!==d.RT||(f+=.1*this.ch*(e&&e.bottom?-.5:1)),this.disptext(m,p,f,u)):t.vhide()}},drawCircledNumbers:function(){this.drawCircles(),this.vinc("cell_number","auto"),this.drawNumbers_com(this.getQuesNumberText,this.getQuesNumberColor,"cell_text_",{ratio:.65})},drawTapaNumbers:function(){for(var e=this.vinc("cell_tapanum","auto"),t=this.bw,i=this.bh,n=[{option:{},pos:[{x:0,y:0}]},{option:{ratio:.56},pos:[{x:-.4,y:-.4},{x:.4,y:.4}]},{option:{ratio:.48},pos:[{x:-.5,y:-.4},{x:.5,y:-.4},{x:0,y:.4}]},{option:{ratio:.4},pos:[{x:-.55,y:0},{x:0,y:-.5},{x:.55,y:0},{x:0,y:.5}]}],s=this.range.cells,o=0;o<s.length;o++)for(var r,a,h,l,c=s[o],u=c.bx,d=c.by,b=c.qnums,m=b.length,p=0;p<4;p++)e.fillStyle=this.getQuesNumberColor(c,p),e.vid="cell_text_"+c.id+"_"+p,p<m&&-1!==b[p]&&m<=4?(a=(u+(r=n[m-1]).pos[p].x)*t,h=(d+r.pos[p].y)*i,l=0<=b[p]?""+b[p]:"?",this.disptext(l,a,h,r.option)):e.vhide()},drawCrosses:function(){for(var e=this.vinc("cross_base","auto",!0),t=this.cw*this.crosssize+1,i=(e.lineWidth=1,{ratio:.6}),n=this.range.crosses,s=0;s<n.length;s++){var o=n[s],r=o.bx*this.bw,a=o.by*this.bh;e.vid="x_cp_"+o.id,-1!==o.qnum?(e.fillStyle=1===o.error||1===o.qinfo?this.errcolor1:"white",e.strokeStyle="black",e.shapeCircle(r,a,t)):e.vhide(),e.vid="cross_text_"+o.id,0<=o.qnum?(e.fillStyle=this.quescolor,this.disptext(""+o.qnum,r,a,i)):e.vhide()}},drawCrossMarks:function(){for(var e=this.vinc("cross_mark","auto",!0),t=this.cw*this.crosssize,i=this.range.crosses,n=0;n<i.length;n++){var s=i[n];e.vid="x_cm_"+s.id,1===s.qnum?(e.fillStyle=1===s.error||1===s.qinfo?this.errcolor1:this.quescolor,e.fillCircle(s.bx*this.bw,s.by*this.bh,t)):e.vhide()}},drawBorders:function(){this.vinc("border","crispEdges",!0),this.drawBorders_common("b_bd_")},drawBorders_common:function(e){for(var t=this.context,i=this.range.borders,n=0;n<i.length;n++){var s,o,r,a=i[n],h=this.getBorderColor(a);t.vid=e+a.id,h?(s=a.bx*this.bw+this.getBorderHorizontalOffset(a),o=a.by*this.bh,r=(this.lw+this.addlw)/2,t.fillStyle=h,a.isVert()?t.fillRectCenter(s,o,r,this.bh+r):t.fillRectCenter(s,o,this.bw+r,r)):t.vhide()}},getBorderHorizontalOffset:function(e){return 0},getBorderColor:function(e){return null},getBorderColor_ques:function(e){return e.isBorder()?this.quescolor:null},getBorderColor_qans:function(e){var t=e.error||e.qinfo;return e.isBorder()?1===t?this.errcolor1:-1===t?this.noerrcolor:e.trial?this.linetrialcolor:this.qanscolor:e.isCmp&&e.isCmp()?this.qcmpcolor:null},getBorderColor_ice:function(e){var t=e.sidecell[0],i=e.sidecell[1];return e.inside&&!t.isnull&&!i.isnull&&t.ice()^i.ice()?this.quescolor:null},drawQuesBorders:function(){this.vinc("border_question","crispEdges",!0),this.getBorderColor=this.getQuesBorderColor,this.drawBorders_common("b_bdques_")},drawQansBorders:function(){this.vinc("border_answer","crispEdges",!0),this.getBorderColor=this.getQansBorderColor,this.drawBorders_common("b_bdans_")},getQuesBorderColor:function(e){return 1<=e.ques?this.getBorderColor_ques(e):null},getQansBorderColor:function(e){return 1<=e.qans?this.getBorderColor_qans(e):null},drawBorderQsubs:function(){for(var e=this.vinc("border_qsub","crispEdges",!0),t=.15*this.cw,i=this.range.borders,n=0;n<i.length;n++){var s,o,r=i[n];e.vid="b_qsub1_"+r.id,1===r.qsub?(s=r.bx*this.bw+this.getBorderHorizontalOffset(r),o=r.by*this.bh,e.fillStyle=r.trial?this.linetrialcolor:this.pekecolor,r.isHorz()?e.fillRectCenter(s,o,.5,this.bh-t):e.fillRectCenter(s,o,this.bw-t,.5)):e.vhide()}},drawBoxBorders:function(e){for(var t=this.vinc("boxborder","crispEdges"),i=this.lm,n=this.cw,s=this.ch,o=(t.strokeStyle=this.bbcolor,t.lineWidth=1,this.range.cells),r=0;r<o.length;r++){var a,h,l,c,u,d,b,m,p,f,g,k,v,y,w=o[r],x=1===w.qans;"stostone"===this.pid&&this.board.falling&&(x=!1),t.vid="c_bb_"+w.id,x?(a=(x=(w.bx-1)*this.bw)-.5,h=x+i+.5,l=x+n-i-.5,x=x+n+.5,c=(b=(w.by-1)*this.bh)-.5,u=b+i+.5,d=b+s-i-.5,b=b+s+.5,k=w.adjborder,m=2<w.by,p=w.by<2*this.board.rows-2,f=2<w.bx,g=w.bx<2*this.board.cols-2,m=!m||k.top.isBorder(),p=!p||k.bottom.isBorder(),f=!f||k.left.isBorder(),g=!g||k.right.isBorder(),k=m||f||w.relbd(-2,-1).isBorder()||w.relbd(-1,-2).isBorder(),v=m||g||w.relbd(2,-1).isBorder()||w.relbd(1,-2).isBorder(),y=p||f||w.relbd(-2,1).isBorder()||w.relbd(-1,2).isBorder(),w=p||g||w.relbd(2,1).isBorder()||w.relbd(1,2).isBorder(),t.beginPath(),(m||k)&&t.moveTo(h,u),!m&&k&&t.lineTo(h,c),!m&&v&&t.moveTo(l,c),m||v?t.lineTo(l,u):(g||v)&&t.moveTo(l,u),!g&&v&&t.lineTo(x,u),!g&&w&&t.moveTo(x,d),g||w?t.lineTo(l,d):(p||w)&&t.moveTo(l,d),!p&&w&&t.lineTo(l,b),!p&&y&&t.moveTo(h,b),p||y?t.lineTo(h,d):(f||y)&&t.moveTo(h,d),!f&&y&&t.lineTo(a,d),!f&&k&&t.moveTo(a,u),(f||k)&&t.lineTo(h,u),t.stroke()):t.vhide()}},drawLines:function(){for(var e=this.vinc("line","crispEdges"),t=this.range.borders,i=0;i<t.length;i++){var n,s,o,r=t[i],a=this.getLineColor(r);e.vid="b_line_"+r.id,a?(n=r.bx*this.bw,s=r.by*this.bh,r=this.board.borderAsLine===r.isVert(),o=this.lm+this.addlw/2,e.fillStyle=a,r?e.fillRectCenter(n,s,o,this.bh+o):e.fillRectCenter(n,s,this.bw+o,o)):e.vhide()}this.addlw=0},getLineColor:function(e){var t,i,n,s;return this.addlw=0,e.isLine()?(t=e.error||e.qinfo,n=(i=this.puzzle).execConfig("irowake")&&e.path&&e.path.color,s=i.execConfig("dispmove"),e.trial&&i.execConfig("irowake")?this.addlw=-this.lm:1===t&&(this.addlw=1),1===t?this.errlinecolor:-1===t?this.noerrcolor:s?e.trial?this.movetrialcolor:this.movelinecolor:n?e.path.color:e.trial?this.linetrialcolor:this.linecolor):null},drawTip:function(){for(var e=this.vinc("cell_linetip","auto"),t=.3*this.cw,i=.05*this.cw,n=this.range.cells,s=0;s<n.length;s++){var o,r=n[s],a=0,h=null;1!==r.lcnt||-1!==r.qnum||this.puzzle.execConfig("dispmove")||((o=r.adjborder).top.isLine()?(a=2,h=o.top):o.bottom.isLine()?(a=1,h=o.bottom):o.left.isLine()?(a=4,h=o.left):o.right.isLine()&&(a=3,h=o.right)),e.vid="c_tip_"+r.id,0!==a?(e.strokeStyle=this.getLineColor(h)||this.linecolor,e.lineWidth=this.lw+this.addlw,e.beginPath(),o=r.bx*this.bw+1,h=r.by*this.bh+1,1===a?e.setOffsetLinePath(o,h,-t,t,0,-i,t,t,!1):2===a?e.setOffsetLinePath(o,h,-t,-t,0,i,t,-t,!1):3===a?e.setOffsetLinePath(o,h,t,-t,-i,0,t,t,!1):4===a&&e.setOffsetLinePath(o,h,-t,-t,i,0,-t,t,!1),e.stroke()):e.vhide()}},drawPekes:function(){for(var e=this.vinc("border_peke","auto",!0),t=.15*this.cw+1,i=(t<4&&(t=4),e.lineWidth=1+this.cw/40|0,this.range.borders),n=0;n<i.length;n++){var s=i[n];e.vid="b_peke_"+s.id,2===s.qsub?(e.strokeStyle=s.trial?this.trialcolor:this.pekecolor,e.strokeCross(s.bx*this.bw,s.by*this.bh,t-1)):e.vhide()}},drawBaseMarks:function(e){for(var t=this.vinc("cross_mark","auto",!0),i=(t.fillStyle=this.quescolor,this.cw/10),n=this.range.crosses,s=0;s<n.length;s++){var o=n[s];t.vid="x_cm_"+o.id,!1!==e?t.fillCircle(o.bx*this.bw,o.by*this.bh,i/2):t.vhide()}},drawTriangle:function(){for(var e=this.vinc("cell_triangle","crispEdges"),t=this.range.cells,i=0;i<t.length;i++){var n=t[i],s=0!==n.ques?n.ques:n.qans;e.vid="c_tri_"+n.id,2<=s&&s<=5?(e.fillStyle=this.getTriangleColor(n),this.drawTriangle1(n.bx*this.bw,n.by*this.bh,s)):e.vhide()}},getTriangleColor:function(e){return this.quescolor},drawTriangle1:function(e,t,i){var n=this.context,s="reflect"===this.pid?1:.5,o=this.bw+1-s,r=this.bh+1-s;switch(n.beginPath(),i){case 2:n.setOffsetLinePath(e,t,-o,-r,-o,r,o,r,!0);break;case 3:n.setOffsetLinePath(e,t,o,-r,-o,r,o,r,!0);break;case 4:n.setOffsetLinePath(e,t,-o,-r,o,-r,o,r,!0);break;case 5:n.setOffsetLinePath(e,t,-o,-r,o,-r,-o,r,!0)}n.fill()},drawTriangle2:function(e,t,i){var n=this.context,s=this.bw+1,o=this.bh+1;switch(n.beginPath(),i){case 1:n.setOffsetLinePath(e,t,0,0,-s,-o,s,-o,!0);break;case 2:n.setOffsetLinePath(e,t,0,0,-s,o,s,o,!0);break;case 3:n.setOffsetLinePath(e,t,0,0,-s,-o,-s,o,!0);break;case 4:n.setOffsetLinePath(e,t,0,0,s,-o,s,o,!0)}n.fill()},drawMBs:function(){for(var e=this.vinc("cell_mb","auto",!0),t=(e.lineWidth=1,.35*this.cw),i=this.range.cells,n=0;n<i.length;n++){var s,o,r=i[n];0<r.qsub&&(s=r.bx*this.bw,o=r.by*this.bh,e.strokeStyle=r.trial?"rgb(192, 192, 192)":this.mbcolor),e.vid="c_MB1_"+r.id,1===r.qsub?e.strokeCircle(s,o,t):e.vhide(),e.vid="c_MB2_"+r.id,2===r.qsub?e.strokeCross(s,o,t):e.vhide()}},drawBorderAuxDir:function(){for(var e=this.vinc("border_dirsub","crispEdges"),t=.1*this.cw,i=(e.lineWidth=.1*this.cw,this.range.borders),n=0;n<i.length;n++){var s=i[n],o=s.bx*this.bw,r=s.by*this.bh,a=s.qsub-10;if(e.vid="b_daux_"+s.id,1<=a&&a<=8){switch(e.strokeStyle=s.trial?this.linetrialcolor:"rgb(64,64,64)",e.beginPath(),a){case s.UP:e.setOffsetLinePath(o,r,2*-t,t,0,-t,2*t,t,!1);break;case s.DN:e.setOffsetLinePath(o,r,2*-t,-t,0,t,2*t,-t,!1);break;case s.LT:e.setOffsetLinePath(o,r,t,2*-t,-t,0,t,2*t,!1);break;case s.RT:e.setOffsetLinePath(o,r,-t,2*-t,t,0,-t,2*t,!1)}e.stroke()}else e.vhide()}},drawCircles:function(){for(var e=this.vinc("cell_circle","auto",!0),t=this.circleratio,i=this.cw*(t[0]+t[1])/2,n=this.cw*t[0],s=this.range.cells,o=0;o<s.length;o++){var r=s[o],a=this.getCircleFillColor(r);e.vid="c_cirb_"+r.id,a?(e.fillStyle=a,e.fillCircle(r.bx*this.bw+this.getCellHorizontalOffset(r),r.by*this.bh,n)):e.vhide()}(e=this.vinc("cell_circle_stroke","auto",!0)).lineWidth=Math.max(this.cw*(t[0]-t[1]),1);for(o=0;o<s.length;o++){r=s[o],a=this.getCircleStrokeColor(r);e.vid="c_cira_"+r.id,a?(e.strokeStyle=a,e.strokeCircle(r.bx*this.bw+this.getCellHorizontalOffset(r),r.by*this.bh,i)):e.vhide()}},getCircleStrokeColor:function(e){return null},getCircleStrokeColor_qnum:function(e){var t=this.puzzle,i=e.error||e.qinfo,n=t.execConfig("dispmove");return-1!==(n?e.base:e).qnum?n&&t.mouse.mouseCell===e?this.movecolor:1===i||4===i?this.errcolor1:this.quescolor:null},getCircleStrokeColor_qnum2:function(e){return 1===e.qnum?1===e.error?this.errcolor1:this.quescolor:null},getCircleFillColor:function(e){return null},getCircleFillColor_qnum:function(e){return-1!==e.qnum?1===(e=e.error||e.qinfo)||4===e?this.errbcolor1:this.circlebasecolor:null},getCircleFillColor_qnum2:function(e){return 1===e.qnum?1===e.error?this.errbcolor1:"white":2===e.qnum?1===e.error?this.errcolor1:this.quescolor:null},getCircleFillColor_qcmp:function(e){var t=this.puzzle,i=e.error||e.qinfo;return-1!==(t.execConfig("dispmove")?e.base:e).qnum?1===i||4===i?this.errbcolor1:e.isCmp()?this.qcmpcolor:this.circlebasecolor:null},drawDepartures:function(){for(var e=this.vinc("cell_depart","auto",!0),t=(e.fillStyle=this.movelinecolor,.15*this.cw),i=this.puzzle.execConfig("dispmove"),n=this.range.cells,s=0;s<n.length;s++){var o,r=n[s];e.vid="c_dcir_"+r.id,i&&r.isDeparture()?(o=r.bx*this.bw,r=r.by*this.bh,e.fillCircle(o,r,t)):e.vhide()}},drawLineParts:function(){for(var e=this.vinc("cell_lineparts","crispEdges"),t=(e.fillStyle=this.quescolor,this.lm),i=this.bw,n=this.bh,s=this.range.cells,o=0;o<s.length;o++){var r,a,h,l,c,u,d,b=s[o],m=b.ques;e.vid="c_lp_"+b.id,11<=m&&m<=17?(r=(l=b.bx*this.bw)-i-.5,a=l-t,h=l+t,l=l+i+.5,c=(b=b.by*this.bh)-n-.5,u=b-t,d=b+t,b=b+n+.5,m={11:15,12:3,13:12,14:9,15:5,16:6,17:10}[m],e.beginPath(),e.moveTo(a,u),1&m&&(e.lineTo(a,c),e.lineTo(h,c)),e.lineTo(h,u),8&m&&(e.lineTo(l,u),e.lineTo(l,d)),e.lineTo(h,d),2&m&&(e.lineTo(h,b),e.lineTo(a,b)),e.lineTo(a,d),4&m&&(e.lineTo(r,d),e.lineTo(r,u)),e.closePath(),e.fill()):e.vhide()}},drawTateyokos:function(){for(var e=this.vinc("cell_tateyoko","crispEdges"),t=Math.max(this.cw/6,3)/2,i=this.range.cells,n=0;n<i.length;n++){var s=i[n],o=s.bx*this.bw,r=s.by*this.bh,a=s.qans;e.vid="c_bar1_"+s.id,11===a||12===a?(e.fillStyle=this.getBarColor(s,!0),e.fillRectCenter(o,r,t+this.addlw/2,this.bh)):e.vhide(),e.vid="c_bar2_"+s.id,11===a||13===a?(e.fillStyle=this.getBarColor(s,!1),e.fillRectCenter(o,r,this.bw,t+this.addlw/2)):e.vhide()}this.addlw=0},getBarColor:function(e,t){var i=e.error,t=1===i||4===i||5===i&&t||6===i&&!t,n="";return this.addlw=0,t?(n=this.errlinecolor,this.addlw=1):n=0!==i?this.noerrcolor:e.trial?this.linetrialcolor:this.linecolor,n},drawQues51:function(){this.drawExCellGrid(),this.drawTargetTriangle(),this.drawSlash51Cells(),this.drawSlash51ExCells()},drawSlash51Cells:function(){for(var e=this.vinc("cell_ques51","crispEdges",!0),t=(e.strokeStyle=this.quescolor,e.lineWidth=1,this.range.cells),i=0;i<t.length;i++){var n,s,o=t[i];e.vid="c_slash51_"+o.id,51===o.ques?(n=o.bx*this.bw,s=o.by*this.bh,e.strokeLine(n-this.bw,s-this.bh,n+this.bw,s+this.bh)):e.vhide(),e.vid="c_slash51b_"+o.id,51===o.ques&&4===o.dirs51?(n=o.bx*this.bw,s=o.by*this.bh,e.strokeLine(n-this.bw,s+this.bh,n+this.bw,s-this.bh)):e.vhide()}},drawSlash51ExCells:function(){for(var e=this.vinc("excell_ques51","crispEdges",!0),t=(e.strokeStyle=this.quescolor,e.lineWidth=1,this.range.excells),i=0;i<t.length;i++){var n=t[i],s=n.bx*this.bw,o=n.by*this.bh;e.vid="ex_slash51_"+n.id,e.strokeLine(s-this.bw,o-this.bh,s+this.bw,o+this.bh)}},drawExCellGrid:function(){for(var e=this.vinc("grid_excell","crispEdges",!0),t=(e.fillStyle=this.quescolor,this.range.excells),i=0;i<t.length;i++){var n=t[i],s=n.bx*this.bw,o=n.by*this.bh;e.vid="ex_bdx_"+n.id,-1===n.by&&n.bx<this.board.maxbx?e.fillRectCenter(s+this.bw,o,.5,this.bh):e.vhide(),e.vid="ex_bdy_"+n.id,-1===n.bx&&n.by<this.board.maxby?e.fillRectCenter(s,o+this.bh,this.bw,.5):e.vhide()}},drawQuesNumbersOn51:function(){this.vinc("cell_number51","auto");for(var e=this.range,t=1|e.x1;t<=e.x2;t+=2)for(var i=1|e.y1;i<=e.y2;i+=2){var n=this.board.getobj(t,i);n.isnull||(4===n.dirs51?this.drawQuesNumbersOn51_2(n):this.drawQuesNumbersOn51_1(n))}},drawQuesNumbersOn51_1:function(e){var t,i,n=this.context,s=e.bx*this.bw,o=e.by*this.bh,r={ratio:.45};n.fillStyle=1===e.error||1===e.qinfo?this.errcolor1:this.quescolor,i=e.relcell(2,0),t=51===e.ques?e.qnum:-1,n.vid=[e.group,e.id,"text_ques51_rt"].join("_"),0<=t&&!i.isnull&&51!==i.ques?(r.position=this.TOPRIGHT,this.disptext(""+t,s,o,r)):n.vhide(),i=e.relcell(0,2),t=51===e.ques?e.qnum2:-1,n.vid=[e.group,e.id,"text_ques51_dn"].join("_"),0<=t&&!i.isnull&&51!==i.ques?(r.position=this.BOTTOMLEFT,this.disptext(""+t,s,o,r)):n.vhide()},drawQuesNumbersOn51_2:function(e){var t,i=this.context,n=e.bx*this.bw,s=e.by*this.bh,o={ratio:.4,width:[.35,.23,.15]};i.fillStyle=1===e.error||1===e.qinfo?this.errcolor1:this.quescolor;for(var r=1;r<=4;r++)t=e.getQnumDir(r),i.vid=[e.group,e.id,"text_ques51",r].join("_"),0<=t?(o.position=r+5,this.disptext(""+t,n,s,o)):i.vhide()},drawTarget:function(){this.drawCursor(!0,this.puzzle.editmode)},drawCursor:function(e,t){this.drawRawCursor("target_cursor","",this.puzzle.cursor,e,!1!==t&&this.puzzle.getConfig("cursor"),this.puzzle.editmode?this.targetColorEdit:this.targetColorPlay)},drawTrialStarts:function(){for(var e=this.puzzle.opemgr.savedStarts,t=0;t<e.length;t++){var i=e[t];this.drawRawCursor("trial_cursor","trial_"+t,i,!1,!i.isnull&&this.puzzle.getConfig("trialmarker"),this.targetColorTrial)}},drawRawCursor:function(e,t,i,n,s,o){var r,a,e=this.vinc(e,"crispEdges"),h=i.bx*this.bw,l=i.by*this.bh,c=i.group?i:i.getobj();c&&"cell"===c.group?h+=this.getCellHorizontalOffset(c):c&&"border"===c.group&&(h+=this.getBorderHorizontalOffset(c)),n=c=!1!==n?(r=0|Math.max(this.cw/16,2),this.bw-.5):(r=0|Math.max(this.cw/24,1),.56*this.bw),"number"==typeof i.bankpiece&&(a=this.board.bank.pieces[i.bankpiece],(a=i.bankpiece===this.board.bank.pieces.length?this.board.bank.addButton:a)?(i=this.puzzle.painter.bankratio,h=(a.x+.25+a.w/2)*this.cw*i,l=(a.y+.25+a.h/2)*this.ch*i,l+=(this.board.rows+.5)*this.ch,c=(a.w+.25)*this.cw*i*.5,n=(a.h+.25)*this.ch*i*.5):s=!1),s=!1!==s&&!this.outputImage,e.fillStyle=o,e.vid=t+"ti1_",s?e.fillRect(h-c,l-n,2*c,r):e.vhide(),e.vid=t+"ti2_",s?e.fillRect(h-c,l-n,r,2*n):e.vhide(),e.vid=t+"ti3_",s?e.fillRect(h-c,l+n-r,2*c,r):e.vhide(),e.vid=t+"ti4_",s?e.fillRect(h+c-r,l-n,r,2*n):e.vhide()},drawTargetSubNumber:function(e){var t,i,n,s,o=this.vinc("target_subnum","crispEdges"),r=this.range,a=this.puzzle.cursor;a.bx<r.x1||r.x2<a.bx||a.by<r.y1||r.y2<a.by||(r=a.targetdir,i=a.getc(),a.disableAnum&&-1===this.puzzle.mouse.inputMode.indexOf("number")&&(r=0),o.vid="target_subnum",o.fillStyle=e&&i&&i.isShade()?this.ttshadecolor:this.ttcolor,this.puzzle.playmode&&0!==r?(e=this.bw,t=this.bh,i=a.bx*e+.5+this.getCellHorizontalOffset(i),a=a.by*t+.5,n=.8*e,s=.8*t,5===r?o.fillRect(i-e,a-t,n,s):4===r?o.fillRect(i+e-n,a-t,n,s):2===r?o.fillRect(i-e,a+t-s,n,s):3===r&&o.fillRect(i+e-n,a+t-s,n,s)):o.vhide())},drawTargetTriangle:function(){var e=this.vinc("target_triangle","auto"),t=this.range,i=this.puzzle.cursor;i.bx<t.x1||t.x2<i.bx||i.by<t.y1||t.y2<i.by||(t=i.detectTarget(),e.vid="target_triangle",e.fillStyle=this.ttcolor,this.puzzle.editmode&&0!==t?4===i.targetdirs?this.drawTriangle2(i.bx*this.bw,i.by*this.bh,t):this.drawTriangle1(i.bx*this.bw,i.by*this.bh,4===t?4:2):e.vhide())},drawStartGoal:function(){var e=this.vinc("cell_sg","auto"),t=this.board,i=this.range,n=(e.vid="text_stpos",t.startpos?t.startpos.getc():t.emptycell);n.bx>=i.x1&&i.x2>=n.bx&&n.by>=i.y1&&i.y2>=n.by&&(n.isnull?e.vhide():(e.fillStyle=this.puzzle.mouse.draggingSG&&10===this.puzzle.mouse.inputData?"red":1===n.qans?this.fontShadecolor:this.quescolor,this.disptext("S",n.bx*this.bw,n.by*this.bh))),e.vid="text_glpos",(n=t.goalpos.getc()).bx>=i.x1&&i.x2>=n.bx&&n.by>=i.y1&&i.y2>=n.by&&(n.isnull?e.vhide():(e.fillStyle=this.puzzle.mouse.draggingSG&&11===this.puzzle.mouse.inputData?"red":1===n.qans?this.fontShadecolor:this.quescolor,this.disptext("G",n.bx*this.bw,n.by*this.bh)))},fillStar:function(e,t,i,n,s){var o=[0,.235,.95,.38,.588,0,-.588,-.38,-.95,-.235],r=[-1,-.309,-.309,.124,.809,.4,.809,.124,-.309,-.309];e.beginPath(),e.moveTo(t,i-s);for(var a=1;a<10;a++)e.lineTo(t+n*o[a],i+s*r[a]);e.closePath(),e.fill()},getDotFillColor:function(e){return 1===e.getDot()?"white":2===e.getDot()?e.iserror()?this.errcolor1:this.quescolor:null},getDotOutlineColor:function(e){return 1===e.getDot()?e.iserror()?this.errcolor1:this.quescolor:null},getDotRadius:function(e){return.18},drawDots:function(){for(var e=this.vinc("dot","auto"),t=(e.lineWidth=Math.max(.04*this.cw,1),this.range),i=this.board.dotinside(t.x1,t.y1,t.x2,t.y2),n=0;n<i.length;n++){var s=i[n],o=s.bx,r=s.by,a=(e.vid="s_dot_"+s.id,this.getDotOutlineColor(s)),h=this.getDotFillColor(s);h||a?(e.strokeStyle=a,e.fillStyle=h,e.shapeCircle(o*this.bw,r*this.bh,this.cw*this.getDotRadius(s))):e.vhide()}},drawDashedCenterLines:function(){var e=this.vinc("centerline","crispEdges",!0),t=this.board,i=this.range.x1,n=this.range.y1,s=this.range.x2,o=this.range.y2,r=(i<t.minbx+1&&(i=t.minbx+1),s>t.maxbx-1&&(s=t.maxbx-1),n<t.minby+1&&(n=t.minby+1),o>t.maxby-1&&(o=t.maxby-1),i-=1&~i,n-=1&~n,s+=1&~s,o+=1&~o,this.getDashArray());e.lineWidth=1,e.strokeStyle=this.gridcolor;for(var a=i;a<=s;a+=2){var h=a*this.bw,l=n*this.bh,c=o*this.bh;e.vid="cliney_"+a,e.strokeDashedLine(h,l,h,c,r)}for(a=n;a<=o;a+=2){var u=a*this.bh,d=i*this.bw,b=s*this.bw;e.vid="clinex_"+a,e.strokeDashedLine(d,u,b,u,r)}},getDashArray:function(){var e=Math.max(Math.round(this.cw/10),4),t=this.cw/e,i=5/8*t,n=t-i,s=[];s.push(i/2,n);for(var o=0;o<e-1;o++)s.push(i,n);return s.push(i/2),s.push(0),s},drawGrid:function(e,t){var i=this.vinc("grid","crispEdges",!0),n=this.board,s=Math.max(n.minbx,0),o=Math.min(n.maxbx,2*n.cols),r=Math.max(n.minby,0),a=Math.min(n.maxby,2*n.rows),h=this.range.x1,l=this.range.y1,c=this.range.x2,u=this.range.y2;if(h<s&&(h=s),l<r&&(l=r),a<u&&(u=a),l-=1&l,!((c=o<c?o:c)<=(h-=1&h)||u<=l)){var n=2!==n.hasborder&&!1!==e?2:0,d=this.bw,b=this.bh,e=Math.max(h,s+n),m=Math.min(c,o-n),s=Math.max(l,r+n),p=Math.min(u,a-n);i.lineWidth=this.gw,i.strokeStyle=this.gridcolor;for(var f,g=e;g<=m;g+=2)i.vid="bdy_"+g,!1!==t?i.strokeLine(f=g*d,l*b,f,u*b):i.vhide();for(var k,g=s;g<=p;g+=2)i.vid="bdx_"+g,!1!==t?i.strokeLine(h*d,k=g*b,c*d,k):i.vhide()}},drawDashedGrid:function(e){var t=this.vinc("grid","crispEdges",!0),i=this.board,n=Math.max(i.minbx,0),s=Math.min(i.maxbx,2*i.cols),o=Math.max(i.minby,0),i=Math.min(i.maxby,2*i.rows),r=this.range.x1,a=this.range.y1,h=this.range.x2,l=this.range.y2,c=(r<n&&(r=n),s<h&&(h=s),a<o&&(a=o),i<l&&(l=i),r-=1&r,a-=1&a,h+=1&h,l+=1&l,this.getDashArray()),e=!1!==e?2:0,u=this.bw,d=this.bh,n=Math.max(r,n+e),b=Math.min(h,s-e),s=Math.max(a,o+e),m=Math.min(l,i-e);t.lineWidth=this.gw,t.strokeStyle=this.gridcolor;for(var p=n;p<=b;p+=2){var f=p*u,g=a*d,k=l*d;t.vid="bdy_"+p,t.strokeDashedLine(f,g,f,k,c)}for(p=s;p<=m;p+=2){var v=p*d,y=r*u,w=h*u;t.vid="bdx_"+p,t.strokeDashedLine(y,v,w,v,c)}},drawChassis:function(e){var t=this.vinc("chassis","crispEdges",!0),i=this.board,n=e?-.5*i.minbx*this.cw:0,e=e?-.5*i.minby*this.ch:0,s=i.cols*this.cw,i=i.rows*this.ch,o=this.lw,r=this.lm;"bosanowa"===this.pid&&(o=1,r=.5),t.fillStyle=this.quescolor,t.vid="chs1_",t.fillRect(-r,-e-r,o,i+e+o),t.vid="chs2_",t.fillRect(s-r,-e-r,o,i+e+o),t.vid="chs3_",t.fillRect(-n-r,-r,s+n+o,o),t.vid="chs4_",t.fillRect(-n-r,i-r,s+n+o,o)},drawChassis_ex1:function(e){var t=this.vinc("chassis_ex1","crispEdges",!0),i=this.board,n=this.range.x1,s=this.range.y1,o=this.range.x2,r=this.range.y2,a=(n<=0&&i.minbx,o>i.maxbx&&i.maxbx,s<=0&&i.minby,r>i.maxby&&i.maxby,this.lw),h=this.lm,n=i.cols*this.cw,o=i.rows*this.ch;if(t.fillStyle=this.quescolor,t.vid="chsex1_1_",t.fillRect(-this.cw-h,-this.ch-h,a,o+this.ch+a),t.vid="chsex1_2_",t.fillRect(n-h,-this.ch-h,a,o+this.ch+a),t.vid="chsex1_3_",t.fillRect(-this.cw-h,-this.ch-h,n+this.cw+a,a),t.vid="chsex1_4_",t.fillRect(-this.cw-h,o-h,n+this.cw+a,a),e)t.vid="chs1_",t.fillRect(-h,-h,a,o+a-1),t.vid="chs2_",t.fillRect(-h,-h,n+a-1,a);else{t.vid="chs1_",t.fillRect(-.5,-.5,1,o),t.vid="chs2_",t.fillRect(-.5,-.5,n,1);for(var l=this.range.cells,c=0;c<l.length;c++){var u=l[c],d=(u.bx-1)*this.bw,b=(u.by-1)*this.bh;1===u.bx&&(t.vid="chs1_sub_"+u.by,51!==u.ques?t.fillRect(-h,b-h,a,this.ch+a):t.vhide()),1===u.by&&(t.vid="chs2_sub_"+u.bx,51!==u.ques?t.fillRect(d-h,-h,this.cw+a,a):t.vhide())}}},lastBankPieceCount:0,drawBank:function(){if(this.showBank&&(this.range.bank||0!==this.range.bankPieces.length)){for(var e=this.vinc("piecebank"),t=this.board,i=Math.max(t.bank.pieces.length,this.lastBankPieceCount),n=0;n<i;n++){var s=t.bank.pieces[n];!this.range.bank&&-1===this.range.bankPieces.indexOf(s)||this.drawBankPiece(e,s,n)}this.drawBankAddButton(),this.lastBankPieceCount=t.bank.pieces.length}},drawBankPiece:function(e,t,i){},getBankPieceColor:function(e){return e.error?this.errcolor1:e.qcmp?this.qcmpcolor:this.quescolor},drawBankAddButton:function(){var e=this.vinc("piecebank_add","crispEdges"),t=this.board.bank.addButton,i=this.puzzle.editmode&&!this.outputImage&&null!==t.index&&(this.range.bank||-1!==this.range.bankPieces.indexOf(t));if(null!==t.index&&(this.range.bank||-1!==this.range.bankPieces.indexOf(t))){for(var n=this.bankratio,s=this.cw*n*(t.x+.25)+1,o=this.ch*n*(t.y+.25)+1,r=(o+=(this.board.rows+.5)*this.ch,s+this.cw*n*t.w-1),a=o+this.ch*n*t.h-1,h=0;h<4;h++)e.vid="pb_piece_add_"+h,i?(e.strokeStyle="blue",e.strokeDashedLine(h<2?s:r,h<2?o:a,h%2?s:r,h%2?a:o,[3])):e.vhide();e.vid="pb_piece_add_symbol",i?(e.fillStyle="blue",this.disptext("+",s+.5*n*this.cw*t.w,o+.5*n*this.ch*t.h,{style:"bold"})):e.vhide()}}}}),p.classmgr.makeCommon({KeyEvent:{key_inputcross:function(e){var t=this.cursor.getx(),i=t.getmaxnum(),n=-1;if("0"<=e&&e<="9"){var s=+e,o=t.qnum;if(i<(n=10*(o=o<=0||i<10*o+s?0:o)+s))return}else if("-"===e)n=-2!==t.qnum?-2:-1;else{if(" "!==e&&"BS"!==e)return;n=-1}t.setQnum(n),t.draw()},key_inputqnum:function(e){var t=this.cursor.getc();t.enableSubNumberArray&&this.puzzle.playmode&&"shift"===e&&t.noNum()?this.cursor.chtarget():this.key_inputqnum_main(t,e)},key_inputqnum_main:function(e,t){var i=e,n=this.puzzle,s=n.board;if(n.editmode&&s.roommgr.hastop)i=e=e.room.top;else if(n.execConfig("dispmove"))if(e.isDestination())e=e.base;else if(0<e.lcnt)return;if(e.enableSubNumberArray&&2<=this.cursor.targetdir){var o,s=[-1,-1,2,3,1,0][this.cursor.targetdir];if(-1===s)return;if(null===(o=this.getNewNumber(e,t,e.snum[s])))return;e.setSnum(s,o)}else{if(null===(o=this.getNewNumber(e,t,e.getNum())))return;e.setNum(o),e.numberWithMB&&e.enableSubNumberArray&&" "===t&&e.clrSnum()}n.execConfig("dispmove")&&e.noNum()&&e.eraseMovedLines(),i.draw(),this.prev=e,this.cancelDefault=!0},getNewNumber:function(e,t,i){var n=e.getmaxnum(),s=e.getminnum(),o=null;if("0"<=t&&t<="9"&&!e.numberAsLetter){var r=+t;(n<(o=10*(i=i<=0||n<10*i+r||this.prev!==e?0:i)+r)||0<s&&0===o)&&(o=null)}else if("a"<=t&&t<="z"&&1===t.length&&e.numberAsLetter){if(1<t.length&&"BS"!==t)return null;r=parseInt(t,36)-10;(n<(o=0<i&&(i-1)%26===r?i<=26?i+26:-1:r+1)||0<s&&0===o)&&(o=null)}else o="BS"===t?i<10||e.numberAsLetter?-1:i/10|0:"-"===t?this.puzzle.editmode&&!e.disInputHatena?-2:-1:" "===t?-1:"s1"===t?-2:"s2"===t?-3:"s3"===t?-4:"s4"===t?-5:null;return o},key_inputqnums:function(e){var t=this.cursor.getc(),i=t.qnums,n=[];if("0"<=e&&e<="9"||"-"===e){var s="-"!==e?+e:-2;if(-2!=s&&(s<t.getminnum()||s>t.getmaxnum()))return;this.prev===t&&(n=i.slice());var o=t.distinctQnums&&-2!=s?n.indexOf(s):-1;0<=o?n.splice(o,1):n.push(s),t.isValidQnums(n)||(n=[s])}else if("BS"===e){if(1<i.length)for(var r=0;r<i.length-1;r++)n.push(i[r])}else{if(" "!==e)return;n=[]}t.setQnums(n),t.setQans(0),t.setQsub(0),(this.prev=t).draw()},key_inputexcell:function(e){var t=this.cursor.getex();if(!t.isnull){var i=t.qnum,n=t.getmaxnum();if("0"<=e&&e<="9"){var s=+e;!(i<=0||this.prev!==t)&&10*i+s<=n?t.setQnum(10*i+s):s<=n&&t.setQnum(s)}else{if(" "!==e&&"-"!==e)return;t.setQnum(-1)}this.prev=t,this.cursor.draw()}},key_inputarrow:function(e){return this.key_inputdirec_common(e,!1)},key_inputdirec:function(e){return this.key_inputdirec_common(e,!0)},key_inputdirec_common:function(e,t){var i=this.cursor.getc();if(t&&-1===i.getNum())return!1;var n=i.NDIR;switch(e){case"shift+up":n=i.UP;break;case"shift+down":n=i.DN;break;case"shift+left":n=i.LT;break;case"shift+right":n=i.RT}return n!==i.NDIR&&(i.setQdir(i.qdir!==n?n:i.NDIR),t||i.setNum(-1),this.cursor.draw(),!0)},inputnumber51:function(e){var t=this.cursor;if("shift"===e)t.chtarget();else{var i=t.getobj(),n=t.detectTarget(i);if((0===n||"cell"===i.group&&i.is51cell())&&"q"===e&&!i.isnull)return i.is51cell()?i.remove51cell():i.set51cell(),void t.drawaround();if(0!==n){var s=this.klass.Cell.prototype[n===i.RT?"qnum":"qnum2"],o=i.getmaxnum(),r=s;if("0"<=e&&e<="9"){var a=+e;if(o<(r=10*(h=(h=this.getnum51(i,n))<=0||o<10*h+a||this.prev!==i?0:h)+a))return}else if("BS"===e)var h,r=10<=(h=this.getnum51(i,n))?h/10|0:s;else{if("-"!==e&&" "!==e)return;r=s}this.setnum51(i,n,r),this.prev=i,t.draw()}}},setnum51:function(e,t,i){e.setQnumDir(t,i)},getnum51:function(e,t){return e.getQnumDir(t)}}}),p.classmgr.makeCommon({MouseEvent:{inputShade:function(){this.inputcell()},inputcell:function(){var e=this.getcell();if(!e.isnull&&e!==this.mouseCell){null===this.inputData&&this.decIC(e),this.mouseCell=e,this.initFirstCell(e);if((1!==this.inputData||e.allowShade())&&(2!==this.inputData||e.allowUnshade())){if(this.RBShadeCell&&1===this.inputData){var t=this.firstCell;if((2&t.bx^2&t.by)!=(2&e.bx^2&e.by))return}this.RBShadeCell&&1!==this.inputData&&1!==this.firstState&&1===e.qans&&"right"===this.btn||(e.setQans(1===this.inputData?1:0),e.setQsub(2===this.inputData?1:0),e.draw())}}},initFirstCell:function(e){this.firstCell.isnull&&(this.firstCell=e,this.firstState=e.qans)},decIC:function(e){"shade"===this.inputMode?this.inputData=1!==e.qans?1:0:"unshade"===this.inputMode?this.inputData=1!==e.qsub?2:0:1===this.puzzle.getConfig("use")&&"patchwork"!==this.pid?"left"===this.btn?this.inputData=1!==e.qans?1:0:"right"===this.btn&&(this.inputData=1!==e.qsub?2:0):e.allowShade()?e.allowUnshade()?"left"===this.btn?1===e.qans?this.inputData=2:1===e.qsub?this.inputData=0:this.inputData=1:"right"===this.btn&&(1===e.qans?this.inputData=0:1===e.qsub?this.inputData=1:this.inputData=2):this.inputData=1!==e.qans?1:0:this.inputData=1!==e.qsub?2:0},inputclean_cell:function(){var e,t=this.getcell();t.isnull||t===this.mouseCell||(this.mouseCell=t,e=new this.klass.CellList([t]),this.puzzle.playmode?e.ansclear():e.allclear(),t.draw())},inputqnum:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(this.cursor.modesnum&&this.puzzle.playmode&&!this.cursor.checksnum(this.inputPoint)&&e.noNum()?this.setcursorsnum(e):e!==this.cursor.getc()?this.setcursor(e):this.inputqnum_main(e),this.mouseCell=e)},inputqnum_main:function(e){var t=e,i=this.puzzle;if(!i.playmode||e.qnum===i.klass.Cell.prototype.qnum||i.klass.Cell.prototype.supportQnumAnum){if(i.editmode&&i.board.roommgr.hastop)t=e=e.room.top;else if(i.execConfig("dispmove"))if(e.isDestination())e=e.base;else if(0<e.lcnt)return;if(e.enableSubNumberArray&&i.playmode&&2<=this.cursor.targetdir){var n=[-1,-1,2,3,1,0][this.cursor.targetdir];if(-1===n)return;e.setSnum(n,this.getNewNumber(e,e.snum[n]))}else i.editmode&&51===e.ques?(n=i.cursor.detectTarget(e),i.key.setnum51(e,n,this.getNewNumber(e,i.key.getnum51(e,n)))):e.setNum(this.getNewNumber(e,e.getNum()));i.execConfig("dispmove")&&e.noNum()&&e.eraseMovedLines(),t.draw()}},getNewNumber:function(e,t){var i=this.puzzle,n=i.editmode&&!e.disInputHatena,s=e.getmaxnum(),o=e.getminnum(),r=-1,a=e.qsub,h=0;return i.editmode?(h=-1,this.puzzle.painter.enablebcolor&&(a=0)):2<=this.cursor.targetdir?a=h=0:e.numberWithMB?(h=2,a=e.qsub):"roma"===i.pid||"yinyang"===i.pid?h=0:!e.numberAsObject&&"hebi"!==i.pid||(h=1),"left"===this.btn?r=s<=t?1<=h?-2:-1:1===a?2<=h?-3:-1:2===a?-1:-1===t?n?-2:o:t<o?o:t+1:"right"===this.btn&&(r=1===a?s:2===a?-2:-1===t?1===h?-2:2===h?-3:s:s<t?s:t<=o&&-2!==t?n?-2:-1:-2===t?-1:t-1),r},inputFixedNumber:function(e){var t,i=this.getcell();i.isnull||i===this.mouseCell||(-1===(t=i.getNum())&&0<i.qsub&&(t=-1-i.qsub),null===this.inputData&&(this.inputData=t===e?-1:e),t===e&&-1!==this.inputData||(i.setNum(this.inputData),i.draw()),this.mouseCell=i)},inputQues:function(e){var t=this.getcell();t.isnull||(t!==this.cursor.getc()&&"auto"===this.inputMode?this.setcursor(t):this.inputQues_main(e,t))},inputQues_main:function(e,t){var i=t.ques,n=e.length;if("left"===this.btn){for(var s=0;s<=n-1;s++)if(i===e[s]){t.setQues(e[s<n-1?s+1:0]);break}}else for(s=n-1;0<=s;s--)if(i===e[s]){t.setQues(e[0<s?s-1:n-1]);break}t.draw()},inputMB:function(){var e=this.getcell();e.isnull||(e.setQsub(("left"===this.btn?[1,2,0]:[2,0,1])[e.qsub]),e.draw())},inputFixedQsub:function(e){var t=this.getcell();t.isnull||t.is51cell()||t===this.mouseCell||(null===this.inputData&&(this.inputData=t.qsub!==e?e:0),t.setQsub(this.inputData),t.draw(),this.mouseCell=t)},inputBGcolor:function(){var e=this.getcell();e.isnull||e.is51cell()||e===this.mouseCell||(null===this.inputData&&("bgcolor1"===this.inputMode?this.inputMode=1!==e.qsub?11:10:"bgcolor2"===this.inputMode?this.inputMode=2!==e.qsub?12:10:"left"===this.btn?0===e.qsub?this.inputData=11:1===e.qsub?this.inputData=12:this.inputData=10:0===e.qsub?this.inputData=12:1===e.qsub?this.inputData=10:this.inputData=11),e.setQsub(this.inputData-10),e.draw(),this.mouseCell=e)},inputdirec:function(){var e,t,i=this.getpos(0);this.prevPos.equals(i)||((e=this.prevPos.getc()).isnull||-1===e.qnum||(t=this.prevPos.getdir(i,2))!==e.NDIR&&(e.setQdir(e.qdir!==t?t:0),e.draw()),this.prevPos=i)},inputarrow_cell:function(){var e=this.getpos(0);if(!this.prevPos.equals(e)||1!==this.inputData){e.NDIR;var t,i=this.prevPos.getc();if(!i.isnull)if((t=this.prevPos.getdir(e,2))!==e.NDIR)return this.inputarrow_cell_main(i,t),i.draw(),void this.mousereset();this.prevPos=e}},inputarrow_cell_main:function(e,t){e.numberAsObject&&e.setNum(t)},inputtile:function(){var e=this.getcell();if(!e.isnull&&!e.is51cell()&&e!==this.mouseCell){null===this.inputData&&this.decIC(e);for(var t=(this.mouseCell=e).room.clist,i=0;i<t.length;i++){var n=t[i];1!==this.inputData&&3===n.qsub||((1===this.inputData?n.setShade:n.clrShade).call(n),n.setQsub(2===this.inputData?1:0))}t.draw()}},inputIcebarn:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(null===this.inputData&&(this.inputData=e.ice()?0:6),e.setQues(this.inputData),e.drawaround(),this.mouseCell=e)},input51:function(){var e,t=this.getcell_excell();t.isnull||("excell"===(e=t.group)||"cell"===e&&t!==this.cursor.getc()?this.setcursor(t):"cell"===e&&this.input51_main(t))},input51_main:function(e){var t,i;"right"===this.btn?e.remove51cell():"left"===this.btn&&(e.is51cell()?(t=this.inputPoint.bx-e.bx,i=this.inputPoint.by-e.by,this.cursor.chtarget(!0,t,i)):e.set51cell()),e.drawaround()},input51_fixed:function(){var e=this.getcell();e.isnull||e===this.mouseCell||("clear"===this.inputMode?(e.remove51cell(),this.inputData=0):"cell51"!==this.inputMode||e.is51cell()||(e.set51cell(),this.inputData=51),e.drawaround(),this.mouseCell=e)},inputqnum_cell51:function(){var e=this.getcell_excell();e.isnull||this.mouseCell===e&&!this.mouseend||(!this.mousestart||e===this.cursor.getobj()&&51===e.ques?this.mousestart&&this.cursor.getNumOfTarget(e)<2||this.mouseend?(this.inputqnum_main(e),this.mousereset()):(this.mouseCell=e,this.inputselect_cell51(e)):(this.setcursor(e),this.mousereset()))},inputselect_cell51:function(e){var t;this.mousestart?this.prevPos=this.getpos(0):this.mousemove&&((t=this.prevPos.getdir(this.getpos(0),2))!==e.RT&&t!==e.DN||t===this.cursor.targetdir||(this.cursor.targetdir=t,this.cursor.draw()),t!==e.NDIR&&this.mousereset())},inputqnum_cross:function(){var e=this.getcross();e.isnull||e===this.mouseCell||(e!==this.cursor.getx()?this.setcursor(e):this.inputqnum_main(e),this.mouseCell=e)},inputcross_main:function(e){"left"===this.btn?e.setQnum(4!==e.qnum?e.qnum+1:-2):"right"===this.btn&&e.setQnum(-2!==e.qnum?e.qnum-1:4),e.draw()},inputcrossMark:function(){var e,t,i=this.getpos(.24);i.oncross()&&(e=2===(t=this.board).hascross?0:2,i.bx<t.minbx+e||i.bx>t.maxbx-e||i.by<t.minby+e||i.by>t.maxby-e||((t=i.getx()).isnull||(this.puzzle.opemgr.disCombine=!0,t.setQnum(1===t.qnum?-1:1),this.puzzle.opemgr.disCombine=!1,t.draw())))},inputclean_cross:function(){var e,t=this.getcross();t.isnull||t===this.mouseCell||(this.mouseCell=t,e=new this.klass.CrossList([t]),this.puzzle.playmode?e.ansclear():e.allclear(),t.draw())},inputborder:function(){var e,t=this.getpos(.35);this.prevPos.equals(t)||((e=this.prevPos.getborderobj(t)).isnull||(null===this.inputData&&(this.inputData=e.isBorder()?0:1),1===this.inputData?e.setBorder():0===this.inputData&&e.removeBorder(),e.draw()),this.prevPos=t)},inputQsubLine:function(){var e,t=this.getpos(0);this.prevPos.equals(t)||((e=this.prevPos.getnb(t)).isnull||(null===this.inputData&&(this.inputData=0===e.qsub?1:0),1===this.inputData?e.setQsub(1):0===this.inputData&&e.setQsub(0),e.draw()),this.prevPos=t)},inputLine:function(){if(this.puzzle.execConfig("dispmove"))this.inputMoveLine();else{var e,t,i=this.getcell();if(this.initFirstCell(i),this.board.borderAsLine){if(e=this.getpos(.35),this.prevPos.equals(e))return;t=this.prevPos.getborderobj(e)}else{if(e=this.getpos(0),this.prevPos.equals(e))return;t=this.prevPos.getnb(e)}t.isnull||(null===this.inputData&&(this.inputData=t.isLine()?0:1),1===this.inputData?t.setLine():0===this.inputData&&t.removeLine(),t.draw()),this.prevPos=e}},inputMoveLine:function(){for(var e=!0,t=this.getcell();e;){var e=!1,i=this.mouseCell&&!this.mousestart?this.mouseCell.getOrthogonalCell(t):t;if(i.isnull)return;var n,s=this.mouseCell,o=i.getaddr();this.mousestart&&i.isDestination()?(this.mouseCell=i,this.prevPos=o,i.draw()):!this.mousemove||s.isnull||i.isDestination()||!(n=this.prevPos.getnb(o)).isnull&&(!n.isLine()&&0===i.lcnt||n.isLine()&&1===s.lcnt)&&((s=n.isLine())?n.removeLine():n.setLine(),this.puzzle.opemgr.changeflag=!0,s!==n.isLine()&&(this.mouseCell=i,this.prevPos=o,n.draw(),e=!0))}},inputpeke:function(){var e,t=this.getpos(.22);this.prevPos.equals(t)||((e=t.getb()).isnull||(null===this.inputData&&(this.inputData=2!==e.qsub?2:3),2===this.inputData&&e.isLine()&&this.puzzle.execConfig("dispmove")||(2===this.inputData?e.setPeke():3===this.inputData&&this.puzzle.execConfig("dispmove")?e.setQsub(0):3===this.inputData&&e.removeLineAndQsub()),e.draw()),this.prevPos=t)},inputpeke_ifborder:function(){var e=this.getpos(.22).getb();return"border"===e.group&&!e.isnull&&(this.inputpeke(),!0)},inputdiraux_mousedown:function(){var e=this.getpos(.22).getb();e.isnull||(this.inputData=e.isnull||2!==e.qsub?2:3,this.inputpeke())},inputdiraux_mousemove:function(){var e,t,i,n=this.getpos(0);n.getc().isnull||((e=this.prevPos.getnb(n)).isnull||(t=null,i=this.prevPos.getdir(n,2),null===this.inputData&&(this.inputData=e.qsub!==10+i?11:0),11===this.inputData?t=10+i:0===this.inputData&&e.qsub===10+i&&(t=0),null!==t&&(e.setQsub(t),e.draw())),this.prevPos=n)},clickdiraux:function(){var e,t,i=this.getpos(.22);this.prevPos.equals(i)||((i=i.getb()).isnull||(e={0:2,2:0},t=i.qsub,t=(e=i.isvert?"left"===this.btn?{0:2,2:13,13:14,14:0}:{0:14,14:13,13:2,2:0}:"left"===this.btn?{0:2,2:11,11:12,12:0}:{0:12,12:11,11:2,2:0})[t]||0,"diraux"===this.inputMode&&2===t&&(t=e[t]||0),i.setQsub(t),i.draw()))},inputTateyoko:function(){var e,t,i,n;this.mouseend&&this.notInputted()&&this.clickTateyoko?this.clickTateyoko():(e=this.getcell()).isnull||("amibo"!==this.pid&&1===e.ques||"amibo"===this.pid&&e.isNum()||(this.mouseCell!==e?this.firstPoint.set(this.inputPoint):null!==this.firstPoint.bx&&(t=null,n=this.inputPoint.bx-this.firstPoint.bx,(i=this.inputPoint.by-this.firstPoint.by)<=-.5||.5<=i?t=1:(n<=-.5||.5<=n)&&(t=2),null!==t&&(i="amibo"===this.pid||"tatamibari"===this.pid,n=0,n=this.puzzle.playmode?{0:0,11:3,12:1,13:2}[e.qans]:{"-1":0,1:3,2:1,3:2}[e.qnum],(null===this.inputData?n&t:this.inputData<=0)&&(t=i?-t:0),i?0<t?n|=t:n&=~-t:n=t,this.puzzle.playmode?e.setQans([0,12,13,11][n]):e.setQnum([-1,2,3,1][n]),e.draw(),this.inputData=+(0<t),this.firstPoint.reset(),"tatamibari"!==this.pid&&"ladders"!==this.pid||this.mousereset()))),this.mouseCell=e)},inputempty:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(null===this.inputData&&(this.inputData=e.isEmpty()?0:7),e.setValid(this.inputData),this.mouseCell=e)},mouseinputAutoEdit_qnum:function(){this.mousestart&&this.inputqnum()},mouseinputAutoEdit_areanum:function(){this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.inputqnum()},mouseinputAutoPlay_cell:function(){this.inputcell()},mouseinputAutoPlay_qnum:function(){this.mousestart&&this.inputqnum()},mouseinputAutoPlay_border:function(){(this.mousestart||this.mousemove)&&("left"===this.btn&&this.isBorderMode()?this.inputborder():this.inputQsubLine())},mouseinputAutoPlay_line:function(e){"left"===this.btn?(this.mousestart||this.mousemove)&&this.inputLine():"right"===this.btn&&(this.mousestart||this.mousemove)&&this.inputpeke(),this.mouseend&&this.notInputted()&&(this.prevPos=new this.klass.Address,!this.inputpeke_ifborder()&&e&&this.inputMB())},mouseinputAutoPlay_lineMB:function(){this.mouseinputAutoPlay_line(!0)},dispInfoBlk:function(){var e=this.getcell();this.mousereset(),!e.isnull&&e.isShade()&&(this.RBShadeCell?this.dispInfoBlk8(e):e.sblk.clist.setinfo(1),this.board.hasinfo=!0,this.puzzle.redraw())},dispInfoUblk:function(){var e=this.getcell();this.mousereset(),!e.isnull&&e.isUnshade()&&(e.ublk.clist.setinfo(1),this.board.hasinfo=!0,this.puzzle.redraw())},dispInfoBlk8:function(e){for(var t=[e];0<t.length;){var i=t.pop();if(0===i.qinfo){i.setinfo(1);for(var n=i.bx,i=i.by,s=this.board.cellinside(n-2,i-2,n+2,i+2),o=0;o<s.length;o++){var r=s[o];0===r.qinfo&&r.isShade()&&t.push(r)}}}},dispInfoLine:function(){var e=this.board,t=this.getborder(.15);if(this.mousereset(),!t.isnull){if(!t.isLine()){var i=e.borderAsLine?this.getcross():this.getcell();if(i.isnull||e.linegraph.isLineCross&&(3===i.lcnt||4===i.lcnt))return;i=i.adjborder;if(i.left.isLine())t=i.left;else if(i.right.isLine())t=i.right;else if(i.top.isLine())t=i.top;else{if(!i.bottom.isLine())return;t=i.bottom}}t.isnull||(e.border.setinfo(-1),t.path.setedgeinfo(1),e.hasinfo=!0,this.puzzle.redraw())}}}}),p.classmgr.makeCommon({AnsCheck:{checkAllCell:function(e,t){for(var i=0;i<this.board.cell.length;i++){var n=this.board.cell[i];if(7!==n.ques&&e(n)){if(this.failcode.add(t),this.checkOnly)break;n.seterr(1)}}},checkNoNumCell:function(){this.checkAllCell(function(e){return 0===e.ques&&e.noNum()},"ceNoNum")},checkIceLines:function(){this.checkAllCell(function(e){return e.ice()&&e.isLineCurve()},"lnCurveOnIce")},checkNotCrossOnMark:function(){this.checkAllCell(function(e){return 4!==e.lcnt&&11===e.ques},"lnNotCrossMk")},checkLineOnShadeCell:function(){this.checkAllCell(function(e){return(1===e.ques||1===e.qans)&&0<e.lcnt},"lnOnShade")},checkNoLineObject:function(){this.checkAllCell(function(e){return 0===e.lcnt&&e.isNum()},"nmNoLine")},checkLineOverLetter:function(){this.checkAllCell(function(e){return 2<=e.lcnt&&e.isNum()},this.board.linegraph.moveline?"laOnNum":"lcOnNum")},checkNumberHasArrow:function(){this.checkAllCell(function(e){return 0<=e.qnum&&e.qdir===e.NDIR},"anNoArrow")},checkDir4Cell:function(e,t,i){for(var n=0;n<this.board.cell.length;n++){var s=this.board.cell[n];if(s.isValidNum()){var o=s.getNum(),r=s.countDir4Cell(e);if(!(0===t&&o===r||1===t&&o<=r||2===t&&r<=o)){if(this.failcode.add(i),this.checkOnly)break;s.seterr(1)}}}},checkSideCell:function(e,t){for(var i=!0,n=this.board,s=0;s<n.cell.length;s++){var o=n.cell[s],r=o.adjacent.right;if(o.bx<n.maxbx-1&&e(o,r)){if(i=!1,this.checkOnly)break;o.seterr(1),r.seterr(1)}if(r=o.adjacent.bottom,o.by<n.maxby-1&&e(o,r)){if(i=!1,this.checkOnly)break;o.seterr(1),r.seterr(1)}}i||this.failcode.add(t)},checkAdjacentShadeCell:function(){this.checkSideCell(function(e,t){return e.isShade()&&t.isShade()},"csAdjacent")},checkAdjacentDiffNumber:function(){this.checkSideCell(function(e,t){return e.sameNumber(t)},"nmAdjacent")},checkAroundCell:function(e,t){for(var i=this.board,n=0;n<i.cell.length;n++){var s=i.cell[n],o=null,r=new this.klass.CellList;if(r.add(s),o=s.relcell(2,0),e(s,o)&&r.add(o),o=s.relcell(0,2),e(s,o)&&r.add(o),o=s.relcell(-2,2),e(s,o)&&r.add(o),o=s.relcell(2,2),e(s,o)&&r.add(o),!(r.length<=1)){if(this.failcode.add(t),this.checkOnly)break;r.seterr(1)}}},check2x2Block:function(e,t){for(var i=this.board,n=0;n<i.cell.length;n++){var s=i.cell[n];if(!(s.bx>=i.maxbx-1||s.by>=i.maxby-1)){var o=s.bx,s=s.by,o=i.cellinside(o,s,o+2,s+2).filter(e);if(!(o.length<4)){if(this.failcode.add(t),this.checkOnly)break;o.seterr(1)}}}},check2x2ShadeCell:function(){this.check2x2Block(function(e){return e.isShade()},"cs2x2")},check2x2UnshadeCell:function(){this.check2x2Block(function(e){return e.isUnshade()},"cu2x2")},checkSameColorTile:function(){this.checkSameObjectInRoom(this.board.roommgr,function(e){return e.isShade()?1:2},"bkMixed")},checkConnectShade:function(){this.checkOneArea(this.board.sblkmgr,"csDivide")},checkConnectUnshade:function(){this.checkOneArea(this.board.ublkmgr,"cuDivide")},checkConnectNumber:function(){this.checkOneArea(this.board.nblkmgr,"nmDivide")},checkOneArea:function(e,t){1<e.components.length&&(this.failcode.add(t),e.components[0].getnodeobjs().seterr(1))},checkConnectUnshadeRB:function(){if(1<this.board.ublkmgr.components.length){this.failcode.add("cuDivideRB");for(var e=new this.klass.CellList,t=this.board.cell.filter(function(e){return e.isShade()}),i=0;i<t.length;i++)for(var n=t[i],s=n.getdir4clist(),o=null,r=0;r<s.length;r++){var a=s[r][0];if(null===o)o=a.ublk;else if(o!==a.ublk){e.add(n);break}}e.seterr(1)}},checkShadeCellExist:function(){var e=this.board;if(e.sblkmgr.enabled){if(0<e.sblkmgr.components.length)return}else if(e.ublkmgr.enabled){if(0===e.ublkmgr.components.length||e.ublkmgr.components[0].nodes.length!==e.cell.length)return}else if(e.cell.some(function(e){return e.isShade()}))return;this.failcode.add("brNoShade")},doneShadingDecided:function(){this.board.cell.some(function(e){return!e.isShadeDecided()})&&this.failcode.setUndecided()},checkOneLoop:function(){this.checkOneLineBase("lnPlLoop")},checkOneLine:function(){this.checkOneLineBase("lnPlLine")},checkOneLineBase:function(e){var t=this.board,i=t.linegraph.components;1<i.length&&(this.failcode.add(e),t.border.setnoerr(),i[0].setedgeerr(1))},checkNumberExist:function(){this.board.cell.some(function(e){return e.isValidNum()})||this.failcode.add("brNoValidNum")},checkConnectAllNumber:function(){var e=this.board,t=e.linegraph.components;1<t.length&&(this.failcode.add("lcDivided"),e.border.setnoerr(),t[0].setedgeerr(1),t[0].clist.seterr(4))},checkLineExist:function(){var e=this.board;e.linegraph.ltotal[0]===(e.borderAsLine?e.cross:e.cell).length&&this.failcode.add("brNoLine")},checkCrossLine:function(){this.checkLineCount(4,"lnCross")},checkBranchLine:function(){this.checkLineCount(3,"lnBranch")},checkDeadendLine:function(){this.checkLineCount(1,"lnDeadEnd")},checkNoLine:function(){this.checkLineCount(0,"ceNoLine")},checkLineCount:function(t,e){var i=!0,n=this.board;if(n.linegraph.ltotal[t])if(n.borderAsLine){for(var s=n.cross,o=0;o<s.length;o++){var r=s[o];if(r.lcnt===t){if(i=!1,this.checkOnly)break;r.seterr(1),n.borderinside(r.bx-1,r.by-1,r.bx+1,r.by+1).seterr(1)}}i||(this.failcode.add(e),n.border.setnoerr())}else this.checkAllCell(function(e){return e.lcnt===t},e)},checkCrossConnectLine:function(){this.checkConnectLineCount(4,"lnCross")},checkBranchConnectLine:function(){this.checkConnectLineCount(3,"lnBranch")},checkDeadendConnectLine:function(){this.checkConnectLineCount(1,"lnDeadEnd")},checkConnectLineCount:function(t,e){this.board.linegraph.ltotal[t]&&this.checkAllCell(function(e){return e.noNum()&&e.lcnt===t},e)},checkenableLineParts:function(){for(var e=this.board,t=0;t<e.cell.length;t++){var i=e.cell[t],n=i.adjborder;if(n.top.isLine()&&i.noLP(i.UP)||n.bottom.isLine()&&i.noLP(i.DN)||n.left.isLine()&&i.noLP(i.LT)||n.right.isLine()&&i.noLP(i.RT)){if(this.failcode.add("ceAddLine"),this.checkOnly)break;i.seterr(1)}}},checkAllArea:function(e,t,i){this.checkAllBlock(e,null,t,i)},checkAllBlock:function(e,t,i,n){for(var s=e.components,o=0;o<s.length;o++){var r=s[o],a=r.clist,h=r.top||a.getQnumCell(),l=a.getRectSize(),c=(t?a.filter(t):a).length,h=h&&!h.isnull?h.qnum:-1;if(!i(l.cols,l.rows,c,h)){if(this.failcode.add(n),this.checkOnly)break;e.seterr?e.seterr(r,1):s!==this.board.linegraph?a.seterr("tateyoko"!==this.pid?1:4):(this.board.border.setnoerr(),r.objs.seterr(1))}}},checkNumberAndSize:function(){this.checkAllArea(this.board.roommgr,function(e,t,i,n){return n<=0||n===i},"bkSizeNe")},checkRoomRect:function(){this.checkAllArea(this.board.roommgr,function(e,t,i,n){return e*t===i},"bkNotRect")},checkNoNumber:function(){this.checkAllBlock(this.board.roommgr,function(e){return e.isNum()},function(e,t,i,n){return 0!==i},"bkNoNum")},checkDoubleNumber:function(){this.checkAllBlock(this.board.roommgr,function(e){return e.isNum()},function(e,t,i,n){return i<2},"bkNumGe2")},checkShadeCellCount:function(){this.checkAllBlock(this.board.roommgr,function(e){return e.isShade()},function(e,t,i,n){return n<0||n===i},"bkShadeNe")},checkNoShadeCellInArea:function(){this.checkAllBlock(this.board.roommgr,function(e){return e.isShade()},function(e,t,i,n){return 0<i||0===n},"bkNoShade")},checkLinesInArea:function(e,t,i){this.checkAllBlock(e,function(e){return 0<e.lcnt},t,i)},checkNoMovedObjectInRoom:function(e){this.checkAllBlock(e,function(e){return-1!==e.base.qnum},function(e,t,i,n){return 0!==i},"bkNoNum")},checkDisconnectLine:function(){this.checkConnectObjectCount(function(e){return 0<e},this.board.linegraph.moveline?"laIsolate":"lcIsolate")},checkConnectObject:function(){this.checkConnectObjectCount(function(e){return e<2},"nmConnected")},checkTripleObject:function(){this.checkConnectObjectCount(function(e){return e<3},"lcTripleNum")},checkConnectObjectCount:function(e,t){for(var i=!0,n=this.board.linegraph.components,s=0;s<n.length;s++){var o=n[s].clist;if(!e(o.filter(function(e){return e.isNum()}).length)){if(i=!1,this.checkOnly)break;this.board.border.setnoerr(),n[s].setedgeerr(1),n[s].clist.seterr(4)}}i||(this.failcode.add(t),this.board.border.setnoerr())},checkSideAreaSize:function(e,t,i){for(var n=e.getSideAreaInfo(),s=0;s<n.length;s++){var o=t(n[s][0]),r=t(n[s][1]);if(!(o<=0||r<=0||o!==r)){if(this.failcode.add(i),this.checkOnly)break;n[s][0].clist.seterr(1),n[s][1].clist.seterr(1)}}},checkSideAreaCell:function(e,t,i){for(var n=0;n<this.board.border.length;n++){var s=this.board.border[n];if(s.isBorder()){var o=s.sidecell[0],r=s.sidecell[1];if(!o.isnull&&!r.isnull&&e(o,r,s)){if(this.failcode.add(i),this.checkOnly)break;t?(o.room.clist.seterr(1),r.room.clist.seterr(1)):(o.seterr(1),r.seterr(1))}}}},checkSameObjectInRoom:function(e,t,i){var n=e.components;e:for(var s=0;s<n.length;s++)for(var o=n[s].clist,r=-1,a=0;a<o.length;a++){var h=t(o[a]);if(-1!==h&&r!==h)if(-1===r)r=h;else{if(this.failcode.add(i),this.checkOnly)break e;n!==this.board.linegraph.components?o.seterr(1):(this.board.border.setnoerr(),n[s].setedgeerr(1))}}},checkGatheredObjectInGraph:function(t,e,i){for(var n={},s=this.board,o=0;o<s.cell.length;o++){var r=e(s.cell[o]);if(-1!==r){var a=t.getComponentRefs(s.cell[o]);if(void 0===n[r])n[r]=a;else if(a&&n[r]!==a){this.failcode.add(i),s.cell.filter(function(e){e=t.getComponentRefs(e);return a===e||n[r]===e}).seterr(1);break}}}},checkDifferentNumberInRoom:function(){this.checkDifferentNumberInRoom_main(this.board.roommgr,this.isDifferentNumberInClist)},checkDifferentNumberInRoom_main:function(e,t){for(var i=e.components,n=0;n<i.length;n++){var s=i[n].clist;if(!t.call(this,s)){if(this.failcode.add("bkDupNum"),this.checkOnly)break;s.seterr(1)}}},isDifferentNumberInClist:function(e){return this.isIndividualObject(e,function(e){return e.getNum()})},isDifferentAnsNumberInClist:function(e){return this.isIndividualObject(e,function(e){return e.anum})},isIndividualObject:function(e,t){if(e.length<=0)return!0;for(var i=!0,n=[],s=[],o=-1,r=e[0].getminnum(),a=0;a<e.length;a++)o<t(e[a])&&(o=t(e[a]));for(var h=r;h<=o;h++)n[h]=0;for(a=0;a<e.length;a++)s[e[a].id]=t(e[a]);for(a=0;a<e.length;a++)s[e[a].id]>=r&&n[s[e[a].id]]++;var l=e.filter(function(e){return s[e.id]>=r&&2<=n[s[e.id]]});return 0<l.length&&(l.seterr(1),i=!1),i},checkRowsCols:function(e,t){var i=!0,n=this.board;e:do{for(var s=1;s<=n.maxby;s+=2){var o=n.cellinside(n.minbx+1,s,n.maxbx-1,s);if(!e.call(this,o)&&(i=!1,this.checkOnly))break e}for(var r=1;r<=n.maxbx;r+=2){o=n.cellinside(r,n.minby+1,r,n.maxby-1);if(!e.call(this,o)&&(i=!1,this.checkOnly))break e}}while(0);i||this.failcode.add(t)},checkDifferentNumberInLine:function(){this.checkRowsCols(this.isDifferentNumberInClist,"nmDupRow")},checkRowsColsPartly:function(e,t,i){var n=!0,s=this.board;e:do{for(var o={keycell:null,key51num:-1,isvert:!1},r=1;r<=s.maxby;r+=2)for(var a=1;a<=s.maxbx;a+=2){for(var h=a;h<=s.maxbx&&!t(s.getc(h,r),!1);h+=2);if(o.keycell=s.getobj(a-2,r),o.key51num=o.keycell.qnum,a<h&&!e.call(this,s.cellinside(a,r,h-2,r),o)&&(n=!1,this.checkOnly))break e;a=h}o={keycell:null,key51num:-1,isvert:!0};for(a=1;a<=s.maxbx;a+=2)for(r=1;r<=s.maxby;r+=2){for(var l=r;l<=s.maxby&&!t(s.getc(a,l),!0);l+=2);if(o.keycell=s.getobj(a,r-2),o.key51num=o.keycell.qnum2,r<l&&!e.call(this,s.cellinside(a,r,a,l-2),o)&&(n=!1,this.checkOnly))break e;r=l}}while(0);n||this.failcode.add(i)},checkRowsColsFor51cell:function(e,t){this.checkRowsColsPartly(e,function(e){return e.is51cell()},t)},checkBorderCross:function(){this.checkBorderCount(4,0,"bdCross")},checkBorderDeadend:function(){this.checkBorderCount(1,0,"bdDeadEnd")},checkBorderCount:function(e,t,i){for(var n=!0,s=this.board,o=2===s.hascross?s.cross:s.crossinside(s.minbx+2,s.minby+2,s.maxbx-2,s.maxby-2),r=0;r<o.length;r++){var a=o[r];if(!(a.lcnt!==e||1===t&&1!==a.qnum||2===t&&1===a.qnum)){if(n=!1,this.checkOnly)break;a.setCrossBorderError()}}n||(this.failcode.add(i),s.border.setnoerr())},checkLineShape:function(e,t){for(var i=!0,n=this.getLineShapeInfo(),s=0;s<n.length;s++){var o=n[s];if(o&&e(o)){if(i=!1,this.checkOnly)break;var r=o.cells;r[0]&&!r[0].isnull&&r[0].seterr(1),r[1]&&!r[1].isnull&&r[1].seterr(1),o.objs.seterr(1)}}i||(this.failcode.add(t),this.board.border.setnoerr())},checkLineShapeDeadend:function(){this.checkLineShape(function(e){return e.cells[1].isnull},"lcDeadEnd")},getLineShapeInfo:function(){if(this._info.num)return this._info.num;for(var e=this.board,t=[],i=[],n=0;n<e.border.length;n++)i[n]=!1;for(var s=e.cell.filter(function(e){return e.isNum()}),o=0;o<s.length;o++)for(var r,a=s[o],h=a.adjborder,l=[h.top,h.bottom,h.left,h.right],c=0;c<4;c++)l[c].isnull||(r=this.serachLineShapeInfo(a,c+1,i))&&t.push(r);return this._info.num=t},serachLineShapeInfo:function(e,t,i){for(var n={objs:new this.klass.BorderList,cells:[e,null],ccnt:0,length:[],dir1:t,dir2:0},s=e.getaddr();;)if(s.movedir(t,1),s.oncell()){var o=s.getc(),r=o.adjborder;if(o.isnull||e===o||o.isNum())break;this.board.linegraph.iscrossing(o)&&3<=o.lcnt||(1!==t&&r.bottom.isLine()?(2!==t&&n.ccnt++,t=2):2!==t&&r.top.isLine()?(1!==t&&n.ccnt++,t=1):3!==t&&r.right.isLine()?(4!==t&&n.ccnt++,t=4):4!==t&&r.left.isLine()&&(3!==t&&n.ccnt++,t=3))}else{o=s.getb();if(o.isnull||!o.isLine()||i[o.id])break;n.objs.add(o),i[o.id]=!0,isNaN(n.length[n.ccnt])?n.length[n.ccnt]=1:n.length[n.ccnt]++}return 0<n.objs.length?(n.cells[1]=s.getc(),n.dir2=[0,2,1,4,3][t],n):null},isDifferentShapeBlock:function(e,t){if(e.clist.length!==t.clist.length)return!0;e=e.clist.getBlockShapes(),t=t.clist.getBlockShapes();return e.canon!==t.canon},searchloop:function(e,t,i){var n=new(i?this.klass.BorderList:"cross"===t.pointgroup?this.klass.CrossList:this.klass.CellList);if(e.circuits<=0)return n;for(var s=this.board,o=[e.nodes[0].obj],r=null,a={},h=s.maxbx-s.minbx;0<o.length;){var l=o[o.length-1],c=null,u=a[l.by*h+l.bx];if(void 0===u)u=a[l.by*h+l.bx]=o.length-1;else if(o.length-1>u)for(var d=o.length-2;0<=d&&("border"===o[d].group==!!i&&n.add(o[d]),o[d]!==l);d--);if("border"!==l.group)for(r=l,d=0;d<t.getObjNodeList(l)[0].nodes.length;d++){var b=t.getObjNodeList(l)[0].nodes[d].obj,b=s.getb(l.bx+b.bx>>1,l.by+b.by>>1);if(void 0===a[b.by*h+b.bx]){c=b;break}}else for(var m="cross"===t.pointgroup?l.sidecross:l.sidecell,d=0;d<m.length;d++){var p=m[d];if(p!==r&&p!==o[o.length-2]){c=p;break}}c?o.push(c):o.pop()}return n},getBoardPiecesMap:function(){if(this._info.boardpiecesmap)return this._info.boardpiecesmap;this._info.boardpieces||(this._info.boardpieces=this.board.getBankPiecesInGrid());var t={};return this._info.boardpieces.forEach(function(e){e[0]in t?t[e[0]].push(e[1]):t[e[0]]=[e[1]]}),this._info.boardpiecesmap=t},checkBankPiecesInvalid:function(){var e,t=this.getBoardPiecesMap();for(e in t){for(var i=!1,n=0;n<this.board.bank.pieces.length;n++)e===this.board.bank.pieces[n].canonize()&&(i=!0);if(!i){if(this.failcode.add("bankInvalid"),this.checkOnly)break;t[e].forEach(function(e){e.seterr(1)})}}},checkBankPiecesAvailable:function(){for(var t,e=this.getBoardPiecesMap(),i={},n=0;n<this.board.bank.pieces.length;n++)(t=this.board.bank.pieces[n].canonize())in i||(i[t]=0),i[t]+=this.board.bank.pieces[n].count;for(t in e)if(t in i&&i[t]<e[t].length){if(this.failcode.add("bankGt"),this.checkOnly)break;this.board.bank.pieces.forEach(function(e){e.canonize()===t&&e.seterr(1)}),e[t].forEach(function(e){e.seterr(1)})}},checkBankPiecesUsed:function(){for(var t,e=this.getBoardPiecesMap(),i={},n=0;n<this.board.bank.pieces.length;n++)(t=this.board.bank.pieces[n].canonize())in i||(i[t]=0),i[t]+=this.board.bank.pieces[n].count;for(t in i){var s=t in e?e[t].length:0;if(i[t]>s){if(this.failcode.add("bankLt"),this.checkOnly)break;var o=s;this.board.bank.pieces.forEach(function(e){e.canonize()===t&&o--<=0&&e.seterr(1)})}}}}}),p.classmgr.makeCommon({BoardExec:{adjustNumberArrow:function(e,t){e&this.TURNFLIP&&this.adjustCellQdirArrow(e,t)},adjustCellArrow:function(e,t){e&this.TURNFLIP&&(this.klass.Cell.prototype.numberAsObject?this.adjustCellQnumArrow(e,t):this.adjustCellQdirArrow(e,t))},adjustCellQdirArrow:function(e,t){for(var i=this.getTranslateDir(e),n=this.board.cellinside(t.x1,t.y1,t.x2,t.y2),s=0;s<n.length;s++){var o=n[s],r=i[o.qdir];r&&(o.qdir=r)}},adjustCellQnumArrow:function(e,t){for(var i=this.getTranslateDir(e),n=this.board.cellinside(t.x1,t.y1,t.x2,t.y2),s=0;s<n.length;s++){var o=n[s],r=i[o.qnum];r&&(o.qnum=r),(r=i[o.anum])&&(o.anum=r)}},adjustBorderArrow:function(e,t){if(e&this.TURNFLIP)for(var i=this.getTranslateDir(e),n=this.board.borderinside(t.x1,t.y1,t.x2,t.y2),s=0;s<n.length;s++){var o=n[s],r=i[o.qdir];r&&(o.qdir=r)}},getTranslateDir:function(e){var t={};switch(e){case this.FLIPY:t={1:2,2:1};break;case this.FLIPX:t={3:4,4:3};break;case this.TURNR:t={1:4,2:3,3:1,4:2};break;case this.TURNL:t={1:3,2:4,3:2,4:1}}return t},adjustQues51_1:function(e,t){for(var i=1|t.x1,n=1|t.y1,s=(this.qnumw=[],this.qnumh=[],this.board),o=n;o<=t.y2;o+=2){this.qnumw[o]=[s.getex(-1,o).qnum];for(var r=i;r<=t.x2;r+=2)(a=s.getc(r,o)).is51cell()&&this.qnumw[o].push(a.qnum)}for(r=i;r<=t.x2;r+=2){this.qnumh[r]=[s.getex(r,-1).qnum2];for(var a,o=n;o<=t.y2;o+=2)(a=s.getc(r,o)).is51cell()&&this.qnumh[r].push(a.qnum2)}},adjustQues51_2:function(e,t){var i,n=t.x1+t.x2,s=t.y1+t.y2,o=1|t.x1,r=1|t.y1,a=this.board;switch(a.disableInfo(),e){case this.FLIPY:for(var h=o;h<=t.x2;h+=2){i=1,this.qnumh[h]=this.qnumh[h].reverse(),a.getex(h,-1).setQnum2(this.qnumh[h][0]);for(var l=r;l<=t.y2;l+=2)(c=a.getc(h,l)).is51cell()&&(c.setQnum2(this.qnumh[h][i]),i++)}break;case this.FLIPX:for(l=r;l<=t.y2;l+=2){i=1,this.qnumw[l]=this.qnumw[l].reverse(),a.getex(-1,l).setQnum(this.qnumw[l][0]);for(h=o;h<=t.x2;h+=2)(c=a.getc(h,l)).is51cell()&&(c.setQnum(this.qnumw[l][i]),i++)}break;case this.TURNR:for(l=r;l<=t.y2;l+=2){i=1,this.qnumh[l]=this.qnumh[l].reverse(),a.getex(-1,l).setQnum(this.qnumh[l][0]);for(h=o;h<=t.x2;h+=2)(c=a.getc(h,l)).is51cell()&&(c.setQnum(this.qnumh[l][i]),i++)}for(h=o;h<=t.x2;h+=2){a.getex(h,-(i=1)).setQnum2(this.qnumw[n-h][0]);for(l=r;l<=t.y2;l+=2)(c=a.getc(h,l)).is51cell()&&(c.setQnum2(this.qnumw[n-h][i]),i++)}break;case this.TURNL:for(l=r;l<=t.y2;l+=2){a.getex(-(i=1),l).setQnum(this.qnumh[s-l][0]);for(h=o;h<=t.x2;h+=2)(c=a.getc(h,l)).is51cell()&&(c.setQnum(this.qnumh[s-l][i]),i++)}for(h=o;h<=t.x2;h+=2){i=1,this.qnumw[h]=this.qnumw[h].reverse(),a.getex(h,-1).setQnum2(this.qnumw[h][0]);for(var c,l=r;l<=t.y2;l+=2)(c=a.getc(h,l)).is51cell()&&(c.setQnum2(this.qnumw[h][i]),i++)}}a.enableInfo()},adjustExCellTopLeft_1:function(e,t){for(var i=1|t.x1,n=1|t.y1,s=(this.qnumw=[],this.qnumh=[],this.board),o=-2*s.excellRows(s.cols,s.rows)+1,r=-2*s.excellCols(s.cols,s.rows)+1,a=n;a<=t.y2;a+=2){this.qnumw[a]=[];for(var h=r;h<=-1;h+=2)this.qnumw[a].push(s.getex(h,a).qnum)}for(h=i;h<=t.x2;h+=2){this.qnumh[h]=[];for(a=o;a<=-1;a+=2)this.qnumh[h].push(s.getex(h,a).qnum)}},adjustExCellTopLeft_2:function(e,t,i){var n=t.x1+t.x2,s=t.y1+t.y2,o=1|t.x1,r=1|t.y1;if(!i){if(e===this.FLIPX||e===this.TURNL)for(var a in this.qnumw)this.qnumw[a].reverse();if(e===this.FLIPY||e===this.TURNR)for(var a in this.qnumh)this.qnumh[a].reverse()}var h=this.board,l=(h.disableInfo(),-2*h.excellRows(h.cols,h.rows)+1),c=-2*h.excellCols(h.cols,h.rows)+1;switch(e){case this.FLIPY:for(var u=o;u<=t.x2;u+=2)for(var d=-1;l<=d;d-=2)h.getex(u,d).setQnum(this.qnumh[u].pop());break;case this.FLIPX:for(d=r;d<=t.y2;d+=2)for(u=-1;c<=u;u-=2)h.getex(u,d).setQnum(this.qnumw[d].pop());break;case this.TURNR:for(d=r;d<=t.y2;d+=2)for(u=-1;c<=u;u-=2)h.getex(u,d).setQnum(this.qnumh[d].pop());for(u=o;u<=t.x2;u+=2)for(d=-1;l<=d;d-=2)h.getex(u,d).setQnum(this.qnumw[n-u].pop());break;case this.TURNL:for(d=r;d<=t.y2;d+=2)for(u=-1;c<=u;u-=2)h.getex(u,d).setQnum(this.qnumh[s-d].pop());for(u=o;u<=t.x2;u+=2)for(d=-1;l<=d;d-=2)h.getex(u,d).setQnum(this.qnumw[u].pop())}h.enableInfo()},getAfterPos:function(e,t,i){var n,s,o=this.puzzle,r=o.board,a=t.x1+t.x2,h=t.y1+t.y2,l=i.bx,c=i.by;switch(e){case this.FLIPY:n=l,s=h-c;break;case this.FLIPX:n=a-l,s=c;break;case this.TURNR:n=h-c,s=l;break;case this.TURNL:n=c,s=a-l;break;case this.EXPANDUP:n=l,s=c+(c===r.minby?0:2);break;case this.EXPANDDN:n=l,s=c+(c===r.maxby?2:0);break;case this.EXPANDLT:n=l+(l===r.minbx?0:2),s=c;break;case this.EXPANDRT:n=l+(l===r.maxbx?2:0),s=c;break;case this.REDUCEUP:n=l,s=c-(c<=r.minby+2?0:2);break;case this.REDUCEDN:n=l,s=c-(c>=r.maxby-2?2:0);break;case this.REDUCELT:n=l-(l<=r.minbx+2?0:2),s=c;break;case this.REDUCERT:n=l-(l>=r.maxbx-2?2:0),s=c;break;default:n=l,s=c}return{pos:new o.klass.Address(n,s),isdel:this.isdel(e,i)}}}}),p.classmgr.makeCommon({Encode:{include:function(e,t,i){return t<=e&&e<=i},decode4Cell:function(){for(var e=0,t=0,i=this.outbstr,n=this.board,t=0;t<i.length;t++){var s=n.cell[e],o=i.charAt(t);if(this.include(o,"0","4")?s.qnum=parseInt(o,16):this.include(o,"5","9")?(s.qnum=parseInt(o,16)-5,e++):this.include(o,"a","e")?(s.qnum=parseInt(o,16)-10,e+=2):this.include(o,"g","z")?e+=parseInt(o,36)-16:"."===o&&(s.qnum=-2),e++,!n.cell[e])break}this.outbstr=i.substr(t+1)},encode4Cell:function(){for(var e=0,t="",i=this.board,n=0;n<i.cell.length;n++){var s="",o=i.cell[n].qnum;0<=o?i.cell[n+1]&&-1!==i.cell[n+1].qnum?s=""+o.toString(16):i.cell[n+2]&&-1!==i.cell[n+2].qnum?(s=""+(5+o).toString(16),n++):(s=""+(10+o).toString(16),n+=2):-2===o?s=".":e++,0===e?t+=s:!s&&20!==e||(t+=(e+15).toString(36)+s,e=0)}0<e&&(t+=(e+15).toString(36)),this.outbstr+=t},decode1Cell:function(e){for(var t=0,i=0,n=this.outbstr,s=this.board,i=0;i<n.length;i++){var o=s.cell[t],r=n.charAt(i);if(this.include(r,"0","h")?(o.qnum=e,t+=parseInt(r,36)):t+=parseInt(r,36)-18,t++,!s.cell[t])break}this.outbstr=n.substr(i+1)},encode1Cell:function(e){for(var t=-1,i=!1,n="",s=this.board,o=0;o<s.cell.length;o++)s.cell[o].qnum===e?(0<=t&&(n+=(i?t:t+18).toString(36)),i=!0,t=0):17===++t&&(n+=(i?t:t+18).toString(36),i=!1,t=-1);0<=t&&(n+=(i?t:t+18).toString(36)),this.outbstr+=n},decode4Cross:function(){for(var e=0,t=0,i=this.outbstr,n=this.board,t=0;t<i.length;t++){var s=n.cross[e],o=i.charAt(t);if(this.include(o,"0","4")?s.qnum=parseInt(o,16):this.include(o,"5","9")?(s.qnum=parseInt(o,16)-5,e++):this.include(o,"a","e")?(s.qnum=parseInt(o,16)-10,e+=2):this.include(o,"g","z")?e+=parseInt(o,36)-16:"."===o&&(s.qnum=-2),e++,!n.cross[e])break}this.outbstr=i.substr(t+1)},encode4Cross:function(){for(var e=0,t="",i=this.board,n=0;n<i.cross.length;n++){var s="",o=i.cross[n].qnum;0<=o?i.cross[n+1]&&-1!==i.cross[n+1].qnum?s=""+o.toString(16):i.cross[n+2]&&-1!==i.cross[n+2].qnum?(s=""+(5+o).toString(16),n++):(s=""+(10+o).toString(16),n+=2):-2===o?s=".":e++,0===e?t+=s:!s&&20!==e||(t+=(e+15).toString(36)+s,e=0)}0<e&&(t+=(e+15).toString(36)),this.outbstr+=t},decodeNumber10:function(){for(var e=0,t=0,i=this.outbstr,n=this.board,t=0;t<i.length;t++){var s=n.cell[e],o=i.charAt(t);if("."===o?s.qnum=-2:this.include(o,"0","9")?s.qnum=parseInt(o,10):this.include(o,"a","z")&&(e+=parseInt(o,36)-10),e++,!n.cell[e])break}this.outbstr=i.substr(t+1)},maybeEncodeNumber10:function(){for(var e="",t=0,i=this.board,n=0;n<i.cell.length;n++){var s="",o=i.cell[n].qnum;if(-2===o)s=".";else if(0<=o&&o<10)s=o.toString(10);else{if(10<=o)return"";t++}0===t?e+=s:!s&&26!==t||(e+=(9+t).toString(36)+s,t=0)}return 0<t&&(e+=(9+t).toString(36)),e},encodeNumber10:function(){this.outbstr+=this.maybeEncodeNumber10()},readNumber16:function(e,t){var i=e.charAt(t);return this.include(i,"0","9")||this.include(i,"a","f")?[parseInt(i,16),1]:"-"===i?[parseInt(e.substr(t+1,2),16),3]:"+"===i?[parseInt(e.substr(t+1,3),16),4]:"="===i?[parseInt(e.substr(t+1,3),16)+4096,4]:"%"===i||"@"===i?[parseInt(e.substr(t+1,3),16)+8192,4]:"*"===i?[parseInt(e.substr(t+1,4),16)+12240,5]:"$"===i?[parseInt(e.substr(t+1,5),16)+77776,6]:"."===i?[-2,1]:[-1,0]},decodeOneNumber16:function(){var e=this.readNumber16(this.outbstr,0);return this.outbstr=this.outbstr.substr(e[1]),e[0]},decodeNumber16:function(){var i=this.board;this.genericDecodeNumber16(i.cell.length,function(e,t){i.cell[e].qnum=t})},genericDecodeNumber16:function(e,t){for(var i=0,n=0,s=this.outbstr;n<s.length&&i<e;){var o=s.charAt(n),r=this.readNumber16(s,n);-1!==r[0]?(t(i,r[0]),n+=r[1],i++):("g"<=o&&o<="z"&&(i+=parseInt(o,36)-15),n++)}this.outbstr=s.substr(n)},writeNumber16:function(e){return-2===e?".":0<=e&&e<16?e.toString(16):16<=e&&e<256?"-"+e.toString(16):256<=e&&e<4096?"+"+e.toString(16):4096<=e&&e<8192?"="+(e-4096).toString(16).padStart(3,0):8192<=e&&e<12240?"@"+(e-8192).toString(16).padStart(3,0):12240<=e&&e<77776?"*"+(e-12240).toString(16).padStart(4,0):77776<=e?"$"+(e-77776).toString(16).padStart(5,0):""},encodeNumber16:function(){var t=this.board;this.genericEncodeNumber16(t.cell.length,function(e){return t.cell[e].qnum})},genericEncodeNumber16:function(e,t){for(var i=0,n="",s=0;s<e;s++){var o=t(s),o=this.writeNumber16(o);""===o&&i++,0===i?n+=o:!o&&20!==i||(n+=(15+i).toString(36)+o,i=0)}0<i&&(n+=(15+i).toString(36)),this.outbstr+=n},decodeNumber10or16:function(){var e=this.outbstr;0!==e.length&&("-"===e.charAt(0)?(this.outbstr=e.substr(1),this.decodeNumber16()):this.decodeNumber10())},encodeNumber10or16:function(){var e=this.maybeEncodeNumber10();0<e.length?this.outbstr+=e:(this.outbstr+="-",this.encodeNumber16())},decodeNumber16ExCell:function(){for(var e=0,t=0,i=this.outbstr,n=this.board,t=0;t<i.length;t++){var s=i.charAt(t),o=n.excell[e];if(this.include(s,"0","9")||this.include(s,"a","f")?o.qnum=parseInt(i.substr(t,1),16):"-"===s?(o.qnum=parseInt(i.substr(t+1,2),16),t+=2):"."===s?o.qnum=-2:"g"<=s&&s<="z"&&(e+=parseInt(s,36)-16),++e>=n.excell.length)break}this.outbstr=i.substr(t+1)},encodeNumber16ExCell:function(){var t=this.board;this.genericEncodeNumber16(t.excell.length,function(e){return t.excell[e].qnum})},encodeNumber16ExCellFlushed:function(){var e=this.board,t=e.cols,i=e.rows,n=e.excell.map(function(e){return e.qnum});e.genericFlush(e.excellCols(t,i),e.excellRows(t,i),t,i,function(e){return n[e]},function(e,t){n[e]=t}),this.genericEncodeNumber16(n.length,function(e){return n[e]})},decodeRoomNumber16:function(){var e=this.board,i=(e.roommgr.rebuild(),e.roommgr.components);this.genericDecodeNumber16(i.length,function(e,t){i[e].top.qnum=t})},encodeRoomNumber16:function(){var t=this.board;t.roommgr.rebuild(),this.genericEncodeNumber16(t.roommgr.components.length,function(e){return t.roommgr.components[e].top.qnum})},decodeArrowNumber16:function(){for(var e=0,t=0,i=this.outbstr,n=this.board,t=0;t<i.length;t++){var s,o=i.charAt(t),r=n.cell[e];if("+"===o?(r.qdir=0,r.qnum=-3):this.include(o,"0","4")?(s=i.charAt(t+1),r.qdir=parseInt(o,16),r.qnum="."!==s?parseInt(s,16):-2,t++):this.include(o,"5","9")?(r.qdir=parseInt(o,16)-5,r.qnum=parseInt(i.substr(t+1,2),16),t+=2):"-"===o?(r.qdir=parseInt(i.substr(t+1,1),16),r.qnum=parseInt(i.substr(t+2,3),16),t+=4):"a"<=o&&o<="z"&&(e+=parseInt(o,36)-10),e++,!n.cell[e])break}this.outbstr=i.substr(t+1)},encodeArrowNumber16:function(){for(var e="",t=0,i=this.board,n=0;n<i.cell.length;n++){var s="",o=i.cell[n].qdir,r=i.cell[n].qnum;-2===r?s=o+".":-3===r?s="+":0<=r&&r<16?s=o+r.toString(16):16<=r&&r<256?s=o+5+r.toString(16):256<=r&&r<4096?s="-"+o+r.toString(16):t++,0===t?e+=s:!s&&26!==t||(e+=(t+9).toString(36)+s,t=0)}0<t&&(e+=(t+9).toString(36)),this.outbstr+=e},decodeBorder:function(){for(var e,t=this.outbstr,i=[16,8,4,2,1],n=this.board,s=t?(e=Math.min(((n.cols-1)*n.rows+4)/5|0,t.length),Math.min(((n.cols*(n.rows-1)+4)/5|0)+e,t.length)):e=0,o=0,r=0;r<e;r++)for(var a=parseInt(t.charAt(r),32),h=0;h<5;h++)o<(n.cols-1)*n.rows&&(n.border[o].ques=a&i[h]?1:0,o++);o=(n.cols-1)*n.rows;for(r=e;r<s;r++)for(a=parseInt(t.charAt(r),32),h=0;h<5;h++){var l=n.border[o];l&&l.inside&&(l.ques=a&i[h]?1:0,o++)}n.roommgr.rebuild(),this.outbstr=t.substr(s)},encodeBorder:function(){for(var e="",t=[16,8,4,2,1],i=0,n=0,s=this.board,o=0;o<(s.cols-1)*s.rows;o++)n+=s.border[o].ques*t[i],5===++i&&(e+=n.toString(32),n=i=0);0<i&&(e+=n.toString(32));for(i=0,n=0,o=(s.cols-1)*s.rows;o<2*s.cols*s.rows-s.cols-s.rows;o++)n+=s.border[o].ques*t[i],5===++i&&(e+=n.toString(32),n=i=0);0<i&&(e+=n.toString(32)),this.outbstr+=e},decodeCrossMark:function(){for(var e=0,t=0,i=this.outbstr,n=this.board,s=2===n.hascross?1:0,o=s<<1,r=n.rows-1+o,a=n.cols-1+o,t=0;t<i.length;t++){var h=i.charAt(t);if(this.include(h,"0","9")||this.include(h,"a","z")){var l=(e+=parseInt(h,36))%a+(1-s)<<1,c=1-s+(e/a|0)<<1;if(c>n.maxby-2*(1-s)){t++;break}n.getx(l,c).qnum=1}else"."===h&&(e+=35);if(a*r<=++e){t++;break}}this.outbstr=i.substr(t)},encodeCrossMark:function(){for(var e="",t=0,i=this.board,n=2===i.hascross?1:0,s=n<<1,o=i.rows-1+s,r=i.cols-1+s,a=0,h=r*o;a<h;a++){var l="";1===i.getx(a%r+(1-n)<<1,1-n+(a/r|0)<<1).qnum?l=".":t++,l?(e+=t.toString(36),t=0):36===t&&(e+=".",t=0)}(0<t||""===e)&&(e+=t.toString(36)),this.outbstr+=e},genericDecodeThree:function(e){for(var t=this.board,i=this.outbstr,n=0,s=[9,3,1],o=i?Math.min((t.cols*t.rows+2)/3|0,i.length):0,r=0;r<o;r++)for(var a,h=parseInt(i.charAt(r),27),l=0;l<3;l++)t.cell[n]&&(0<(a=(h/s[l]|0)%3)&&e(t.cell[n],a),n++);this.outbstr=i.substr(o)},decodeCircle:function(){this.genericDecodeThree(function(e,t){e.qnum=t})},genericEncodeThree:function(e){for(var t=this.board,i="",n=0,s=0,o=[9,3,1],r=0;r<t.cell.length;r++)s+=e(t.cell[r])*o[n],3===++n&&(i+=s.toString(27),s=n=0);0<n&&(i+=s.toString(27)),this.outbstr+=i},encodeCircle:function(){this.genericEncodeThree(function(e){return Math.max(0,e.qnum)})},decodeBinary:function(i,n){var s=this.board;this.genericDecodeBinary(s.cell.length,function(e,t){t&&(s.cell[e][i]=n)})},genericDecodeBinary:function(e,t){for(var i=this.outbstr,n=0,s=[16,8,4,2,1],o=0;o<i.length;o++){for(var r=parseInt(i.charAt(o),32),a=0;a<5;a++)n<e&&(t(n,!!(r&s[a])),n++);if(e<=n)break}this.outbstr=i.substr(o+1)},encodeBinary:function(t,i,e){var n=this.board;this.genericEncodeBinary(n.cell.length,function(e){return n.cell[e][t]===i},e)},genericEncodeBinary:function(e,t,i){for(var n="",s=0,o=0,r=[16,8,4,2,1],a=!1,h=0;h<e;h++)t(h)&&(o+=r[s],a=!0),5===++s&&(n+=o.toString(32),o=s=0);return 0<s&&(n+=o.toString(32)),!(!a&&i)&&(this.outbstr+=n,!0)},decodeIce:function(){this.decodeBinary("ques",6)},encodeIce:function(){this.encodeBinary("ques",6)},decodeEmpty:function(){this.decodeBinary("ques",7)},encodeEmpty:function(){return this.encodeBinary("ques",7,!0)},decodecross_old:function(){for(var e=this.outbstr,t=0,i=this.board,n=0;n<e.length;n++){var s=e.charAt(n);if(this.include(s,"0","4")&&(i.cross[t].qnum=parseInt(s,10)),t++,!i.cross[t]){n++;break}}this.outbstr=e.substr(n)},decodeDot:function(e){for(var t=this.board,i=(t.disableInfo(),0),e=this.outbstr,n=0;n<e.length;n++){var s,o=t.dots[i],r=e.charAt(n);if(this.include(r,"0","f")?(s=parseInt(r,16),o.setDot(s%2+1),i+=1+(s>>1)):this.include(r,"g","z")&&(i+=parseInt(r,36)-15),i>=t.dotsmax)break}t.enableInfo(),this.outbstr=e.substr(n+1)},encodeDot:function(){for(var e=0,t="",i=this.board,n=0;n<i.dotsmax;n++){var s="",o=i.dots[n];if(0<o.getDot()){for(var r=1;r<=7;r++){var a=i.dots[n+r];if(a&&0<a.getDot()){s=""+(2*(r-1)+(o.getDot()-1)).toString(16),n+=r-1;break}}""===s&&(s=(13+o.getDot()).toString(16),n+=7)}else e++;0===e?t+=s:!s&&20!==e||(t+=(e+15).toString(36)+s,e=0)}0<e&&(t+=(e+15).toString(36)),this.outbstr+=t},decodePieceBank:function(){var e=this.board.bank;if("//"===this.outbstr.substr(0,2)){for(var t=this.outbstr[2],i=0;i<e.presets.length;i++)if(e.presets[i].shortkey===t){e.initialize(e.presets[i].constant);break}this.outbstr=this.outbstr.substr(3)}else{this.outbstr=this.outbstr.substr(1);for(var n=this.outbstr.indexOf("/"),s=+this.outbstr.substr(0,n),o=(this.outbstr=this.outbstr.substr(n+1),[]),i=0;i<s;i++)n=this.outbstr.indexOf("/"),o.push(0<=n?this.outbstr.substr(0,n):this.outbstr),this.outbstr=0<=n?this.outbstr.substr(n+1):"";e.initialize(o)}},encodePieceBank:function(){this.outbstr+="/";for(var e=this.board.bank,t=e.pieces.map(function(e){return e.serialize()}),i=0;i<e.presets.length;i++)if(e.presets[i].constant&&this.puzzle.pzpr.util.sameArray(e.presets[i].constant,t))return void(this.outbstr+="/"+e.presets[i].shortkey);this.outbstr+=t.length;for(i=0;i<t.length;i++)this.outbstr+="/"+t[i]}}}),p.classmgr.makeCommon({FileIO:{decodeCellQnum:function(){this.decodeCell(function(e,t){"-"===t?e.qnum=-2:"."!==t&&(e.qnum=+t)})},encodeCellQnum:function(){this.encodeCell(function(e){return 0<=e.qnum?e.qnum+" ":-2===e.qnum?"- ":". "})},decodeCellQnumb:function(){this.decodeCell(function(e,t){"5"===t?e.qnum=-2:"."!==t&&(e.qnum=+t)})},encodeCellQnumb:function(){this.encodeCell(function(e){return 0<=e.qnum?e.qnum+" ":-2===e.qnum?"5 ":". "})},decodeCellQnumAns:function(){this.decodeCell(function(e,t){"#"===t?e.qans=1:"+"===t?e.qsub=1:"-"===t?e.qnum=-2:"."!==t&&(e.qnum=+t)})},encodeCellQnumAns:function(){this.encodeCell(function(e){return 0<=e.qnum?e.qnum+" ":-2===e.qnum?"- ":1===e.qans?"# ":1===e.qsub?"+ ":". "})},decodeCellDirecQnum:function(){this.decodeCell(function(e,t){"#"===t?(e.qdir=0,e.qnum=-3):"."!==t&&(t=t.split(","),e.qdir="0"!==t[0]?+t[0]:0,e.qnum="-"!==t[1]?+t[1]:-2)})},encodeCellDirecQnum:function(){this.encodeCell(function(e){return-3===e.qnum?"# ":-1!==e.qnum?[0!==e.qdir?""+e.qdir:"0",",",-2!==e.qnum?""+e.qnum:"-"," "].join(""):". "})},decodeCellAns:function(){this.decodeCell(function(e,t){"#"===t?e.qans=1:"+"===t&&(e.qsub=1)})},encodeCellAns:function(){this.encodeCell(function(e){return 1===e.qans?"# ":1===e.qsub?"+ ":". "})},decodeCellQanssub:function(){this.decodeCell(function(e,t){"+"===t?e.qsub=1:"-"===t?e.qsub=2:"="===t?e.qsub=3:"%"===t?e.qsub=4:"."!==t&&(e.qans=+t)})},encodeCellQanssub:function(){this.encodeCell(function(e){return 0!==e.qans?e.qans+" ":1===e.qsub?"+ ":2===e.qsub?"- ":3===e.qsub?"= ":4===e.qsub?"% ":". "})},decodeCellAnumsub:function(){this.decodeCell(function(e,t){"+"===(t=e.enableSubNumberArray&&0<=t.indexOf("[")?this.setCellSnum(e,t):t)?e.qsub=1:"-"===t?e.qsub=2:"="===t?e.qsub=3:"%"===t?e.qsub=4:"."!==t&&(e.anum=+t)})},encodeCellAnumsub:function(){this.encodeCell(function(e){var t=".",t=-1!==e.anum?""+e.anum:1===e.qsub?"+":2===e.qsub?"-":3===e.qsub?"=":4===e.qsub?"%":".";return e.enableSubNumberArray&&-1===e.anum&&(t+=this.getCellSnum(e)),t+" "})},setCellSnum:function(e,t){for(var i=t.substring(t.indexOf("[")+1,t.indexOf("]")).split(/,/),n=0;n<i.length;++n)e.snum[n]=i[n]?+i[n]:-1;return t.substr(0,t.indexOf("["))},getCellSnum:function(e){for(var t=[],i=0;i<e.snum.length;++i)t[i]=-1!==e.snum[i]?""+e.snum[i]:"";var n=t.join(",");return",,,"!==n?"["+n+"]":""},decodeCellSnum:function(){this.decodeCell(function(e,t){this.setCellSnum(e,t)})},encodeCellSnum:function(e){if(!e){for(var t=!1,i=this.board.cell,n=0;n<i.length&&!t;n++)for(var s=i[n],o=0;o<s.snum.length;++o)-1!==s.snum[o]&&(t=!0);if(!t)return}this.encodeCell(function(e){e=this.getCellSnum(e);return e?e+" ":". "})},decodeCellQsub:function(){this.decodeCell(function(e,t){"0"!==t&&(e.qsub=+t)})},encodeCellQsub:function(){this.encodeCell(function(e){return 0<e.qsub?e.qsub+" ":"0 "})},decodeCrossNum:function(){this.decodeCross(function(e,t){"-"===t?e.qnum=-2:"."!==t&&(e.qnum=+t)})},encodeCrossNum:function(){this.encodeCross(function(e){return 0<=e.qnum?e.qnum+" ":-2===e.qnum?"- ":". "})},decodeBorderQues:function(){this.decodeBorder(function(e,t){"1"===t&&(e.ques=1)})},encodeBorderQues:function(){this.encodeBorder(function(e){return(1===e.ques?"1":"0")+" "})},decodeBorderAns:function(e){this.decodeBorder(function(e,t){"2"===t?(e.qans=1,e.qsub=1):"1"===t?e.qans=1:"-1"===t&&(e.qsub=1)},e)},encodeBorderAns:function(e){this.encodeBorder(function(e){return 1===e.qans&&1===e.qsub?"2 ":1===e.qans?"1 ":1===e.qsub?"-1 ":"0 "},e)},decodeBorderArrowAns:function(){this.decodeBorder(function(e,t){var i=t.charAt(t.length-1);"a"<=i&&i<="z"&&("u"===i?e.qsub=11:"d"===i?e.qsub=12:"l"===i?e.qsub=13:"r"===i&&(e.qsub=14),t=t.substr(0,t.length-1)),""!==t&&"0"!==t&&("-"===t.charAt(0)?(e.line=-t-1,e.qsub=2):e.line=+t)})},encodeBorderArrowAns:function(){this.encodeBorder(function(e){var t="";return 2===e.qsub?t+=""+(-1-e.line):0<e.line&&(t+=""+e.line),11<=e.qsub&&(t+=["u","d","l","r"][e.qsub-11]),""!==t?t+" ":"0 "})},decodeBorderLine:function(){this.decodeBorder(function(e,t){"-1"===t?e.qsub=2:"0"!==t&&(e.line=+t)})},encodeBorderLine:function(){this.encodeBorder(function(e){return 0<e.line?e.line+" ":2===e.qsub?"-1 ":"0 "})},decodeAreaRoom:function(){this.decodeAreaRoom_com(!0)},encodeAreaRoom:function(){this.encodeAreaRoom_com(!0)},decodeAreaRoom_com:function(e){this.readLine(),this.rdata2Border(e,this.getItemList(this.board.rows)),this.board.roommgr.rebuild()},encodeAreaRoom_com:function(e){for(var t=this.board,i=(t.roommgr.rebuild(),t.roommgr.components),n=(this.writeLine(i.length),""),s=0;s<t.cell.length;s++){var o=i.indexOf(t.cell[s].room);n+=(0<=o?o:".")+" ",(s+1)%t.cols==0&&(this.writeLine(n),n="")}},rdata2Border:function(e,t){for(var i=this.board,n=0;n<i.border.length;n++){var s=i.border[n],o=s.sidecell[0],r=s.sidecell[1],o=!o.isnull&&!r.isnull&&t[o.id]!==t[r.id];s[e?"ques":"qans"]=o?1:0}},decodeCellQnum51:function(){var e=this.board;e.disableInfo(),this.decodeCellExCell(function(e,t){"."!==t&&("excell"===e.group?-1!==e.bx&&-1===e.by?e.qnum2=+t:-1===e.bx&&-1!==e.by&&(e.qnum=+t):"cell"===e.group&&(t=t.split(","),e.set51cell(),e.qnum=+t[0],e.qnum2=+t[1]))}),e.enableInfo()},encodeCellQnum51:function(){this.encodeCellExCell(function(e){return"excell"===e.group?-1===e.bx&&-1===e.by?"0 ":(-1===e.by?e.qnum2:e.qnum)+" ":"cell"===e.group&&51===e.ques?e.qnum+","+e.qnum2+" ":". "})},decodeDotFile:function(){for(var e=this.board,t=0,i="",n=0,s=2*e.rows-1;n<s;n++)i+=this.readLine();e.disableInfo();for(t=0;t<i.length;++t){var o=e.dots[t],r=i.charAt(t),a=+r;1<=a&&a<=9?o.setDot(a):"-"===r?o.setDot(-2):"X"===r&&(o.piece.ques=7)}e.enableInfo()},encodeDotFile:function(){for(var e=this.board,t=0,i=1;i<=2*e.rows-1;i++){for(var n="",s=1;s<=2*e.cols-1;s++){var o=e.dots[t];1<=o.getDot()&&o.getDot()<=9?n+=o.getDot():7===o.piece.ques?n+="X":-2===o.getDot()?n+="-":n+=".",t++}this.writeLine(n)}},decodeQnums:function(){this.decodeCell(function(e,t){if("."!==t){e.qnums=[];for(var i=t.split(/,/),n=0;n<i.length;n++)e.qnums.push("-"!==i[n]?+i[n]:-2)}})},encodeQnums:function(){this.encodeCell(function(e){if(0<e.qnums.length){for(var t=[],i=0;i<e.qnums.length;i++)t.push(0<=e.qnums[i]?""+e.qnums[i]:"-");return t.join(",")+" "}return". "})},decodePieceBank:function(){var e=this.board.bank,t=this.readLine();if(isNaN(t)){for(var i=0;i<e.presets.length;i++)if(e.presets[i].shortkey===t){e.initialize(e.presets[i].constant);break}}else{for(var n=[],i=0;i<+t;i++)n.push(this.readLine());e.initialize(n)}},encodePieceBank:function(){for(var e=this.board.bank,t=e.pieces.map(function(e){return e.serialize()}),i=0;i<e.presets.length;i++)if(e.presets[i].constant&&this.puzzle.pzpr.util.sameArray(e.presets[i].constant,t))return void this.writeLine(e.presets[i].shortkey);this.writeLine(""+t.length);for(i=0;i<t.length;i++)this.writeLine(t[i])},decodePieceBankQcmp:function(){for(var e=(this.readLine()||"").split(" "),t=Math.min(e.length,this.board.bank.pieces.length),i=0;i<t;i++)this.board.bank.pieces[i].qcmp=+e[i]},encodePieceBankQcmp:function(){var e=this.board.bank.pieces.map(function(e){return e.qcmp+" "}).join("");this.writeLine(e)},decodeCellQnum_kanpen:function(){this.decodeCell(function(e,t){"."!==t&&(e.qnum=+t)})},encodeCellQnum_kanpen:function(){this.encodeCell(function(e){return 0<=e.qnum?e.qnum+" ":". "})},decodeCellAnum_kanpen:function(){this.decodeCell(function(e,t){"."!==t&&"0"!==t&&(e.anum=+t)})},encodeCellAnum_kanpen:function(){this.encodeCell(function(e){return-1!==e.qnum?". ":-1===e.anum?"0 ":e.anum+" "})},decodeCellQnumAns_kanpen:function(){this.decodeCell(function(e,t){"#"===t?e.qans=1:"+"===t?e.qsub=1:"?"===t?e.qnum=-2:"."!==t&&(e.qnum=+t)})},encodeCellQnumAns_kanpen:function(){this.encodeCell(function(e){return 0<=e.qnum?e.qnum+" ":-2===e.qnum?"? ":1===e.qans?"# ":1===e.qsub?"+ ":". "})},UNDECIDED_NUM_XML:-1,decodeCellQnum_XMLBoard:function(){var i=0<this.board.cell[0].getminnum()?1:0,n=this.UNDECIDED_NUM_XML;this.decodeCellXMLBoard(function(e,t){t===n?e.qnum=-2:i<=t&&(e.qnum=t)})},encodeCellQnum_XMLBoard:function(){var i=0<this.board.cell[0].getminnum()?1:0,n=this.UNDECIDED_NUM_XML;this.encodeCellXMLBoard(function(e){var t=null;return-2===e.qnum?t=n:e.qnum>=i&&(t=e.qnum),t})},decodeCellQnum_XMLBoard_Brow:function(){var i=this.UNDECIDED_NUM_XML;this.decodeCellXMLBrow(function(e,t){t==="n"+i?e.qnum=-2:"s"!==t&&(e.qnum=+t.substr(1))})},encodeCellQnum_XMLBoard_Brow:function(){var t=this.UNDECIDED_NUM_XML;this.encodeCellXMLBrow(function(e){return-2===e.qnum?"n"+t:0<=e.qnum?"n"+e.qnum:"s"})},decodeCellAnum_XMLAnswer:function(){this.decodeCellXMLArow(function(e,t){"n0"===t?e.anum=-1:"s"!==t&&(e.anum=+t.substr(1))})},encodeCellAnum_XMLAnswer:function(){this.encodeCellXMLArow(function(e){return 0<e.anum?"n"+e.anum:-1===e.anum?"n0":"s"})},decodeAreaRoom_XMLBoard:function(){var i=[];this.decodeCellXMLBrow(function(e,t){i.push(+t.substr(1))}),this.rdata2Border(!0,i),this.board.roommgr.rebuild()},encodeAreaRoom_XMLBoard:function(){var e=this.board,t=(e.roommgr.rebuild(),e.roommgr.components);this.xmldoc.querySelector("board").appendChild(this.createXMLNode("areas",{N:t.length})),this.encodeCellXMLBrow(function(e){e=t.indexOf(e.room);return"n"+(0<e?e:-1)})},decodeCellAns_XMLAnswer:function(){this.decodeCellXMLArow(function(e,t){"w"===t?e.qans=1:"s"===t&&(e.qsub=1)})},encodeCellAns_XMLAnswer:function(){this.encodeCellXMLArow(function(e){return 1===e.qans?"w":1===e.qsub?"s":"u"})},decodeBorderLine_XMLAnswer:function(){this.decodeCellXMLArow(function(e,t){var i=0,n=e.adjborder.bottom,e=e.adjborder.right;"n"===t.charAt(0)?i=+t.substr(1):(t.match(/h/)&&(i+=1),t.match(/v/)&&(i+=2)),1&i&&(n.line=1),2&i&&(e.line=1),4&i&&(n.qsub=2),8&i&&(e.qsub=2)})},encodeBorderLine_XMLAnswer:function(){this.encodeCellXMLArow(function(e){var t=0,i=e.adjborder.bottom,e=e.adjborder.right;return 1===i.line&&(t+=1),1===e.line&&(t+=2),2===i.qsub&&(t+=4),2===e.qsub&&(t+=8),0===t?"s":1===t?"h":2===t?"v":3===t?"hv":"n"+t})}}}),p.classmgr.makeCommon({"StartGoalOperation:Operation":{setData:function(e,t,i,n,s){this.property=e,this.bx1=t,this.by1=i,this.bx2=n,this.by2=s},decode:function(e){return("PS"===e[0]||"PG"===e[0])&&(this.property="PS"===e[0]?"start":"goal",this.bx1=+e[1],this.by1=+e[2],this.bx2=+e[3],this.by2=+e[4],!0)},toString:function(){return["start"===this.property?"PS":"PG",this.bx1,this.by1,this.bx2,this.by2].join(",")},isModify:function(e){return!(!this.manager.changeflag||e.bx2!==this.bx1||e.by2!==this.by1||e.property!==this.property)&&(e.bx2=this.bx2,e.by2=this.by2,!0)},undo:function(){this.exec(this.bx1,this.by1)},redo:function(){this.exec(this.bx2,this.by2)},exec:function(e,t){var i=this.board,e=i.getc(e,t);"start"===this.property?i.startpos.set(e):"goal"===this.property&&i.goalpos.set(e)}}}),p.classmgr.makeCommon({"StartGoalAddress:Address":{type:"",partner:null,init:function(e,t){return this.bx=e,this.by=t,this},input:function(e){this.partner&&this.partner.equals(e)?this.board.exchangestartgoal():this.equals(e)?this.draw():this.set(e)},set:function(e){var t=this.getaddr();this.addOpe(e.bx,e.by),this.bx=e.bx,this.by=e.by,t.draw(),this.draw()},addOpe:function(e,t){this.bx===e&&this.by===t||this.puzzle.opemgr.add(new this.klass.StartGoalOperation(this.type,this.bx,this.by,e,t))}},"StartAddress:StartGoalAddress":{type:"start"},"GoalAddress:StartGoalAddress":{type:"goal"}})}();
//# sourceMappingURL=pzpr.js.map